var qy=Object.defineProperty;var Qy=(e,t,r)=>t in e?qy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var A0=(e,t,r)=>(Qy(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Jr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Jy(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var Ap={exports:{}},qc={},Fp={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var el=Symbol.for("react.element"),Zy=Symbol.for("react.portal"),e2=Symbol.for("react.fragment"),t2=Symbol.for("react.strict_mode"),r2=Symbol.for("react.profiler"),n2=Symbol.for("react.provider"),s2=Symbol.for("react.context"),a2=Symbol.for("react.forward_ref"),i2=Symbol.for("react.suspense"),o2=Symbol.for("react.memo"),l2=Symbol.for("react.lazy"),Ld=Symbol.iterator;function c2(e){return e===null||typeof e!="object"?null:(e=Ld&&e[Ld]||e["@@iterator"],typeof e=="function"?e:null)}var jp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Op=Object.assign,Pp={};function wi(e,t,r){this.props=e,this.context=t,this.refs=Pp,this.updater=r||jp}wi.prototype.isReactComponent={};wi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ip(){}Ip.prototype=wi.prototype;function Vf(e,t,r){this.props=e,this.context=t,this.refs=Pp,this.updater=r||jp}var Gf=Vf.prototype=new Ip;Gf.constructor=Vf;Op(Gf,wi.prototype);Gf.isPureReactComponent=!0;var Md=Array.isArray,Rp=Object.prototype.hasOwnProperty,Kf={current:null},Dp={key:!0,ref:!0,__self:!0,__source:!0};function Lp(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Rp.call(t,n)&&!Dp.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:el,type:e,key:a,ref:i,props:s,_owner:Kf.current}}function u2(e,t){return{$$typeof:el,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Xf(e){return typeof e=="object"&&e!==null&&e.$$typeof===el}function f2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Bd=/\/+/g;function F0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?f2(""+e.key):t.toString(36)}function ql(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case el:case Zy:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+F0(i,0):n,Md(s)?(r="",e!=null&&(r=e.replace(Bd,"$&/")+"/"),ql(s,t,r,"",function(c){return c})):s!=null&&(Xf(s)&&(s=u2(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Bd,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Md(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+F0(a,o);i+=ql(a,t,r,l,s)}else if(l=c2(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+F0(a,o++),i+=ql(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function vl(e,t,r){if(e==null)return e;var n=[],s=0;return ql(e,n,"","",function(a){return t.call(r,a,s++)}),n}function h2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var hr={current:null},Ql={transition:null},d2={ReactCurrentDispatcher:hr,ReactCurrentBatchConfig:Ql,ReactCurrentOwner:Kf};function Mp(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:vl,forEach:function(e,t,r){vl(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return vl(e,function(){t++}),t},toArray:function(e){return vl(e,function(t){return t})||[]},only:function(e){if(!Xf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ue.Component=wi;Ue.Fragment=e2;Ue.Profiler=r2;Ue.PureComponent=Vf;Ue.StrictMode=t2;Ue.Suspense=i2;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d2;Ue.act=Mp;Ue.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Op({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Kf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Rp.call(t,l)&&!Dp.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:el,type:e.type,key:s,ref:a,props:n,_owner:i}};Ue.createContext=function(e){return e={$$typeof:s2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:n2,_context:e},e.Consumer=e};Ue.createElement=Lp;Ue.createFactory=function(e){var t=Lp.bind(null,e);return t.type=e,t};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(e){return{$$typeof:a2,render:e}};Ue.isValidElement=Xf;Ue.lazy=function(e){return{$$typeof:l2,_payload:{_status:-1,_result:e},_init:h2}};Ue.memo=function(e,t){return{$$typeof:o2,type:e,compare:t===void 0?null:t}};Ue.startTransition=function(e){var t=Ql.transition;Ql.transition={};try{e()}finally{Ql.transition=t}};Ue.unstable_act=Mp;Ue.useCallback=function(e,t){return hr.current.useCallback(e,t)};Ue.useContext=function(e){return hr.current.useContext(e)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(e){return hr.current.useDeferredValue(e)};Ue.useEffect=function(e,t){return hr.current.useEffect(e,t)};Ue.useId=function(){return hr.current.useId()};Ue.useImperativeHandle=function(e,t,r){return hr.current.useImperativeHandle(e,t,r)};Ue.useInsertionEffect=function(e,t){return hr.current.useInsertionEffect(e,t)};Ue.useLayoutEffect=function(e,t){return hr.current.useLayoutEffect(e,t)};Ue.useMemo=function(e,t){return hr.current.useMemo(e,t)};Ue.useReducer=function(e,t,r){return hr.current.useReducer(e,t,r)};Ue.useRef=function(e){return hr.current.useRef(e)};Ue.useState=function(e){return hr.current.useState(e)};Ue.useSyncExternalStore=function(e,t,r){return hr.current.useSyncExternalStore(e,t,r)};Ue.useTransition=function(){return hr.current.useTransition()};Ue.version="18.3.1";Fp.exports=Ue;var K=Fp.exports;const qf=Yy(K);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m2=K,g2=Symbol.for("react.element"),p2=Symbol.for("react.fragment"),x2=Object.prototype.hasOwnProperty,v2=m2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w2={key:!0,ref:!0,__self:!0,__source:!0};function Bp(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)x2.call(t,n)&&!w2.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:g2,type:e,key:a,ref:i,props:s,_owner:v2.current}}qc.Fragment=p2;qc.jsx=Bp;qc.jsxs=Bp;Ap.exports=qc;var f=Ap.exports,bu={},Up={exports:{}},Lr={},$p={exports:{}},Hp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,U){var re=Z.length;Z.push(U);e:for(;0<re;){var ge=re-1>>>1,O=Z[ge];if(0<s(O,U))Z[ge]=U,Z[re]=O,re=ge;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var U=Z[0],re=Z.pop();if(re!==U){Z[0]=re;e:for(var ge=0,O=Z.length,H=O>>>1;ge<H;){var M=2*(ge+1)-1,B=Z[M],Q=M+1,ie=Z[Q];if(0>s(B,re))Q<O&&0>s(ie,B)?(Z[ge]=ie,Z[Q]=re,ge=Q):(Z[ge]=B,Z[M]=re,ge=M);else if(Q<O&&0>s(ie,re))Z[ge]=ie,Z[Q]=re,ge=Q;else break e}}return U}function s(Z,U){var re=Z.sortIndex-U.sortIndex;return re!==0?re:Z.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,h=null,d=3,m=!1,x=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(Z){for(var U=r(c);U!==null;){if(U.callback===null)n(c);else if(U.startTime<=Z)n(c),U.sortIndex=U.expirationTime,t(l,U);else break;U=r(c)}}function _(Z){if(g=!1,p(Z),!x)if(r(l)!==null)x=!0,ee(S);else{var U=r(c);U!==null&&ne(_,U.startTime-Z)}}function S(Z,U){x=!1,g&&(g=!1,w(C),C=-1),m=!0;var re=d;try{for(p(U),h=r(l);h!==null&&(!(h.expirationTime>U)||Z&&!L());){var ge=h.callback;if(typeof ge=="function"){h.callback=null,d=h.priorityLevel;var O=ge(h.expirationTime<=U);U=e.unstable_now(),typeof O=="function"?h.callback=O:h===r(l)&&n(l),p(U)}else n(l);h=r(l)}if(h!==null)var H=!0;else{var M=r(c);M!==null&&ne(_,M.startTime-U),H=!1}return H}finally{h=null,d=re,m=!1}}var E=!1,k=null,C=-1,T=5,R=-1;function L(){return!(e.unstable_now()-R<T)}function D(){if(k!==null){var Z=e.unstable_now();R=Z;var U=!0;try{U=k(!0,Z)}finally{U?q():(E=!1,k=null)}}else E=!1}var q;if(typeof y=="function")q=function(){y(D)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,W=oe.port2;oe.port1.onmessage=D,q=function(){W.postMessage(null)}}else q=function(){v(D,0)};function ee(Z){k=Z,E||(E=!0,q())}function ne(Z,U){C=v(function(){Z(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){x||m||(x=!0,ee(S))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Z){switch(d){case 1:case 2:case 3:var U=3;break;default:U=d}var re=d;d=U;try{return Z()}finally{d=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,U){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var re=d;d=Z;try{return U()}finally{d=re}},e.unstable_scheduleCallback=function(Z,U,re){var ge=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?ge+re:ge):re=ge,Z){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=re+O,Z={id:u++,callback:U,priorityLevel:Z,startTime:re,expirationTime:O,sortIndex:-1},re>ge?(Z.sortIndex=re,t(c,Z),r(l)===null&&Z===r(c)&&(g?(w(C),C=-1):g=!0,ne(_,re-ge))):(Z.sortIndex=O,t(l,Z),x||m||(x=!0,ee(S))),Z},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(Z){var U=d;return function(){var re=d;d=U;try{return Z.apply(this,arguments)}finally{d=re}}}})(Hp);$p.exports=Hp;var y2=$p.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _2=K,Rr=y2;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wp=new Set,_o={};function ma(e,t){oi(e,t),oi(e+"Capture",t)}function oi(e,t){for(_o[e]=t,e=0;e<t.length;e++)Wp.add(t[e])}var Vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tu=Object.prototype.hasOwnProperty,k2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ud={},$d={};function S2(e){return Tu.call($d,e)?!0:Tu.call(Ud,e)?!1:k2.test(e)?$d[e]=!0:(Ud[e]=!0,!1)}function E2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b2(e,t,r,n){if(t===null||typeof t>"u"||E2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dr(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Kt[e]=new dr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Kt[t]=new dr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Kt[e]=new dr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Kt[e]=new dr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Kt[e]=new dr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Kt[e]=new dr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Kt[e]=new dr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Kt[e]=new dr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Kt[e]=new dr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Qf=/[\-:]([a-z])/g;function Yf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Qf,Yf);Kt[t]=new dr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Qf,Yf);Kt[t]=new dr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Qf,Yf);Kt[t]=new dr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Kt[e]=new dr(e,1,!1,e.toLowerCase(),null,!1,!1)});Kt.xlinkHref=new dr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Kt[e]=new dr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Jf(e,t,r,n){var s=Kt.hasOwnProperty(t)?Kt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b2(t,r,s,n)&&(r=null),n||s===null?S2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Qn=_2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wl=Symbol.for("react.element"),La=Symbol.for("react.portal"),Ma=Symbol.for("react.fragment"),Zf=Symbol.for("react.strict_mode"),Nu=Symbol.for("react.profiler"),zp=Symbol.for("react.provider"),Vp=Symbol.for("react.context"),eh=Symbol.for("react.forward_ref"),Cu=Symbol.for("react.suspense"),Au=Symbol.for("react.suspense_list"),th=Symbol.for("react.memo"),ss=Symbol.for("react.lazy"),Gp=Symbol.for("react.offscreen"),Hd=Symbol.iterator;function ji(e){return e===null||typeof e!="object"?null:(e=Hd&&e[Hd]||e["@@iterator"],typeof e=="function"?e:null)}var dt=Object.assign,j0;function Wi(e){if(j0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);j0=t&&t[1]||""}return`
`+j0+e}var O0=!1;function P0(e,t){if(!e||O0)return"";O0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{O0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Wi(e):""}function T2(e){switch(e.tag){case 5:return Wi(e.type);case 16:return Wi("Lazy");case 13:return Wi("Suspense");case 19:return Wi("SuspenseList");case 0:case 2:case 15:return e=P0(e.type,!1),e;case 11:return e=P0(e.type.render,!1),e;case 1:return e=P0(e.type,!0),e;default:return""}}function Fu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ma:return"Fragment";case La:return"Portal";case Nu:return"Profiler";case Zf:return"StrictMode";case Cu:return"Suspense";case Au:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Vp:return(e.displayName||"Context")+".Consumer";case zp:return(e._context.displayName||"Context")+".Provider";case eh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case th:return t=e.displayName||null,t!==null?t:Fu(e.type)||"Memo";case ss:t=e._payload,e=e._init;try{return Fu(e(t))}catch{}}return null}function N2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fu(t);case 8:return t===Zf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Kp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function C2(e){var t=Kp(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yl(e){e._valueTracker||(e._valueTracker=C2(e))}function Xp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Kp(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function cc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ju(e,t){var r=t.checked;return dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Wd(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=bs(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function qp(e,t){t=t.checked,t!=null&&Jf(e,"checked",t,!1)}function Ou(e,t){qp(e,t);var r=bs(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Pu(e,t.type,r):t.hasOwnProperty("defaultValue")&&Pu(e,t.type,bs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function zd(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Pu(e,t,r){(t!=="number"||cc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var zi=Array.isArray;function Ya(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+bs(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Iu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vd(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ce(92));if(zi(r)){if(1<r.length)throw Error(ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:bs(r)}}function Qp(e,t){var r=bs(t.value),n=bs(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Gd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Yp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ru(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Yp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _l,Jp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_l.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ko(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ji={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},A2=["Webkit","ms","Moz","O"];Object.keys(Ji).forEach(function(e){A2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ji[t]=Ji[e]})});function Zp(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ji.hasOwnProperty(e)&&Ji[e]?(""+t).trim():t+"px"}function ex(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Zp(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var F2=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Du(e,t){if(t){if(F2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function Lu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mu=null;function rh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bu=null,Ja=null,Za=null;function Kd(e){if(e=nl(e)){if(typeof Bu!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=e0(t),Bu(e.stateNode,e.type,t))}}function tx(e){Ja?Za?Za.push(e):Za=[e]:Ja=e}function rx(){if(Ja){var e=Ja,t=Za;if(Za=Ja=null,Kd(e),t)for(e=0;e<t.length;e++)Kd(t[e])}}function nx(e,t){return e(t)}function sx(){}var I0=!1;function ax(e,t,r){if(I0)return e(t,r);I0=!0;try{return nx(e,t,r)}finally{I0=!1,(Ja!==null||Za!==null)&&(sx(),rx())}}function So(e,t){var r=e.stateNode;if(r===null)return null;var n=e0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ce(231,t,typeof r));return r}var Uu=!1;if(Vn)try{var Oi={};Object.defineProperty(Oi,"passive",{get:function(){Uu=!0}}),window.addEventListener("test",Oi,Oi),window.removeEventListener("test",Oi,Oi)}catch{Uu=!1}function j2(e,t,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Zi=!1,uc=null,fc=!1,$u=null,O2={onError:function(e){Zi=!0,uc=e}};function P2(e,t,r,n,s,a,i,o,l){Zi=!1,uc=null,j2.apply(O2,arguments)}function I2(e,t,r,n,s,a,i,o,l){if(P2.apply(this,arguments),Zi){if(Zi){var c=uc;Zi=!1,uc=null}else throw Error(ce(198));fc||(fc=!0,$u=c)}}function ga(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ix(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Xd(e){if(ga(e)!==e)throw Error(ce(188))}function R2(e){var t=e.alternate;if(!t){if(t=ga(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Xd(s),e;if(a===n)return Xd(s),t;a=a.sibling}throw Error(ce(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ce(189))}}if(r.alternate!==n)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?e:t}function ox(e){return e=R2(e),e!==null?lx(e):null}function lx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=lx(e);if(t!==null)return t;e=e.sibling}return null}var cx=Rr.unstable_scheduleCallback,qd=Rr.unstable_cancelCallback,D2=Rr.unstable_shouldYield,L2=Rr.unstable_requestPaint,_t=Rr.unstable_now,M2=Rr.unstable_getCurrentPriorityLevel,nh=Rr.unstable_ImmediatePriority,ux=Rr.unstable_UserBlockingPriority,hc=Rr.unstable_NormalPriority,B2=Rr.unstable_LowPriority,fx=Rr.unstable_IdlePriority,Qc=null,An=null;function U2(e){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(Qc,e,void 0,(e.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:W2,$2=Math.log,H2=Math.LN2;function W2(e){return e>>>=0,e===0?32:31-($2(e)/H2|0)|0}var kl=64,Sl=4194304;function Vi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Vi(o):(a&=i,a!==0&&(n=Vi(a)))}else i=r&~s,i!==0?n=Vi(i):a!==0&&(n=Vi(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-dn(t),s=1<<r,n|=e[r],t&=~s;return n}function z2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function V2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-dn(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=z2(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function Hu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function hx(){var e=kl;return kl<<=1,!(kl&4194240)&&(kl=64),e}function R0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function tl(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-dn(t),e[t]=r}function G2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-dn(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function sh(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-dn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Qe=0;function dx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var mx,ah,gx,px,xx,Wu=!1,El=[],gs=null,ps=null,xs=null,Eo=new Map,bo=new Map,is=[],K2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qd(e,t){switch(e){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":xs=null;break;case"pointerover":case"pointerout":Eo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":bo.delete(t.pointerId)}}function Pi(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=nl(t),t!==null&&ah(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function X2(e,t,r,n,s){switch(t){case"focusin":return gs=Pi(gs,e,t,r,n,s),!0;case"dragenter":return ps=Pi(ps,e,t,r,n,s),!0;case"mouseover":return xs=Pi(xs,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Eo.set(a,Pi(Eo.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,bo.set(a,Pi(bo.get(a)||null,e,t,r,n,s)),!0}return!1}function vx(e){var t=Ks(e.target);if(t!==null){var r=ga(t);if(r!==null){if(t=r.tag,t===13){if(t=ix(r),t!==null){e.blockedOn=t,xx(e.priority,function(){gx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=zu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Mu=n,r.target.dispatchEvent(n),Mu=null}else return t=nl(r),t!==null&&ah(t),e.blockedOn=r,!1;t.shift()}return!0}function Yd(e,t,r){Yl(e)&&r.delete(t)}function q2(){Wu=!1,gs!==null&&Yl(gs)&&(gs=null),ps!==null&&Yl(ps)&&(ps=null),xs!==null&&Yl(xs)&&(xs=null),Eo.forEach(Yd),bo.forEach(Yd)}function Ii(e,t){e.blockedOn===t&&(e.blockedOn=null,Wu||(Wu=!0,Rr.unstable_scheduleCallback(Rr.unstable_NormalPriority,q2)))}function To(e){function t(s){return Ii(s,e)}if(0<El.length){Ii(El[0],e);for(var r=1;r<El.length;r++){var n=El[r];n.blockedOn===e&&(n.blockedOn=null)}}for(gs!==null&&Ii(gs,e),ps!==null&&Ii(ps,e),xs!==null&&Ii(xs,e),Eo.forEach(t),bo.forEach(t),r=0;r<is.length;r++)n=is[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<is.length&&(r=is[0],r.blockedOn===null);)vx(r),r.blockedOn===null&&is.shift()}var ei=Qn.ReactCurrentBatchConfig,mc=!0;function Q2(e,t,r,n){var s=Qe,a=ei.transition;ei.transition=null;try{Qe=1,ih(e,t,r,n)}finally{Qe=s,ei.transition=a}}function Y2(e,t,r,n){var s=Qe,a=ei.transition;ei.transition=null;try{Qe=4,ih(e,t,r,n)}finally{Qe=s,ei.transition=a}}function ih(e,t,r,n){if(mc){var s=zu(e,t,r,n);if(s===null)V0(e,t,n,gc,r),Qd(e,n);else if(X2(s,e,t,r,n))n.stopPropagation();else if(Qd(e,n),t&4&&-1<K2.indexOf(e)){for(;s!==null;){var a=nl(s);if(a!==null&&mx(a),a=zu(e,t,r,n),a===null&&V0(e,t,n,gc,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else V0(e,t,n,null,r)}}var gc=null;function zu(e,t,r,n){if(gc=null,e=rh(n),e=Ks(e),e!==null)if(t=ga(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ix(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return gc=e,null}function wx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(M2()){case nh:return 1;case ux:return 4;case hc:case B2:return 16;case fx:return 536870912;default:return 16}default:return 16}}var fs=null,oh=null,Jl=null;function yx(){if(Jl)return Jl;var e,t=oh,r=t.length,n,s="value"in fs?fs.value:fs.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return Jl=s.slice(e,1<n?1-n:void 0)}function Zl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bl(){return!0}function Jd(){return!1}function Mr(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?bl:Jd,this.isPropagationStopped=Jd,this}return dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=bl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=bl)},persist:function(){},isPersistent:bl}),t}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lh=Mr(yi),rl=dt({},yi,{view:0,detail:0}),J2=Mr(rl),D0,L0,Ri,Yc=dt({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ch,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ri&&(Ri&&e.type==="mousemove"?(D0=e.screenX-Ri.screenX,L0=e.screenY-Ri.screenY):L0=D0=0,Ri=e),D0)},movementY:function(e){return"movementY"in e?e.movementY:L0}}),Zd=Mr(Yc),Z2=dt({},Yc,{dataTransfer:0}),e_=Mr(Z2),t_=dt({},rl,{relatedTarget:0}),M0=Mr(t_),r_=dt({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),n_=Mr(r_),s_=dt({},yi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),a_=Mr(s_),i_=dt({},yi,{data:0}),em=Mr(i_),o_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},c_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=c_[e])?!!t[e]:!1}function ch(){return u_}var f_=dt({},rl,{key:function(e){if(e.key){var t=o_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?l_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ch,charCode:function(e){return e.type==="keypress"?Zl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),h_=Mr(f_),d_=dt({},Yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tm=Mr(d_),m_=dt({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ch}),g_=Mr(m_),p_=dt({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),x_=Mr(p_),v_=dt({},Yc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),w_=Mr(v_),y_=[9,13,27,32],uh=Vn&&"CompositionEvent"in window,eo=null;Vn&&"documentMode"in document&&(eo=document.documentMode);var __=Vn&&"TextEvent"in window&&!eo,_x=Vn&&(!uh||eo&&8<eo&&11>=eo),rm=String.fromCharCode(32),nm=!1;function kx(e,t){switch(e){case"keyup":return y_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ba=!1;function k_(e,t){switch(e){case"compositionend":return Sx(t);case"keypress":return t.which!==32?null:(nm=!0,rm);case"textInput":return e=t.data,e===rm&&nm?null:e;default:return null}}function S_(e,t){if(Ba)return e==="compositionend"||!uh&&kx(e,t)?(e=yx(),Jl=oh=fs=null,Ba=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _x&&t.locale!=="ko"?null:t.data;default:return null}}var E_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!E_[e.type]:t==="textarea"}function Ex(e,t,r,n){tx(n),t=pc(t,"onChange"),0<t.length&&(r=new lh("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var to=null,No=null;function b_(e){Rx(e,0)}function Jc(e){var t=Ha(e);if(Xp(t))return e}function T_(e,t){if(e==="change")return t}var bx=!1;if(Vn){var B0;if(Vn){var U0="oninput"in document;if(!U0){var am=document.createElement("div");am.setAttribute("oninput","return;"),U0=typeof am.oninput=="function"}B0=U0}else B0=!1;bx=B0&&(!document.documentMode||9<document.documentMode)}function im(){to&&(to.detachEvent("onpropertychange",Tx),No=to=null)}function Tx(e){if(e.propertyName==="value"&&Jc(No)){var t=[];Ex(t,No,e,rh(e)),ax(b_,t)}}function N_(e,t,r){e==="focusin"?(im(),to=t,No=r,to.attachEvent("onpropertychange",Tx)):e==="focusout"&&im()}function C_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Jc(No)}function A_(e,t){if(e==="click")return Jc(t)}function F_(e,t){if(e==="input"||e==="change")return Jc(t)}function j_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vn=typeof Object.is=="function"?Object.is:j_;function Co(e,t){if(vn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Tu.call(t,s)||!vn(e[s],t[s]))return!1}return!0}function om(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lm(e,t){var r=om(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=om(r)}}function Nx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Nx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Cx(){for(var e=window,t=cc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=cc(e.document)}return t}function fh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function O_(e){var t=Cx(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Nx(r.ownerDocument.documentElement,r)){if(n!==null&&fh(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=lm(r,a);var i=lm(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var P_=Vn&&"documentMode"in document&&11>=document.documentMode,Ua=null,Vu=null,ro=null,Gu=!1;function cm(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Gu||Ua==null||Ua!==cc(n)||(n=Ua,"selectionStart"in n&&fh(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ro&&Co(ro,n)||(ro=n,n=pc(Vu,"onSelect"),0<n.length&&(t=new lh("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ua)))}function Tl(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var $a={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionend:Tl("Transition","TransitionEnd")},$0={},Ax={};Vn&&(Ax=document.createElement("div").style,"AnimationEvent"in window||(delete $a.animationend.animation,delete $a.animationiteration.animation,delete $a.animationstart.animation),"TransitionEvent"in window||delete $a.transitionend.transition);function Zc(e){if($0[e])return $0[e];if(!$a[e])return e;var t=$a[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Ax)return $0[e]=t[r];return e}var Fx=Zc("animationend"),jx=Zc("animationiteration"),Ox=Zc("animationstart"),Px=Zc("transitionend"),Ix=new Map,um="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function js(e,t){Ix.set(e,t),ma(t,[e])}for(var H0=0;H0<um.length;H0++){var W0=um[H0],I_=W0.toLowerCase(),R_=W0[0].toUpperCase()+W0.slice(1);js(I_,"on"+R_)}js(Fx,"onAnimationEnd");js(jx,"onAnimationIteration");js(Ox,"onAnimationStart");js("dblclick","onDoubleClick");js("focusin","onFocus");js("focusout","onBlur");js(Px,"onTransitionEnd");oi("onMouseEnter",["mouseout","mouseover"]);oi("onMouseLeave",["mouseout","mouseover"]);oi("onPointerEnter",["pointerout","pointerover"]);oi("onPointerLeave",["pointerout","pointerover"]);ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ma("onBeforeInput",["compositionend","keypress","textInput","paste"]);ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gi));function fm(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,I2(n,t,void 0,e),e.currentTarget=null}function Rx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;fm(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;fm(s,o,c),a=l}}}if(fc)throw e=$u,fc=!1,$u=null,e}function et(e,t){var r=t[Yu];r===void 0&&(r=t[Yu]=new Set);var n=e+"__bubble";r.has(n)||(Dx(t,e,2,!1),r.add(n))}function z0(e,t,r){var n=0;t&&(n|=4),Dx(r,e,n,t)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function Ao(e){if(!e[Nl]){e[Nl]=!0,Wp.forEach(function(r){r!=="selectionchange"&&(D_.has(r)||z0(r,!1,e),z0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nl]||(t[Nl]=!0,z0("selectionchange",!1,t))}}function Dx(e,t,r,n){switch(wx(t)){case 1:var s=Q2;break;case 4:s=Y2;break;default:s=ih}r=s.bind(null,t,r,e),s=void 0,!Uu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function V0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Ks(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}ax(function(){var c=a,u=rh(r),h=[];e:{var d=Ix.get(e);if(d!==void 0){var m=lh,x=e;switch(e){case"keypress":if(Zl(r)===0)break e;case"keydown":case"keyup":m=h_;break;case"focusin":x="focus",m=M0;break;case"focusout":x="blur",m=M0;break;case"beforeblur":case"afterblur":m=M0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Zd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=e_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=g_;break;case Fx:case jx:case Ox:m=n_;break;case Px:m=x_;break;case"scroll":m=J2;break;case"wheel":m=w_;break;case"copy":case"cut":case"paste":m=a_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=tm}var g=(t&4)!==0,v=!g&&e==="scroll",w=g?d!==null?d+"Capture":null:d;g=[];for(var y=c,p;y!==null;){p=y;var _=p.stateNode;if(p.tag===5&&_!==null&&(p=_,w!==null&&(_=So(y,w),_!=null&&g.push(Fo(y,_,p)))),v)break;y=y.return}0<g.length&&(d=new m(d,x,null,r,u),h.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",d&&r!==Mu&&(x=r.relatedTarget||r.fromElement)&&(Ks(x)||x[Gn]))break e;if((m||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=c,x=x?Ks(x):null,x!==null&&(v=ga(x),x!==v||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=c),m!==x)){if(g=Zd,_="onMouseLeave",w="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=tm,_="onPointerLeave",w="onPointerEnter",y="pointer"),v=m==null?d:Ha(m),p=x==null?d:Ha(x),d=new g(_,y+"leave",m,r,u),d.target=v,d.relatedTarget=p,_=null,Ks(u)===c&&(g=new g(w,y+"enter",x,r,u),g.target=p,g.relatedTarget=v,_=g),v=_,m&&x)t:{for(g=m,w=x,y=0,p=g;p;p=Ea(p))y++;for(p=0,_=w;_;_=Ea(_))p++;for(;0<y-p;)g=Ea(g),y--;for(;0<p-y;)w=Ea(w),p--;for(;y--;){if(g===w||w!==null&&g===w.alternate)break t;g=Ea(g),w=Ea(w)}g=null}else g=null;m!==null&&hm(h,d,m,g,!1),x!==null&&v!==null&&hm(h,v,x,g,!0)}}e:{if(d=c?Ha(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var S=T_;else if(sm(d))if(bx)S=F_;else{S=C_;var E=N_}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(S=A_);if(S&&(S=S(e,c))){Ex(h,S,r,u);break e}E&&E(e,d,c),e==="focusout"&&(E=d._wrapperState)&&E.controlled&&d.type==="number"&&Pu(d,"number",d.value)}switch(E=c?Ha(c):window,e){case"focusin":(sm(E)||E.contentEditable==="true")&&(Ua=E,Vu=c,ro=null);break;case"focusout":ro=Vu=Ua=null;break;case"mousedown":Gu=!0;break;case"contextmenu":case"mouseup":case"dragend":Gu=!1,cm(h,r,u);break;case"selectionchange":if(P_)break;case"keydown":case"keyup":cm(h,r,u)}var k;if(uh)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Ba?kx(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(_x&&r.locale!=="ko"&&(Ba||C!=="onCompositionStart"?C==="onCompositionEnd"&&Ba&&(k=yx()):(fs=u,oh="value"in fs?fs.value:fs.textContent,Ba=!0)),E=pc(c,C),0<E.length&&(C=new em(C,e,null,r,u),h.push({event:C,listeners:E}),k?C.data=k:(k=Sx(r),k!==null&&(C.data=k)))),(k=__?k_(e,r):S_(e,r))&&(c=pc(c,"onBeforeInput"),0<c.length&&(u=new em("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=k))}Rx(h,t)})}function Fo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function pc(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=So(e,r),a!=null&&n.unshift(Fo(e,a,s)),a=So(e,t),a!=null&&n.push(Fo(e,a,s))),e=e.return}return n}function Ea(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function hm(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=So(r,a),l!=null&&i.unshift(Fo(r,l,o))):s||(l=So(r,a),l!=null&&i.push(Fo(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var L_=/\r\n?/g,M_=/\u0000|\uFFFD/g;function dm(e){return(typeof e=="string"?e:""+e).replace(L_,`
`).replace(M_,"")}function Cl(e,t,r){if(t=dm(t),dm(e)!==t&&r)throw Error(ce(425))}function xc(){}var Ku=null,Xu=null;function qu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qu=typeof setTimeout=="function"?setTimeout:void 0,B_=typeof clearTimeout=="function"?clearTimeout:void 0,mm=typeof Promise=="function"?Promise:void 0,U_=typeof queueMicrotask=="function"?queueMicrotask:typeof mm<"u"?function(e){return mm.resolve(null).then(e).catch($_)}:Qu;function $_(e){setTimeout(function(){throw e})}function G0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),To(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);To(t)}function vs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function gm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _i=Math.random().toString(36).slice(2),Nn="__reactFiber$"+_i,jo="__reactProps$"+_i,Gn="__reactContainer$"+_i,Yu="__reactEvents$"+_i,H_="__reactListeners$"+_i,W_="__reactHandles$"+_i;function Ks(e){var t=e[Nn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Gn]||r[Nn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=gm(e);e!==null;){if(r=e[Nn])return r;e=gm(e)}return t}e=r,r=e.parentNode}return null}function nl(e){return e=e[Nn]||e[Gn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ha(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function e0(e){return e[jo]||null}var Ju=[],Wa=-1;function Os(e){return{current:e}}function rt(e){0>Wa||(e.current=Ju[Wa],Ju[Wa]=null,Wa--)}function Ze(e,t){Wa++,Ju[Wa]=e.current,e.current=t}var Ts={},sr=Os(Ts),_r=Os(!1),na=Ts;function li(e,t){var r=e.type.contextTypes;if(!r)return Ts;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function kr(e){return e=e.childContextTypes,e!=null}function vc(){rt(_r),rt(sr)}function pm(e,t,r){if(sr.current!==Ts)throw Error(ce(168));Ze(sr,t),Ze(_r,r)}function Lx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ce(108,N2(e)||"Unknown",s));return dt({},r,n)}function wc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ts,na=sr.current,Ze(sr,e),Ze(_r,_r.current),!0}function xm(e,t,r){var n=e.stateNode;if(!n)throw Error(ce(169));r?(e=Lx(e,t,na),n.__reactInternalMemoizedMergedChildContext=e,rt(_r),rt(sr),Ze(sr,e)):rt(_r),Ze(_r,r)}var Ln=null,t0=!1,K0=!1;function Mx(e){Ln===null?Ln=[e]:Ln.push(e)}function z_(e){t0=!0,Mx(e)}function Ps(){if(!K0&&Ln!==null){K0=!0;var e=0,t=Qe;try{var r=Ln;for(Qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ln=null,t0=!1}catch(s){throw Ln!==null&&(Ln=Ln.slice(e+1)),cx(nh,Ps),s}finally{Qe=t,K0=!1}}return null}var za=[],Va=0,yc=null,_c=0,Kr=[],Xr=0,sa=null,Mn=1,Bn="";function Hs(e,t){za[Va++]=_c,za[Va++]=yc,yc=e,_c=t}function Bx(e,t,r){Kr[Xr++]=Mn,Kr[Xr++]=Bn,Kr[Xr++]=sa,sa=e;var n=Mn;e=Bn;var s=32-dn(n)-1;n&=~(1<<s),r+=1;var a=32-dn(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Mn=1<<32-dn(t)+s|r<<s|n,Bn=a+e}else Mn=1<<a|r<<s|n,Bn=e}function hh(e){e.return!==null&&(Hs(e,1),Bx(e,1,0))}function dh(e){for(;e===yc;)yc=za[--Va],za[Va]=null,_c=za[--Va],za[Va]=null;for(;e===sa;)sa=Kr[--Xr],Kr[Xr]=null,Bn=Kr[--Xr],Kr[Xr]=null,Mn=Kr[--Xr],Kr[Xr]=null}var Ir=null,Pr=null,it=!1,un=null;function Ux(e,t){var r=qr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function vm(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ir=e,Pr=vs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ir=e,Pr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=sa!==null?{id:Mn,overflow:Bn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=qr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ir=e,Pr=null,!0):!1;default:return!1}}function Zu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ef(e){if(it){var t=Pr;if(t){var r=t;if(!vm(e,t)){if(Zu(e))throw Error(ce(418));t=vs(r.nextSibling);var n=Ir;t&&vm(e,t)?Ux(n,r):(e.flags=e.flags&-4097|2,it=!1,Ir=e)}}else{if(Zu(e))throw Error(ce(418));e.flags=e.flags&-4097|2,it=!1,Ir=e}}}function wm(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ir=e}function Al(e){if(e!==Ir)return!1;if(!it)return wm(e),it=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!qu(e.type,e.memoizedProps)),t&&(t=Pr)){if(Zu(e))throw $x(),Error(ce(418));for(;t;)Ux(e,t),t=vs(t.nextSibling)}if(wm(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Pr=vs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Pr=null}}else Pr=Ir?vs(e.stateNode.nextSibling):null;return!0}function $x(){for(var e=Pr;e;)e=vs(e.nextSibling)}function ci(){Pr=Ir=null,it=!1}function mh(e){un===null?un=[e]:un.push(e)}var V_=Qn.ReactCurrentBatchConfig;function Di(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var n=r.stateNode}if(!n)throw Error(ce(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,e))}return e}function Fl(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ym(e){var t=e._init;return t(e._payload)}function Hx(e){function t(w,y){if(e){var p=w.deletions;p===null?(w.deletions=[y],w.flags|=16):p.push(y)}}function r(w,y){if(!e)return null;for(;y!==null;)t(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function s(w,y){return w=ks(w,y),w.index=0,w.sibling=null,w}function a(w,y,p){return w.index=p,e?(p=w.alternate,p!==null?(p=p.index,p<y?(w.flags|=2,y):p):(w.flags|=2,y)):(w.flags|=1048576,y)}function i(w){return e&&w.alternate===null&&(w.flags|=2),w}function o(w,y,p,_){return y===null||y.tag!==6?(y=eu(p,w.mode,_),y.return=w,y):(y=s(y,p),y.return=w,y)}function l(w,y,p,_){var S=p.type;return S===Ma?u(w,y,p.props.children,_,p.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ss&&ym(S)===y.type)?(_=s(y,p.props),_.ref=Di(w,y,p),_.return=w,_):(_=ic(p.type,p.key,p.props,null,w.mode,_),_.ref=Di(w,y,p),_.return=w,_)}function c(w,y,p,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==p.containerInfo||y.stateNode.implementation!==p.implementation?(y=tu(p,w.mode,_),y.return=w,y):(y=s(y,p.children||[]),y.return=w,y)}function u(w,y,p,_,S){return y===null||y.tag!==7?(y=Js(p,w.mode,_,S),y.return=w,y):(y=s(y,p),y.return=w,y)}function h(w,y,p){if(typeof y=="string"&&y!==""||typeof y=="number")return y=eu(""+y,w.mode,p),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wl:return p=ic(y.type,y.key,y.props,null,w.mode,p),p.ref=Di(w,null,y),p.return=w,p;case La:return y=tu(y,w.mode,p),y.return=w,y;case ss:var _=y._init;return h(w,_(y._payload),p)}if(zi(y)||ji(y))return y=Js(y,w.mode,p,null),y.return=w,y;Fl(w,y)}return null}function d(w,y,p,_){var S=y!==null?y.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return S!==null?null:o(w,y,""+p,_);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case wl:return p.key===S?l(w,y,p,_):null;case La:return p.key===S?c(w,y,p,_):null;case ss:return S=p._init,d(w,y,S(p._payload),_)}if(zi(p)||ji(p))return S!==null?null:u(w,y,p,_,null);Fl(w,p)}return null}function m(w,y,p,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return w=w.get(p)||null,o(y,w,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case wl:return w=w.get(_.key===null?p:_.key)||null,l(y,w,_,S);case La:return w=w.get(_.key===null?p:_.key)||null,c(y,w,_,S);case ss:var E=_._init;return m(w,y,p,E(_._payload),S)}if(zi(_)||ji(_))return w=w.get(p)||null,u(y,w,_,S,null);Fl(y,_)}return null}function x(w,y,p,_){for(var S=null,E=null,k=y,C=y=0,T=null;k!==null&&C<p.length;C++){k.index>C?(T=k,k=null):T=k.sibling;var R=d(w,k,p[C],_);if(R===null){k===null&&(k=T);break}e&&k&&R.alternate===null&&t(w,k),y=a(R,y,C),E===null?S=R:E.sibling=R,E=R,k=T}if(C===p.length)return r(w,k),it&&Hs(w,C),S;if(k===null){for(;C<p.length;C++)k=h(w,p[C],_),k!==null&&(y=a(k,y,C),E===null?S=k:E.sibling=k,E=k);return it&&Hs(w,C),S}for(k=n(w,k);C<p.length;C++)T=m(k,w,C,p[C],_),T!==null&&(e&&T.alternate!==null&&k.delete(T.key===null?C:T.key),y=a(T,y,C),E===null?S=T:E.sibling=T,E=T);return e&&k.forEach(function(L){return t(w,L)}),it&&Hs(w,C),S}function g(w,y,p,_){var S=ji(p);if(typeof S!="function")throw Error(ce(150));if(p=S.call(p),p==null)throw Error(ce(151));for(var E=S=null,k=y,C=y=0,T=null,R=p.next();k!==null&&!R.done;C++,R=p.next()){k.index>C?(T=k,k=null):T=k.sibling;var L=d(w,k,R.value,_);if(L===null){k===null&&(k=T);break}e&&k&&L.alternate===null&&t(w,k),y=a(L,y,C),E===null?S=L:E.sibling=L,E=L,k=T}if(R.done)return r(w,k),it&&Hs(w,C),S;if(k===null){for(;!R.done;C++,R=p.next())R=h(w,R.value,_),R!==null&&(y=a(R,y,C),E===null?S=R:E.sibling=R,E=R);return it&&Hs(w,C),S}for(k=n(w,k);!R.done;C++,R=p.next())R=m(k,w,C,R.value,_),R!==null&&(e&&R.alternate!==null&&k.delete(R.key===null?C:R.key),y=a(R,y,C),E===null?S=R:E.sibling=R,E=R);return e&&k.forEach(function(D){return t(w,D)}),it&&Hs(w,C),S}function v(w,y,p,_){if(typeof p=="object"&&p!==null&&p.type===Ma&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case wl:e:{for(var S=p.key,E=y;E!==null;){if(E.key===S){if(S=p.type,S===Ma){if(E.tag===7){r(w,E.sibling),y=s(E,p.props.children),y.return=w,w=y;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ss&&ym(S)===E.type){r(w,E.sibling),y=s(E,p.props),y.ref=Di(w,E,p),y.return=w,w=y;break e}r(w,E);break}else t(w,E);E=E.sibling}p.type===Ma?(y=Js(p.props.children,w.mode,_,p.key),y.return=w,w=y):(_=ic(p.type,p.key,p.props,null,w.mode,_),_.ref=Di(w,y,p),_.return=w,w=_)}return i(w);case La:e:{for(E=p.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===p.containerInfo&&y.stateNode.implementation===p.implementation){r(w,y.sibling),y=s(y,p.children||[]),y.return=w,w=y;break e}else{r(w,y);break}else t(w,y);y=y.sibling}y=tu(p,w.mode,_),y.return=w,w=y}return i(w);case ss:return E=p._init,v(w,y,E(p._payload),_)}if(zi(p))return x(w,y,p,_);if(ji(p))return g(w,y,p,_);Fl(w,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,y!==null&&y.tag===6?(r(w,y.sibling),y=s(y,p),y.return=w,w=y):(r(w,y),y=eu(p,w.mode,_),y.return=w,w=y),i(w)):r(w,y)}return v}var ui=Hx(!0),Wx=Hx(!1),kc=Os(null),Sc=null,Ga=null,gh=null;function ph(){gh=Ga=Sc=null}function xh(e){var t=kc.current;rt(kc),e._currentValue=t}function tf(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ti(e,t){Sc=e,gh=Ga=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(yr=!0),e.firstContext=null)}function Zr(e){var t=e._currentValue;if(gh!==e)if(e={context:e,memoizedValue:t,next:null},Ga===null){if(Sc===null)throw Error(ce(308));Ga=e,Sc.dependencies={lanes:0,firstContext:e}}else Ga=Ga.next=e;return t}var Xs=null;function vh(e){Xs===null?Xs=[e]:Xs.push(e)}function zx(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,vh(t)):(r.next=s.next,s.next=r),t.interleaved=r,Kn(e,n)}function Kn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var as=!1;function wh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ws(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,$e&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Kn(e,r)}return s=n.interleaved,s===null?(t.next=t,vh(n)):(t.next=s.next,s.next=t),n.interleaved=t,Kn(e,r)}function ec(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sh(e,r)}}function _m(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ec(e,t,r,n){var s=e.updateQueue;as=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,u=c=l=null,o=a;do{var d=o.lane,m=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(d=t,m=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){h=x.call(m,h,d);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,d=typeof x=="function"?x.call(m,h,d):x,d==null)break e;h=dt({},h,d);break e;case 2:as=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,i|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);ia|=i,e.lanes=i,e.memoizedState=h}}function km(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ce(191,s));s.call(n)}}}var sl={},Fn=Os(sl),Oo=Os(sl),Po=Os(sl);function qs(e){if(e===sl)throw Error(ce(174));return e}function yh(e,t){switch(Ze(Po,t),Ze(Oo,e),Ze(Fn,sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ru(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ru(t,e)}rt(Fn),Ze(Fn,t)}function fi(){rt(Fn),rt(Oo),rt(Po)}function Gx(e){qs(Po.current);var t=qs(Fn.current),r=Ru(t,e.type);t!==r&&(Ze(Oo,e),Ze(Fn,r))}function _h(e){Oo.current===e&&(rt(Fn),rt(Oo))}var ct=Os(0);function bc(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var X0=[];function kh(){for(var e=0;e<X0.length;e++)X0[e]._workInProgressVersionPrimary=null;X0.length=0}var tc=Qn.ReactCurrentDispatcher,q0=Qn.ReactCurrentBatchConfig,aa=0,ht=null,Ot=null,Mt=null,Tc=!1,no=!1,Io=0,G_=0;function qt(){throw Error(ce(321))}function Sh(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!vn(e[r],t[r]))return!1;return!0}function Eh(e,t,r,n,s,a){if(aa=a,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tc.current=e===null||e.memoizedState===null?Q_:Y_,e=r(n,s),no){a=0;do{if(no=!1,Io=0,25<=a)throw Error(ce(301));a+=1,Mt=Ot=null,t.updateQueue=null,tc.current=J_,e=r(n,s)}while(no)}if(tc.current=Nc,t=Ot!==null&&Ot.next!==null,aa=0,Mt=Ot=ht=null,Tc=!1,t)throw Error(ce(300));return e}function bh(){var e=Io!==0;return Io=0,e}function bn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?ht.memoizedState=Mt=e:Mt=Mt.next=e,Mt}function en(){if(Ot===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=Ot.next;var t=Mt===null?ht.memoizedState:Mt.next;if(t!==null)Mt=t,Ot=e;else{if(e===null)throw Error(ce(310));Ot=e,e={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Mt===null?ht.memoizedState=Mt=e:Mt=Mt.next=e}return Mt}function Ro(e,t){return typeof t=="function"?t(e):t}function Q0(e){var t=en(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=Ot,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var u=c.lane;if((aa&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,ht.lanes|=u,ia|=u}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,vn(n,t.memoizedState)||(yr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,ht.lanes|=a,ia|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Y0(e){var t=en(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);vn(a,t.memoizedState)||(yr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Kx(){}function Xx(e,t){var r=ht,n=en(),s=t(),a=!vn(n.memoizedState,s);if(a&&(n.memoizedState=s,yr=!0),n=n.queue,Th(Yx.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Mt!==null&&Mt.memoizedState.tag&1){if(r.flags|=2048,Do(9,Qx.bind(null,r,n,s,t),void 0,null),$t===null)throw Error(ce(349));aa&30||qx(r,t,s)}return s}function qx(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Qx(e,t,r,n){t.value=r,t.getSnapshot=n,Jx(t)&&Zx(e)}function Yx(e,t,r){return r(function(){Jx(t)&&Zx(e)})}function Jx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vn(e,r)}catch{return!0}}function Zx(e){var t=Kn(e,1);t!==null&&mn(t,e,1,-1)}function Sm(e){var t=bn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:e},t.queue=e,e=e.dispatch=q_.bind(null,ht,e),[t.memoizedState,e]}function Do(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function e1(){return en().memoizedState}function rc(e,t,r,n){var s=bn();ht.flags|=e,s.memoizedState=Do(1|t,r,void 0,n===void 0?null:n)}function r0(e,t,r,n){var s=en();n=n===void 0?null:n;var a=void 0;if(Ot!==null){var i=Ot.memoizedState;if(a=i.destroy,n!==null&&Sh(n,i.deps)){s.memoizedState=Do(t,r,a,n);return}}ht.flags|=e,s.memoizedState=Do(1|t,r,a,n)}function Em(e,t){return rc(8390656,8,e,t)}function Th(e,t){return r0(2048,8,e,t)}function t1(e,t){return r0(4,2,e,t)}function r1(e,t){return r0(4,4,e,t)}function n1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function s1(e,t,r){return r=r!=null?r.concat([e]):null,r0(4,4,n1.bind(null,t,e),r)}function Nh(){}function a1(e,t){var r=en();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Sh(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function i1(e,t){var r=en();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Sh(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function o1(e,t,r){return aa&21?(vn(r,t)||(r=hx(),ht.lanes|=r,ia|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,yr=!0),e.memoizedState=r)}function K_(e,t){var r=Qe;Qe=r!==0&&4>r?r:4,e(!0);var n=q0.transition;q0.transition={};try{e(!1),t()}finally{Qe=r,q0.transition=n}}function l1(){return en().memoizedState}function X_(e,t,r){var n=_s(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},c1(e))u1(t,r);else if(r=zx(e,t,r,n),r!==null){var s=ur();mn(r,e,n,s),f1(r,t,n)}}function q_(e,t,r){var n=_s(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(c1(e))u1(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,vn(o,i)){var l=t.interleaved;l===null?(s.next=s,vh(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=zx(e,t,s,n),r!==null&&(s=ur(),mn(r,e,n,s),f1(r,t,n))}}function c1(e){var t=e.alternate;return e===ht||t!==null&&t===ht}function u1(e,t){no=Tc=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function f1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sh(e,r)}}var Nc={readContext:Zr,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},Q_={readContext:Zr,useCallback:function(e,t){return bn().memoizedState=[e,t===void 0?null:t],e},useContext:Zr,useEffect:Em,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,rc(4194308,4,n1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return rc(4194308,4,e,t)},useInsertionEffect:function(e,t){return rc(4,2,e,t)},useMemo:function(e,t){var r=bn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=bn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=X_.bind(null,ht,e),[n.memoizedState,e]},useRef:function(e){var t=bn();return e={current:e},t.memoizedState=e},useState:Sm,useDebugValue:Nh,useDeferredValue:function(e){return bn().memoizedState=e},useTransition:function(){var e=Sm(!1),t=e[0];return e=K_.bind(null,e[1]),bn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ht,s=bn();if(it){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=t(),$t===null)throw Error(ce(349));aa&30||qx(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,Em(Yx.bind(null,n,a,e),[e]),n.flags|=2048,Do(9,Qx.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=bn(),t=$t.identifierPrefix;if(it){var r=Bn,n=Mn;r=(n&~(1<<32-dn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Io++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=G_++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Y_={readContext:Zr,useCallback:a1,useContext:Zr,useEffect:Th,useImperativeHandle:s1,useInsertionEffect:t1,useLayoutEffect:r1,useMemo:i1,useReducer:Q0,useRef:e1,useState:function(){return Q0(Ro)},useDebugValue:Nh,useDeferredValue:function(e){var t=en();return o1(t,Ot.memoizedState,e)},useTransition:function(){var e=Q0(Ro)[0],t=en().memoizedState;return[e,t]},useMutableSource:Kx,useSyncExternalStore:Xx,useId:l1,unstable_isNewReconciler:!1},J_={readContext:Zr,useCallback:a1,useContext:Zr,useEffect:Th,useImperativeHandle:s1,useInsertionEffect:t1,useLayoutEffect:r1,useMemo:i1,useReducer:Y0,useRef:e1,useState:function(){return Y0(Ro)},useDebugValue:Nh,useDeferredValue:function(e){var t=en();return Ot===null?t.memoizedState=e:o1(t,Ot.memoizedState,e)},useTransition:function(){var e=Y0(Ro)[0],t=en().memoizedState;return[e,t]},useMutableSource:Kx,useSyncExternalStore:Xx,useId:l1,unstable_isNewReconciler:!1};function on(e,t){if(e&&e.defaultProps){t=dt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function rf(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:dt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var n0={isMounted:function(e){return(e=e._reactInternals)?ga(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ur(),s=_s(e),a=$n(n,s);a.payload=t,r!=null&&(a.callback=r),t=ws(e,a,s),t!==null&&(mn(t,e,s,n),ec(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ur(),s=_s(e),a=$n(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ws(e,a,s),t!==null&&(mn(t,e,s,n),ec(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ur(),n=_s(e),s=$n(r,n);s.tag=2,t!=null&&(s.callback=t),t=ws(e,s,n),t!==null&&(mn(t,e,n,r),ec(t,e,n))}};function bm(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Co(r,n)||!Co(s,a):!0}function h1(e,t,r){var n=!1,s=Ts,a=t.contextType;return typeof a=="object"&&a!==null?a=Zr(a):(s=kr(t)?na:sr.current,n=t.contextTypes,a=(n=n!=null)?li(e,s):Ts),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=n0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function Tm(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&n0.enqueueReplaceState(t,t.state,null)}function nf(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},wh(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Zr(a):(a=kr(t)?na:sr.current,s.context=li(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(rf(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&n0.enqueueReplaceState(s,s.state,null),Ec(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function hi(e,t){try{var r="",n=t;do r+=T2(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function J0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function sf(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Z_=typeof WeakMap=="function"?WeakMap:Map;function d1(e,t,r){r=$n(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ac||(Ac=!0,gf=n),sf(e,t)},r}function m1(e,t,r){r=$n(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){sf(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){sf(e,t),typeof n!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Nm(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Z_;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=dk.bind(null,e,t,r),t.then(e,e))}function Cm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Am(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=$n(-1,1),t.tag=2,ws(r,t,1))),r.lanes|=1),e)}var ek=Qn.ReactCurrentOwner,yr=!1;function or(e,t,r,n){t.child=e===null?Wx(t,null,r,n):ui(t,e.child,r,n)}function Fm(e,t,r,n,s){r=r.render;var a=t.ref;return ti(t,s),n=Eh(e,t,r,n,a,s),r=bh(),e!==null&&!yr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Xn(e,t,s)):(it&&r&&hh(t),t.flags|=1,or(e,t,n,s),t.child)}function jm(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Rh(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,g1(e,t,a,n,s)):(e=ic(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Co,r(i,n)&&e.ref===t.ref)return Xn(e,t,s)}return t.flags|=1,e=ks(a,n),e.ref=t.ref,e.return=t,t.child=e}function g1(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Co(a,n)&&e.ref===t.ref)if(yr=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(yr=!0);else return t.lanes=e.lanes,Xn(e,t,s)}return af(e,t,r,n,s)}function p1(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Xa,Nr),Nr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ze(Xa,Nr),Nr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Ze(Xa,Nr),Nr|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ze(Xa,Nr),Nr|=n;return or(e,t,s,r),t.child}function x1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function af(e,t,r,n,s){var a=kr(r)?na:sr.current;return a=li(t,a),ti(t,s),r=Eh(e,t,r,n,a,s),n=bh(),e!==null&&!yr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Xn(e,t,s)):(it&&n&&hh(t),t.flags|=1,or(e,t,r,s),t.child)}function Om(e,t,r,n,s){if(kr(r)){var a=!0;wc(t)}else a=!1;if(ti(t,s),t.stateNode===null)nc(e,t),h1(t,r,n),nf(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Zr(c):(c=kr(r)?na:sr.current,c=li(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Tm(t,i,n,c),as=!1;var d=t.memoizedState;i.state=d,Ec(t,n,i,s),l=t.memoizedState,o!==n||d!==l||_r.current||as?(typeof u=="function"&&(rf(t,r,u,n),l=t.memoizedState),(o=as||bm(t,r,o,n,d,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Vx(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:on(t.type,o),i.props=c,h=t.pendingProps,d=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Zr(l):(l=kr(r)?na:sr.current,l=li(t,l));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Tm(t,i,n,l),as=!1,d=t.memoizedState,i.state=d,Ec(t,n,i,s);var x=t.memoizedState;o!==h||d!==x||_r.current||as?(typeof m=="function"&&(rf(t,r,m,n),x=t.memoizedState),(c=as||bm(t,r,c,n,d,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return of(e,t,r,n,a,s)}function of(e,t,r,n,s,a){x1(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&xm(t,r,!1),Xn(e,t,a);n=t.stateNode,ek.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=ui(t,e.child,null,a),t.child=ui(t,null,o,a)):or(e,t,o,a),t.memoizedState=n.state,s&&xm(t,r,!0),t.child}function v1(e){var t=e.stateNode;t.pendingContext?pm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&pm(e,t.context,!1),yh(e,t.containerInfo)}function Pm(e,t,r,n,s){return ci(),mh(s),t.flags|=256,or(e,t,r,n),t.child}var lf={dehydrated:null,treeContext:null,retryLane:0};function cf(e){return{baseLanes:e,cachePool:null,transitions:null}}function w1(e,t,r){var n=t.pendingProps,s=ct.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ze(ct,s&1),e===null)return ef(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=i0(i,n,0,null),e=Js(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=cf(r),t.memoizedState=lf,e):Ch(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return tk(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ks(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=ks(o,a):(a=Js(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?cf(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=lf,n}return a=e.child,e=a.sibling,n=ks(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ch(e,t){return t=i0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function jl(e,t,r,n){return n!==null&&mh(n),ui(t,e.child,null,r),e=Ch(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function tk(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=J0(Error(ce(422))),jl(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=i0({mode:"visible",children:n.children},s,0,null),a=Js(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&ui(t,e.child,null,i),t.child.memoizedState=cf(i),t.memoizedState=lf,a);if(!(t.mode&1))return jl(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ce(419)),n=J0(a,n,void 0),jl(e,t,i,n)}if(o=(i&e.childLanes)!==0,yr||o){if(n=$t,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Kn(e,s),mn(n,e,s,-1))}return Ih(),n=J0(Error(ce(421))),jl(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=mk.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Pr=vs(s.nextSibling),Ir=t,it=!0,un=null,e!==null&&(Kr[Xr++]=Mn,Kr[Xr++]=Bn,Kr[Xr++]=sa,Mn=e.id,Bn=e.overflow,sa=t),t=Ch(t,n.children),t.flags|=4096,t)}function Im(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),tf(e.return,t,r)}function Z0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function y1(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(or(e,t,n.children,r),n=ct.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Im(e,r,t);else if(e.tag===19)Im(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ze(ct,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&bc(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Z0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&bc(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Z0(t,!0,r,null,a);break;case"together":Z0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ia|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,r=ks(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ks(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function rk(e,t,r){switch(t.tag){case 3:v1(t),ci();break;case 5:Gx(t);break;case 1:kr(t.type)&&wc(t);break;case 4:yh(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ze(kc,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ze(ct,ct.current&1),t.flags|=128,null):r&t.child.childLanes?w1(e,t,r):(Ze(ct,ct.current&1),e=Xn(e,t,r),e!==null?e.sibling:null);Ze(ct,ct.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return y1(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ze(ct,ct.current),n)break;return null;case 22:case 23:return t.lanes=0,p1(e,t,r)}return Xn(e,t,r)}var _1,uf,k1,S1;_1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};uf=function(){};k1=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,qs(Fn.current);var a=null;switch(r){case"input":s=ju(e,s),n=ju(e,n),a=[];break;case"select":s=dt({},s,{value:void 0}),n=dt({},n,{value:void 0}),a=[];break;case"textarea":s=Iu(e,s),n=Iu(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=xc)}Du(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(_o.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(_o.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&et("scroll",e),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};S1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Li(e,t){if(!it)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function nk(e,t,r){var n=t.pendingProps;switch(dh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(t),null;case 1:return kr(t.type)&&vc(),Qt(t),null;case 3:return n=t.stateNode,fi(),rt(_r),rt(sr),kh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Al(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,un!==null&&(vf(un),un=null))),uf(e,t),Qt(t),null;case 5:_h(t);var s=qs(Po.current);if(r=t.type,e!==null&&t.stateNode!=null)k1(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ce(166));return Qt(t),null}if(e=qs(Fn.current),Al(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Nn]=t,n[jo]=a,e=(t.mode&1)!==0,r){case"dialog":et("cancel",n),et("close",n);break;case"iframe":case"object":case"embed":et("load",n);break;case"video":case"audio":for(s=0;s<Gi.length;s++)et(Gi[s],n);break;case"source":et("error",n);break;case"img":case"image":case"link":et("error",n),et("load",n);break;case"details":et("toggle",n);break;case"input":Wd(n,a),et("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},et("invalid",n);break;case"textarea":Vd(n,a),et("invalid",n)}Du(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Cl(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Cl(n.textContent,o,e),s=["children",""+o]):_o.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&et("scroll",n)}switch(r){case"input":yl(n),zd(n,a,!0);break;case"textarea":yl(n),Gd(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=xc)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Yp(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Nn]=t,e[jo]=n,_1(e,t,!1,!1),t.stateNode=e;e:{switch(i=Lu(r,n),r){case"dialog":et("cancel",e),et("close",e),s=n;break;case"iframe":case"object":case"embed":et("load",e),s=n;break;case"video":case"audio":for(s=0;s<Gi.length;s++)et(Gi[s],e);s=n;break;case"source":et("error",e),s=n;break;case"img":case"image":case"link":et("error",e),et("load",e),s=n;break;case"details":et("toggle",e),s=n;break;case"input":Wd(e,n),s=ju(e,n),et("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=dt({},n,{value:void 0}),et("invalid",e);break;case"textarea":Vd(e,n),s=Iu(e,n),et("invalid",e);break;default:s=n}Du(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?ex(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jp(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ko(e,l):typeof l=="number"&&ko(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(_o.hasOwnProperty(a)?l!=null&&a==="onScroll"&&et("scroll",e):l!=null&&Jf(e,a,l,i))}switch(r){case"input":yl(e),zd(e,n,!1);break;case"textarea":yl(e),Gd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+bs(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Ya(e,!!n.multiple,a,!1):n.defaultValue!=null&&Ya(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=xc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qt(t),null;case 6:if(e&&t.stateNode!=null)S1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ce(166));if(r=qs(Po.current),qs(Fn.current),Al(t)){if(n=t.stateNode,r=t.memoizedProps,n[Nn]=t,(a=n.nodeValue!==r)&&(e=Ir,e!==null))switch(e.tag){case 3:Cl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Cl(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Nn]=t,t.stateNode=n}return Qt(t),null;case 13:if(rt(ct),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(it&&Pr!==null&&t.mode&1&&!(t.flags&128))$x(),ci(),t.flags|=98560,a=!1;else if(a=Al(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ce(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ce(317));a[Nn]=t}else ci(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qt(t),a=!1}else un!==null&&(vf(un),un=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||ct.current&1?It===0&&(It=3):Ih())),t.updateQueue!==null&&(t.flags|=4),Qt(t),null);case 4:return fi(),uf(e,t),e===null&&Ao(t.stateNode.containerInfo),Qt(t),null;case 10:return xh(t.type._context),Qt(t),null;case 17:return kr(t.type)&&vc(),Qt(t),null;case 19:if(rt(ct),a=t.memoizedState,a===null)return Qt(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Li(a,!1);else{if(It!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=bc(e),i!==null){for(t.flags|=128,Li(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ze(ct,ct.current&1|2),t.child}e=e.sibling}a.tail!==null&&_t()>di&&(t.flags|=128,n=!0,Li(a,!1),t.lanes=4194304)}else{if(!n)if(e=bc(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Li(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!it)return Qt(t),null}else 2*_t()-a.renderingStartTime>di&&r!==1073741824&&(t.flags|=128,n=!0,Li(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=_t(),t.sibling=null,r=ct.current,Ze(ct,n?r&1|2:r&1),t):(Qt(t),null);case 22:case 23:return Ph(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Nr&1073741824&&(Qt(t),t.subtreeFlags&6&&(t.flags|=8192)):Qt(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function sk(e,t){switch(dh(t),t.tag){case 1:return kr(t.type)&&vc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fi(),rt(_r),rt(sr),kh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _h(t),null;case 13:if(rt(ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));ci()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return rt(ct),null;case 4:return fi(),null;case 10:return xh(t.type._context),null;case 22:case 23:return Ph(),null;case 24:return null;default:return null}}var Ol=!1,er=!1,ak=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Ka(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mt(e,t,n)}else r.current=null}function ff(e,t,r){try{r()}catch(n){mt(e,t,n)}}var Rm=!1;function ik(e,t){if(Ku=mc,e=Cx(),fh(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===e)break t;if(d===r&&++c===s&&(o=i),d===a&&++u===n&&(l=i),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Xu={focusedElem:e,selectionRange:r},mc=!1,ye=t;ye!==null;)if(t=ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ye=e;else for(;ye!==null;){t=ye;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,v=x.memoizedState,w=t.stateNode,y=w.getSnapshotBeforeUpdate(t.elementType===t.type?g:on(t.type,g),v);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(_){mt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,ye=e;break}ye=t.return}return x=Rm,Rm=!1,x}function so(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&ff(t,r,a)}s=s.next}while(s!==n)}}function s0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function hf(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function E1(e){var t=e.alternate;t!==null&&(e.alternate=null,E1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Nn],delete t[jo],delete t[Yu],delete t[H_],delete t[W_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function b1(e){return e.tag===5||e.tag===3||e.tag===4}function Dm(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||b1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function df(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=xc));else if(n!==4&&(e=e.child,e!==null))for(df(e,t,r),e=e.sibling;e!==null;)df(e,t,r),e=e.sibling}function mf(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(mf(e,t,r),e=e.sibling;e!==null;)mf(e,t,r),e=e.sibling}var Wt=null,ln=!1;function es(e,t,r){for(r=r.child;r!==null;)T1(e,t,r),r=r.sibling}function T1(e,t,r){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(Qc,r)}catch{}switch(r.tag){case 5:er||Ka(r,t);case 6:var n=Wt,s=ln;Wt=null,es(e,t,r),Wt=n,ln=s,Wt!==null&&(ln?(e=Wt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Wt.removeChild(r.stateNode));break;case 18:Wt!==null&&(ln?(e=Wt,r=r.stateNode,e.nodeType===8?G0(e.parentNode,r):e.nodeType===1&&G0(e,r),To(e)):G0(Wt,r.stateNode));break;case 4:n=Wt,s=ln,Wt=r.stateNode.containerInfo,ln=!0,es(e,t,r),Wt=n,ln=s;break;case 0:case 11:case 14:case 15:if(!er&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&ff(r,t,i),s=s.next}while(s!==n)}es(e,t,r);break;case 1:if(!er&&(Ka(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){mt(r,t,o)}es(e,t,r);break;case 21:es(e,t,r);break;case 22:r.mode&1?(er=(n=er)||r.memoizedState!==null,es(e,t,r),er=n):es(e,t,r);break;default:es(e,t,r)}}function Lm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new ak),t.forEach(function(n){var s=gk.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function sn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Wt=o.stateNode,ln=!1;break e;case 3:Wt=o.stateNode.containerInfo,ln=!0;break e;case 4:Wt=o.stateNode.containerInfo,ln=!0;break e}o=o.return}if(Wt===null)throw Error(ce(160));T1(a,i,s),Wt=null,ln=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){mt(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)N1(t,e),t=t.sibling}function N1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(sn(t,e),yn(e),n&4){try{so(3,e,e.return),s0(3,e)}catch(g){mt(e,e.return,g)}try{so(5,e,e.return)}catch(g){mt(e,e.return,g)}}break;case 1:sn(t,e),yn(e),n&512&&r!==null&&Ka(r,r.return);break;case 5:if(sn(t,e),yn(e),n&512&&r!==null&&Ka(r,r.return),e.flags&32){var s=e.stateNode;try{ko(s,"")}catch(g){mt(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&qp(s,a),Lu(o,i);var c=Lu(o,a);for(i=0;i<l.length;i+=2){var u=l[i],h=l[i+1];u==="style"?ex(s,h):u==="dangerouslySetInnerHTML"?Jp(s,h):u==="children"?ko(s,h):Jf(s,u,h,c)}switch(o){case"input":Ou(s,a);break;case"textarea":Qp(s,a);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Ya(s,!!a.multiple,m,!1):d!==!!a.multiple&&(a.defaultValue!=null?Ya(s,!!a.multiple,a.defaultValue,!0):Ya(s,!!a.multiple,a.multiple?[]:"",!1))}s[jo]=a}catch(g){mt(e,e.return,g)}}break;case 6:if(sn(t,e),yn(e),n&4){if(e.stateNode===null)throw Error(ce(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){mt(e,e.return,g)}}break;case 3:if(sn(t,e),yn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{To(t.containerInfo)}catch(g){mt(e,e.return,g)}break;case 4:sn(t,e),yn(e);break;case 13:sn(t,e),yn(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(jh=_t())),n&4&&Lm(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(er=(c=er)||u,sn(t,e),er=c):sn(t,e),yn(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(h=ye=u;ye!==null;){switch(d=ye,m=d.child,d.tag){case 0:case 11:case 14:case 15:so(4,d,d.return);break;case 1:Ka(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){mt(n,r,g)}}break;case 5:Ka(d,d.return);break;case 22:if(d.memoizedState!==null){Bm(h);continue}}m!==null?(m.return=d,ye=m):Bm(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Zp("display",i))}catch(g){mt(e,e.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){mt(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:sn(t,e),yn(e),n&4&&Lm(e);break;case 21:break;default:sn(t,e),yn(e)}}function yn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(b1(r)){var n=r;break e}r=r.return}throw Error(ce(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ko(s,""),n.flags&=-33);var a=Dm(e);mf(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Dm(e);df(e,o,i);break;default:throw Error(ce(161))}}catch(l){mt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ok(e,t,r){ye=e,C1(e)}function C1(e,t,r){for(var n=(e.mode&1)!==0;ye!==null;){var s=ye,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Ol;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||er;o=Ol;var c=er;if(Ol=i,(er=l)&&!c)for(ye=s;ye!==null;)i=ye,l=i.child,i.tag===22&&i.memoizedState!==null?Um(s):l!==null?(l.return=i,ye=l):Um(s);for(;a!==null;)ye=a,C1(a),a=a.sibling;ye=s,Ol=o,er=c}Mm(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,ye=a):Mm(e)}}function Mm(e){for(;ye!==null;){var t=ye;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:er||s0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!er)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:on(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&km(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}km(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&To(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}er||t.flags&512&&hf(t)}catch(d){mt(t,t.return,d)}}if(t===e){ye=null;break}if(r=t.sibling,r!==null){r.return=t.return,ye=r;break}ye=t.return}}function Bm(e){for(;ye!==null;){var t=ye;if(t===e){ye=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ye=r;break}ye=t.return}}function Um(e){for(;ye!==null;){var t=ye;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{s0(4,t)}catch(l){mt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){mt(t,s,l)}}var a=t.return;try{hf(t)}catch(l){mt(t,a,l)}break;case 5:var i=t.return;try{hf(t)}catch(l){mt(t,i,l)}}}catch(l){mt(t,t.return,l)}if(t===e){ye=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ye=o;break}ye=t.return}}var lk=Math.ceil,Cc=Qn.ReactCurrentDispatcher,Ah=Qn.ReactCurrentOwner,Qr=Qn.ReactCurrentBatchConfig,$e=0,$t=null,Ct=null,Gt=0,Nr=0,Xa=Os(0),It=0,Lo=null,ia=0,a0=0,Fh=0,ao=null,vr=null,jh=0,di=1/0,Rn=null,Ac=!1,gf=null,ys=null,Pl=!1,hs=null,Fc=0,io=0,pf=null,sc=-1,ac=0;function ur(){return $e&6?_t():sc!==-1?sc:sc=_t()}function _s(e){return e.mode&1?$e&2&&Gt!==0?Gt&-Gt:V_.transition!==null?(ac===0&&(ac=hx()),ac):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:wx(e.type)),e):1}function mn(e,t,r,n){if(50<io)throw io=0,pf=null,Error(ce(185));tl(e,r,n),(!($e&2)||e!==$t)&&(e===$t&&(!($e&2)&&(a0|=r),It===4&&os(e,Gt)),Sr(e,n),r===1&&$e===0&&!(t.mode&1)&&(di=_t()+500,t0&&Ps()))}function Sr(e,t){var r=e.callbackNode;V2(e,t);var n=dc(e,e===$t?Gt:0);if(n===0)r!==null&&qd(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&qd(r),t===1)e.tag===0?z_($m.bind(null,e)):Mx($m.bind(null,e)),U_(function(){!($e&6)&&Ps()}),r=null;else{switch(dx(n)){case 1:r=nh;break;case 4:r=ux;break;case 16:r=hc;break;case 536870912:r=fx;break;default:r=hc}r=D1(r,A1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function A1(e,t){if(sc=-1,ac=0,$e&6)throw Error(ce(327));var r=e.callbackNode;if(ri()&&e.callbackNode!==r)return null;var n=dc(e,e===$t?Gt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=jc(e,n);else{t=n;var s=$e;$e|=2;var a=j1();($t!==e||Gt!==t)&&(Rn=null,di=_t()+500,Ys(e,t));do try{fk();break}catch(o){F1(e,o)}while(1);ph(),Cc.current=a,$e=s,Ct!==null?t=0:($t=null,Gt=0,t=It)}if(t!==0){if(t===2&&(s=Hu(e),s!==0&&(n=s,t=xf(e,s))),t===1)throw r=Lo,Ys(e,0),os(e,n),Sr(e,_t()),r;if(t===6)os(e,n);else{if(s=e.current.alternate,!(n&30)&&!ck(s)&&(t=jc(e,n),t===2&&(a=Hu(e),a!==0&&(n=a,t=xf(e,a))),t===1))throw r=Lo,Ys(e,0),os(e,n),Sr(e,_t()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ce(345));case 2:Ws(e,vr,Rn);break;case 3:if(os(e,n),(n&130023424)===n&&(t=jh+500-_t(),10<t)){if(dc(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){ur(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Qu(Ws.bind(null,e,vr,Rn),t);break}Ws(e,vr,Rn);break;case 4:if(os(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-dn(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=_t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*lk(n/1960))-n,10<n){e.timeoutHandle=Qu(Ws.bind(null,e,vr,Rn),n);break}Ws(e,vr,Rn);break;case 5:Ws(e,vr,Rn);break;default:throw Error(ce(329))}}}return Sr(e,_t()),e.callbackNode===r?A1.bind(null,e):null}function xf(e,t){var r=ao;return e.current.memoizedState.isDehydrated&&(Ys(e,t).flags|=256),e=jc(e,t),e!==2&&(t=vr,vr=r,t!==null&&vf(t)),e}function vf(e){vr===null?vr=e:vr.push.apply(vr,e)}function ck(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!vn(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function os(e,t){for(t&=~Fh,t&=~a0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-dn(t),n=1<<r;e[r]=-1,t&=~n}}function $m(e){if($e&6)throw Error(ce(327));ri();var t=dc(e,0);if(!(t&1))return Sr(e,_t()),null;var r=jc(e,t);if(e.tag!==0&&r===2){var n=Hu(e);n!==0&&(t=n,r=xf(e,n))}if(r===1)throw r=Lo,Ys(e,0),os(e,t),Sr(e,_t()),r;if(r===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ws(e,vr,Rn),Sr(e,_t()),null}function Oh(e,t){var r=$e;$e|=1;try{return e(t)}finally{$e=r,$e===0&&(di=_t()+500,t0&&Ps())}}function oa(e){hs!==null&&hs.tag===0&&!($e&6)&&ri();var t=$e;$e|=1;var r=Qr.transition,n=Qe;try{if(Qr.transition=null,Qe=1,e)return e()}finally{Qe=n,Qr.transition=r,$e=t,!($e&6)&&Ps()}}function Ph(){Nr=Xa.current,rt(Xa)}function Ys(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,B_(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(dh(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vc();break;case 3:fi(),rt(_r),rt(sr),kh();break;case 5:_h(n);break;case 4:fi();break;case 13:rt(ct);break;case 19:rt(ct);break;case 10:xh(n.type._context);break;case 22:case 23:Ph()}r=r.return}if($t=e,Ct=e=ks(e.current,null),Gt=Nr=t,It=0,Lo=null,Fh=a0=ia=0,vr=ao=null,Xs!==null){for(t=0;t<Xs.length;t++)if(r=Xs[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Xs=null}return e}function F1(e,t){do{var r=Ct;try{if(ph(),tc.current=Nc,Tc){for(var n=ht.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Tc=!1}if(aa=0,Mt=Ot=ht=null,no=!1,Io=0,Ah.current=null,r===null||r.return===null){It=1,Lo=t,Ct=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=Gt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=Cm(i);if(m!==null){m.flags&=-257,Am(m,i,o,a,t),m.mode&1&&Nm(a,c,t),t=m,l=c;var x=t.updateQueue;if(x===null){var g=new Set;g.add(l),t.updateQueue=g}else x.add(l);break e}else{if(!(t&1)){Nm(a,c,t),Ih();break e}l=Error(ce(426))}}else if(it&&o.mode&1){var v=Cm(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Am(v,i,o,a,t),mh(hi(l,o));break e}}a=l=hi(l,o),It!==4&&(It=2),ao===null?ao=[a]:ao.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var w=d1(a,l,t);_m(a,w);break e;case 1:o=l;var y=a.type,p=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(ys===null||!ys.has(p)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=m1(a,o,t);_m(a,_);break e}}a=a.return}while(a!==null)}P1(r)}catch(S){t=S,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(1)}function j1(){var e=Cc.current;return Cc.current=Nc,e===null?Nc:e}function Ih(){(It===0||It===3||It===2)&&(It=4),$t===null||!(ia&268435455)&&!(a0&268435455)||os($t,Gt)}function jc(e,t){var r=$e;$e|=2;var n=j1();($t!==e||Gt!==t)&&(Rn=null,Ys(e,t));do try{uk();break}catch(s){F1(e,s)}while(1);if(ph(),$e=r,Cc.current=n,Ct!==null)throw Error(ce(261));return $t=null,Gt=0,It}function uk(){for(;Ct!==null;)O1(Ct)}function fk(){for(;Ct!==null&&!D2();)O1(Ct)}function O1(e){var t=R1(e.alternate,e,Nr);e.memoizedProps=e.pendingProps,t===null?P1(e):Ct=t,Ah.current=null}function P1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=sk(r,t),r!==null){r.flags&=32767,Ct=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{It=6,Ct=null;return}}else if(r=nk(r,t,Nr),r!==null){Ct=r;return}if(t=t.sibling,t!==null){Ct=t;return}Ct=t=e}while(t!==null);It===0&&(It=5)}function Ws(e,t,r){var n=Qe,s=Qr.transition;try{Qr.transition=null,Qe=1,hk(e,t,r,n)}finally{Qr.transition=s,Qe=n}return null}function hk(e,t,r,n){do ri();while(hs!==null);if($e&6)throw Error(ce(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(G2(e,a),e===$t&&(Ct=$t=null,Gt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Pl||(Pl=!0,D1(hc,function(){return ri(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Qr.transition,Qr.transition=null;var i=Qe;Qe=1;var o=$e;$e|=4,Ah.current=null,ik(e,r),N1(r,e),O_(Xu),mc=!!Ku,Xu=Ku=null,e.current=r,ok(r),L2(),$e=o,Qe=i,Qr.transition=a}else e.current=r;if(Pl&&(Pl=!1,hs=e,Fc=s),a=e.pendingLanes,a===0&&(ys=null),U2(r.stateNode),Sr(e,_t()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ac)throw Ac=!1,e=gf,gf=null,e;return Fc&1&&e.tag!==0&&ri(),a=e.pendingLanes,a&1?e===pf?io++:(io=0,pf=e):io=0,Ps(),null}function ri(){if(hs!==null){var e=dx(Fc),t=Qr.transition,r=Qe;try{if(Qr.transition=null,Qe=16>e?16:e,hs===null)var n=!1;else{if(e=hs,hs=null,Fc=0,$e&6)throw Error(ce(331));var s=$e;for($e|=4,ye=e.current;ye!==null;){var a=ye,i=a.child;if(ye.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ye=c;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:so(8,u,a)}var h=u.child;if(h!==null)h.return=u,ye=h;else for(;ye!==null;){u=ye;var d=u.sibling,m=u.return;if(E1(u),u===c){ye=null;break}if(d!==null){d.return=m,ye=d;break}ye=m}}}var x=a.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}ye=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,ye=i;else e:for(;ye!==null;){if(a=ye,a.flags&2048)switch(a.tag){case 0:case 11:case 15:so(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,ye=w;break e}ye=a.return}}var y=e.current;for(ye=y;ye!==null;){i=ye;var p=i.child;if(i.subtreeFlags&2064&&p!==null)p.return=i,ye=p;else e:for(i=y;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:s0(9,o)}}catch(S){mt(o,o.return,S)}if(o===i){ye=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,ye=_;break e}ye=o.return}}if($e=s,Ps(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(Qc,e)}catch{}n=!0}return n}finally{Qe=r,Qr.transition=t}}return!1}function Hm(e,t,r){t=hi(r,t),t=d1(e,t,1),e=ws(e,t,1),t=ur(),e!==null&&(tl(e,1,t),Sr(e,t))}function mt(e,t,r){if(e.tag===3)Hm(e,e,r);else for(;t!==null;){if(t.tag===3){Hm(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ys===null||!ys.has(n))){e=hi(r,e),e=m1(t,e,1),t=ws(t,e,1),e=ur(),t!==null&&(tl(t,1,e),Sr(t,e));break}}t=t.return}}function dk(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ur(),e.pingedLanes|=e.suspendedLanes&r,$t===e&&(Gt&r)===r&&(It===4||It===3&&(Gt&130023424)===Gt&&500>_t()-jh?Ys(e,0):Fh|=r),Sr(e,t)}function I1(e,t){t===0&&(e.mode&1?(t=Sl,Sl<<=1,!(Sl&130023424)&&(Sl=4194304)):t=1);var r=ur();e=Kn(e,t),e!==null&&(tl(e,t,r),Sr(e,r))}function mk(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),I1(e,r)}function gk(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ce(314))}n!==null&&n.delete(t),I1(e,r)}var R1;R1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||_r.current)yr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return yr=!1,rk(e,t,r);yr=!!(e.flags&131072)}else yr=!1,it&&t.flags&1048576&&Bx(t,_c,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;nc(e,t),e=t.pendingProps;var s=li(t,sr.current);ti(t,r),s=Eh(null,t,n,e,s,r);var a=bh();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,kr(n)?(a=!0,wc(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,wh(t),s.updater=n0,t.stateNode=s,s._reactInternals=t,nf(t,n,e,r),t=of(null,t,n,!0,a,r)):(t.tag=0,it&&a&&hh(t),or(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(nc(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=xk(n),e=on(n,e),s){case 0:t=af(null,t,n,e,r);break e;case 1:t=Om(null,t,n,e,r);break e;case 11:t=Fm(null,t,n,e,r);break e;case 14:t=jm(null,t,n,on(n.type,e),r);break e}throw Error(ce(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:on(n,s),af(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:on(n,s),Om(e,t,n,s,r);case 3:e:{if(v1(t),e===null)throw Error(ce(387));n=t.pendingProps,a=t.memoizedState,s=a.element,Vx(e,t),Ec(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=hi(Error(ce(423)),t),t=Pm(e,t,n,r,s);break e}else if(n!==s){s=hi(Error(ce(424)),t),t=Pm(e,t,n,r,s);break e}else for(Pr=vs(t.stateNode.containerInfo.firstChild),Ir=t,it=!0,un=null,r=Wx(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ci(),n===s){t=Xn(e,t,r);break e}or(e,t,n,r)}t=t.child}return t;case 5:return Gx(t),e===null&&ef(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,qu(n,s)?i=null:a!==null&&qu(n,a)&&(t.flags|=32),x1(e,t),or(e,t,i,r),t.child;case 6:return e===null&&ef(t),null;case 13:return w1(e,t,r);case 4:return yh(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=ui(t,null,n,r):or(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:on(n,s),Fm(e,t,n,s,r);case 7:return or(e,t,t.pendingProps,r),t.child;case 8:return or(e,t,t.pendingProps.children,r),t.child;case 12:return or(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Ze(kc,n._currentValue),n._currentValue=i,a!==null)if(vn(a.value,i)){if(a.children===s.children&&!_r.current){t=Xn(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=$n(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),tf(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ce(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),tf(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}or(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,ti(t,r),s=Zr(s),n=n(s),t.flags|=1,or(e,t,n,r),t.child;case 14:return n=t.type,s=on(n,t.pendingProps),s=on(n.type,s),jm(e,t,n,s,r);case 15:return g1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:on(n,s),nc(e,t),t.tag=1,kr(n)?(e=!0,wc(t)):e=!1,ti(t,r),h1(t,n,s),nf(t,n,s,r),of(null,t,n,!0,e,r);case 19:return y1(e,t,r);case 22:return p1(e,t,r)}throw Error(ce(156,t.tag))};function D1(e,t){return cx(e,t)}function pk(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(e,t,r,n){return new pk(e,t,r,n)}function Rh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xk(e){if(typeof e=="function")return Rh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===eh)return 11;if(e===th)return 14}return 2}function ks(e,t){var r=e.alternate;return r===null?(r=qr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ic(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Rh(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ma:return Js(r.children,s,a,t);case Zf:i=8,s|=8;break;case Nu:return e=qr(12,r,t,s|2),e.elementType=Nu,e.lanes=a,e;case Cu:return e=qr(13,r,t,s),e.elementType=Cu,e.lanes=a,e;case Au:return e=qr(19,r,t,s),e.elementType=Au,e.lanes=a,e;case Gp:return i0(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case zp:i=10;break e;case Vp:i=9;break e;case eh:i=11;break e;case th:i=14;break e;case ss:i=16,n=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=qr(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Js(e,t,r,n){return e=qr(7,e,n,t),e.lanes=r,e}function i0(e,t,r,n){return e=qr(22,e,n,t),e.elementType=Gp,e.lanes=r,e.stateNode={isHidden:!1},e}function eu(e,t,r){return e=qr(6,e,null,t),e.lanes=r,e}function tu(e,t,r){return t=qr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vk(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=R0(0),this.expirationTimes=R0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=R0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Dh(e,t,r,n,s,a,i,o,l){return e=new vk(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=qr(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},wh(a),e}function wk(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:La,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function L1(e){if(!e)return Ts;e=e._reactInternals;e:{if(ga(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(kr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var r=e.type;if(kr(r))return Lx(e,r,t)}return t}function M1(e,t,r,n,s,a,i,o,l){return e=Dh(r,n,!0,e,s,a,i,o,l),e.context=L1(null),r=e.current,n=ur(),s=_s(r),a=$n(n,s),a.callback=t??null,ws(r,a,s),e.current.lanes=s,tl(e,s,n),Sr(e,n),e}function o0(e,t,r,n){var s=t.current,a=ur(),i=_s(s);return r=L1(r),t.context===null?t.context=r:t.pendingContext=r,t=$n(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ws(s,t,i),e!==null&&(mn(e,s,i,a),ec(e,s,i)),i}function Oc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Wm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Lh(e,t){Wm(e,t),(e=e.alternate)&&Wm(e,t)}function yk(){return null}var B1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Mh(e){this._internalRoot=e}l0.prototype.render=Mh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));o0(e,t,null,null)};l0.prototype.unmount=Mh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;oa(function(){o0(null,e,null,null)}),t[Gn]=null}};function l0(e){this._internalRoot=e}l0.prototype.unstable_scheduleHydration=function(e){if(e){var t=px();e={blockedOn:null,target:e,priority:t};for(var r=0;r<is.length&&t!==0&&t<is[r].priority;r++);is.splice(r,0,e),r===0&&vx(e)}};function Bh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function zm(){}function _k(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=Oc(i);a.call(c)}}var i=M1(t,n,e,0,null,!1,!1,"",zm);return e._reactRootContainer=i,e[Gn]=i.current,Ao(e.nodeType===8?e.parentNode:e),oa(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Oc(l);o.call(c)}}var l=Dh(e,0,!1,null,null,!1,!1,"",zm);return e._reactRootContainer=l,e[Gn]=l.current,Ao(e.nodeType===8?e.parentNode:e),oa(function(){o0(t,l,r,n)}),l}function u0(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Oc(i);o.call(l)}}o0(t,i,e,s)}else i=_k(r,t,e,s,n);return Oc(i)}mx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Vi(t.pendingLanes);r!==0&&(sh(t,r|1),Sr(t,_t()),!($e&6)&&(di=_t()+500,Ps()))}break;case 13:oa(function(){var n=Kn(e,1);if(n!==null){var s=ur();mn(n,e,1,s)}}),Lh(e,1)}};ah=function(e){if(e.tag===13){var t=Kn(e,134217728);if(t!==null){var r=ur();mn(t,e,134217728,r)}Lh(e,134217728)}};gx=function(e){if(e.tag===13){var t=_s(e),r=Kn(e,t);if(r!==null){var n=ur();mn(r,e,t,n)}Lh(e,t)}};px=function(){return Qe};xx=function(e,t){var r=Qe;try{return Qe=e,t()}finally{Qe=r}};Bu=function(e,t,r){switch(t){case"input":if(Ou(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=e0(n);if(!s)throw Error(ce(90));Xp(n),Ou(n,s)}}}break;case"textarea":Qp(e,r);break;case"select":t=r.value,t!=null&&Ya(e,!!r.multiple,t,!1)}};nx=Oh;sx=oa;var kk={usingClientEntryPoint:!1,Events:[nl,Ha,e0,tx,rx,Oh]},Mi={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sk={bundleType:Mi.bundleType,version:Mi.version,rendererPackageName:Mi.rendererPackageName,rendererConfig:Mi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=ox(e),e===null?null:e.stateNode},findFiberByHostInstance:Mi.findFiberByHostInstance||yk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Il.isDisabled&&Il.supportsFiber)try{Qc=Il.inject(Sk),An=Il}catch{}}Lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kk;Lr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bh(t))throw Error(ce(200));return wk(e,t,null,r)};Lr.createRoot=function(e,t){if(!Bh(e))throw Error(ce(299));var r=!1,n="",s=B1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Dh(e,1,!1,null,null,r,!1,n,s),e[Gn]=t.current,Ao(e.nodeType===8?e.parentNode:e),new Mh(t)};Lr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=ox(t),e=e===null?null:e.stateNode,e};Lr.flushSync=function(e){return oa(e)};Lr.hydrate=function(e,t,r){if(!c0(t))throw Error(ce(200));return u0(null,e,t,!0,r)};Lr.hydrateRoot=function(e,t,r){if(!Bh(e))throw Error(ce(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=B1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=M1(t,null,e,1,r??null,s,!1,a,i),e[Gn]=t.current,Ao(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new l0(t)};Lr.render=function(e,t,r){if(!c0(t))throw Error(ce(200));return u0(null,e,t,!1,r)};Lr.unmountComponentAtNode=function(e){if(!c0(e))throw Error(ce(40));return e._reactRootContainer?(oa(function(){u0(null,null,e,!1,function(){e._reactRootContainer=null,e[Gn]=null})}),!0):!1};Lr.unstable_batchedUpdates=Oh;Lr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!c0(r))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return u0(e,t,r,!1,n)};Lr.version="18.3.1-next-f1338f8080-20240426";function U1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(U1)}catch(e){console.error(e)}}U1(),Up.exports=Lr;var Ek=Up.exports,Vm=Ek;bu.createRoot=Vm.createRoot,bu.hydrateRoot=Vm.hydrateRoot;var bk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Tk=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nk=(e,t)=>{const r=K.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,children:o,...l},c)=>K.createElement("svg",{ref:c,...bk,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:`lucide lucide-${Tk(e)}`,...l},[...t.map(([u,h])=>K.createElement(u,h)),...(Array.isArray(o)?o:[o])||[]]));return r.displayName=`${e}`,r};var Ce=Nk;const oo=Ce("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),$1=Ce("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),wf=Ce("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),gn=Ce("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Uh=Ce("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Ki=Ce("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Ck=Ce("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Gm=Ce("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Km=Ce("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Ak=Ce("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),mi=Ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Xm=Ce("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Pa=Ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Mo=Ce("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Bo=Ce("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),qa=Ce("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),Fk=Ce("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),f0=Ce("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),qm=Ce("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),yf=Ce("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),jk=Ce("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),H1=Ce("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ok=Ce("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Pk=Ce("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),ru=Ce("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Ik=Ce("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Rk=Ce("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Qm=Ce("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Dk=Ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Lk=Ce("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Mk=Ce("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),W1=Ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ym=Ce("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),z1=Ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),V1=Ce("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),jn=Ce("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),h0=Ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),G1=Ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Fr=Ce("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),K1=Ce("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),al=Ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),_f=Ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Bk=Ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ss=Ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Uk="modulepreload",$k=function(e){return"/"+e},Jm={},il=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=$k(a),a in Jm)return;Jm[a]=!0;const i=a.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const h=s[u];if(h.href===a&&(!i||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${o}`))return;const c=document.createElement("link");if(c.rel=i?"stylesheet":Uk,i||(c.as="script",c.crossOrigin=""),c.href=a,document.head.appendChild(c),i)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})},Hk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>il(()=>Promise.resolve().then(()=>ki),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class $h extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Zm extends $h{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class eg extends $h{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class tg extends $h{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var kf;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(kf||(kf={}));var Wk=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class zk{constructor(t,{headers:r={},customFetch:n,region:s=kf.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Hk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Wk(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:i,signal:o}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let h;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=i):typeof i=="string"?(l["Content-Type"]="text/plain",h=i):typeof FormData<"u"&&i instanceof FormData?h=i:(l["Content-Type"]="application/json",h=JSON.stringify(i)));const d=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:h,signal:o}).catch(v=>{throw v.name==="AbortError"?v:new Zm(v)}),m=d.headers.get("x-relay-error");if(m&&m==="true")throw new eg(d);if(!d.ok)throw new tg(d);let x=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return x==="application/json"?g=yield d.json():x==="application/octet-stream"?g=yield d.blob():x==="text/event-stream"?g=d:x==="multipart/form-data"?g=yield d.formData():g=yield d.text(),{data:g,error:null,response:d}}catch(s){return s instanceof Error&&s.name==="AbortError"?{data:null,error:new Zm(s)}:{data:null,error:s,response:s instanceof tg||s instanceof eg?s.context:void 0}}})}}var wr={},Hh={},d0={},ol={},m0={},g0={},Vk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},gi=Vk();const Gk=gi.fetch,X1=gi.fetch.bind(gi),q1=gi.Headers,Kk=gi.Request,Xk=gi.Response,ki=Object.freeze(Object.defineProperty({__proto__:null,Headers:q1,Request:Kk,Response:Xk,default:X1,fetch:Gk},Symbol.toStringTag,{value:"Module"})),qk=Jy(ki);var p0={};Object.defineProperty(p0,"__esModule",{value:!0});let Qk=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};p0.default=Qk;var Q1=Jr&&Jr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(g0,"__esModule",{value:!0});const Yk=Q1(qk),Jk=Q1(p0);let Zk=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Yk.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var i,o,l,c;let u=null,h=null,d=null,m=a.status,x=a.statusText;if(a.ok){if(this.method!=="HEAD"){const y=await a.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=y:h=JSON.parse(y))}const v=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),w=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");v&&w&&w.length>1&&(d=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(u={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,d=null,m=406,x="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const v=await a.text();try{u=JSON.parse(v),Array.isArray(u)&&a.status===404&&(h=[],u=null,m=200,x="OK")}catch{a.status===404&&v===""?(m=204,x="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,m=200,x="OK"),u&&this.shouldThrowOnError)throw new Jk.default(u)}return{error:u,data:h,count:d,status:m,statusText:x}});return this.shouldThrowOnError||(s=s.catch(a=>{var i,o,l;return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(o=a==null?void 0:a.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=a==null?void 0:a.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};g0.default=Zk;var eS=Jr&&Jr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(m0,"__esModule",{value:!0});const tS=eS(g0);let rS=class extends tS.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};m0.default=rS;var nS=Jr&&Jr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ol,"__esModule",{value:!0});const sS=nS(m0);let aS=class extends sS.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};ol.default=aS;var iS=Jr&&Jr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d0,"__esModule",{value:!0});const Bi=iS(ol);let oS=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Bi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Bi.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Bi.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Bi.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Bi.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};d0.default=oS;var Y1=Jr&&Jr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Hh,"__esModule",{value:!0});const lS=Y1(d0),cS=Y1(ol);let uS=class J1{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new lS.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new J1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([h,d])=>d!==void 0).map(([h,d])=>[h,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([h,d])=>{l.searchParams.append(h,d)})):(o="POST",c=r);const u=new Headers(this.headers);return a&&u.set("Prefer",`count=${a}`),new cS.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Hh.default=uS;var Si=Jr&&Jr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wr,"__esModule",{value:!0});wr.PostgrestError=wr.PostgrestBuilder=wr.PostgrestTransformBuilder=wr.PostgrestFilterBuilder=wr.PostgrestQueryBuilder=wr.PostgrestClient=void 0;const Z1=Si(Hh);wr.PostgrestClient=Z1.default;const ev=Si(d0);wr.PostgrestQueryBuilder=ev.default;const tv=Si(ol);wr.PostgrestFilterBuilder=tv.default;const rv=Si(m0);wr.PostgrestTransformBuilder=rv.default;const nv=Si(g0);wr.PostgrestBuilder=nv.default;const sv=Si(p0);wr.PostgrestError=sv.default;var fS=wr.default={PostgrestClient:Z1.default,PostgrestQueryBuilder:ev.default,PostgrestFilterBuilder:tv.default,PostgrestTransformBuilder:rv.default,PostgrestBuilder:nv.default,PostgrestError:sv.default};const{PostgrestClient:hS,PostgrestQueryBuilder:KO,PostgrestFilterBuilder:XO,PostgrestTransformBuilder:qO,PostgrestBuilder:QO,PostgrestError:YO}=fS;class dS{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const mS="2.15.5",gS=`realtime-js/${mS}`,pS="1.0.0",Sf=1e4,xS=1e3,vS=100;var lo;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(lo||(lo={}));var jt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(jt||(jt={}));var cn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(cn||(cn={}));var Ef;(function(e){e.websocket="websocket"})(Ef||(Ef={}));var Vs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Vs||(Vs={}));class wS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+s));i=i+s;const l=n.decode(t.slice(i,i+a));i=i+a;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class av{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Je;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Je||(Je={}));const rg=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,i)=>(a[i]=yS(i,e,t,s),a),{})},yS=(e,t,r,n)=>{const s=t.find(o=>o.name===e),a=s==null?void 0:s.type,i=r[e];return a&&!n.includes(a)?iv(a,i):bf(i)},iv=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return ES(t,r)}switch(e){case Je.bool:return _S(t);case Je.float4:case Je.float8:case Je.int2:case Je.int4:case Je.int8:case Je.numeric:case Je.oid:return kS(t);case Je.json:case Je.jsonb:return SS(t);case Je.timestamp:return bS(t);case Je.abstime:case Je.date:case Je.daterange:case Je.int4range:case Je.int8range:case Je.money:case Je.reltime:case Je.text:case Je.time:case Je.timestamptz:case Je.timetz:case Je.tsrange:case Je.tstzrange:return bf(t);default:return bf(t)}},bf=e=>e,_S=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},kS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},SS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},ES=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>iv(t,o))}return e},bS=e=>typeof e=="string"?e.replace(" ","T"):e,ov=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class nu{constructor(t,r,n={},s=Sf){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var ng;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ng||(ng={}));class co{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=co.syncState(this.state,s,a,i),this.pendingDiffs.forEach(l=>{this.state=co.syncDiff(this.state,l,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=co.syncDiff(this.state,s,a,i),o())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(a,(c,u)=>{i[c]||(l[c]=u)}),this.map(i,(c,u)=>{const h=a[c];if(h){const d=u.map(v=>v.presence_ref),m=h.map(v=>v.presence_ref),x=u.filter(v=>m.indexOf(v.presence_ref)<0),g=h.filter(v=>d.indexOf(v.presence_ref)<0);x.length>0&&(o[c]=x),g.length>0&&(l[c]=g)}else o[c]=u}),this.syncDiff(a,{joins:o,leaves:l},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const h=t[o].map(m=>m.presence_ref),d=u.filter(m=>h.indexOf(m.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=c,s(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(sg||(sg={}));var uo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(uo||(uo={}));var Dn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Dn||(Dn={}));class Wh{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new nu(this,cn.join,this.params,this.timeout),this.rejoinTimer=new av(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(cn.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new co(this),this.broadcastEndpointURL=ov(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==jt.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[uo.PRESENCE]&&this.bindings[uo.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,h={},d={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(Dn.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Dn.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var x;if(this.socket.setAuth(),m===void 0){t==null||t(Dn.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(x=g==null?void 0:g.length)!==null&&x!==void 0?x:0,w=[];for(let y=0;y<v;y++){const p=g[y],{filter:{event:_,schema:S,table:E,filter:k}}=p,C=m&&m[y];if(C&&C.event===_&&C.schema===S&&C.table===E&&C.filter===k)w.push(Object.assign(Object.assign({},p),{id:C.id}));else{this.unsubscribe(),this.state=jt.errored,t==null||t(Dn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Dn.SUBSCRIBED);return}}).receive("error",m=>{this.state=jt.errored,t==null||t(Dn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Dn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===jt.joined&&t===uo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),c.receive("ok",()=>a("ok")),c.receive("error",()=>a("error")),c.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=jt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(cn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new nu(this,cn.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new nu(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>vS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=cn;if(n&&[o,l,c,u].indexOf(i)>=0&&n!==this._joinRef())return;let d=this._onMessage(i,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var x,g,v;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((v=(g=m.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===i}).map(m=>m.callback(d,n)):(a=this.bindings[i])===null||a===void 0||a.filter(m=>{var x,g,v,w,y,p;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const _=m.id,S=(x=m.filter)===null||x===void 0?void 0:x.event;return _&&((g=r.ids)===null||g===void 0?void 0:g.includes(_))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const _=(y=(w=m==null?void 0:m.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return _==="*"||_===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof d=="object"&&"ids"in d){const x=d.data,{schema:g,table:v,commit_timestamp:w,type:y,errors:p}=x;d=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:w,eventType:y,new:{},old:{},errors:p}),this._getPayloadRecords(x))}m.callback(d,n)})}_isClosed(){return this.state===jt.closed}_isJoined(){return this.state===jt.joined}_isJoining(){return this.state===jt.joining}_isLeaving(){return this.state===jt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Wh.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(cn.close,{},t)}_onError(t){this._on(cn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=rg(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=rg(t.columns,t.old_record)),r}}const su=()=>{},Rl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},TS=[1e3,2e3,5e3,1e4],NS=1e4,CS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class AS{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Sf,this.transport=null,this.heartbeatIntervalMs=Rl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=su,this.ref=0,this.reconnectTimer=null,this.logger=su,this.conn=null,this.sendBuffer=[],this.serializer=new wS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...i)=>il(()=>Promise.resolve().then(()=>ki),void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...i)=>a(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Ef.websocket}`,this.httpEndpoint=ov(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=dS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:pS}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case lo.connecting:return Vs.Connecting;case lo.open:return Vs.Open;case lo.closing:return Vs.Closing;default:return Vs.Closed}}isConnected(){return this.connectionState()===Vs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new Wh(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(xS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Rl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:i}=r,o=i?`(${i})`:"",l=a.status||"";this.log("receive",`${l} ${n} ${s} ${o}`.trim(),a),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(cn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([CS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:gS};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(cn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new av(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Rl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,i,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Sf,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Rl.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:su,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:h=>TS[h-1]||NS,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(h,d)=>d(JSON.stringify(h)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class zh extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Nt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class FS extends zh{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Tf extends zh{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var jS=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const lv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>il(()=>Promise.resolve().then(()=>ki),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},OS=()=>jS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield il(()=>Promise.resolve().then(()=>ki),void 0)).Response:Response}),Nf=e=>{if(Array.isArray(e))return e.map(r=>Nf(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Nf(n)}),t},PS=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var pa=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const au=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),IS=(e,t,r)=>pa(void 0,void 0,void 0,function*(){const n=yield OS();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,i=(s==null?void 0:s.statusCode)||a+"";t(new FS(au(s),a,i))}).catch(s=>{t(new Tf(au(s),s))}):t(new Tf(au(e),e))}),RS=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(PS(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function ll(e,t,r,n,s,a){return pa(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,RS(t,n,s,a)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>IS(l,o,n))})})}function Pc(e,t,r,n){return pa(this,void 0,void 0,function*(){return ll(e,"GET",t,r,n)})}function Tn(e,t,r,n,s){return pa(this,void 0,void 0,function*(){return ll(e,"POST",t,n,s,r)})}function Cf(e,t,r,n,s){return pa(this,void 0,void 0,function*(){return ll(e,"PUT",t,n,s,r)})}function DS(e,t,r,n){return pa(this,void 0,void 0,function*(){return ll(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function cv(e,t,r,n,s){return pa(this,void 0,void 0,function*(){return ll(e,"DELETE",t,n,s,r)})}var LS=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class MS{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return LS(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nt(t))return{data:null,error:t};throw t}})}}var BS=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class US{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new MS(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return BS(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nt(t))return{data:null,error:t};throw t}})}}var pr=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const $S={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ag={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class HS{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=lv(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return pr(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},ag),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",i.cacheControl),l&&a.append("metadata",this.encodeMetadata(l))):(a=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield(t=="PUT"?Cf:Tn)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Nt(a))return{data:null,error:a};throw a}})}upload(t,r,n){return pr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return pr(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:ag.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield Cf(this.fetch,o.toString(),l,{headers:u});return{data:{path:a,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Nt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return pr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield Tn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new zh("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}update(t,r,n){return pr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return pr(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return pr(this,void 0,void 0,function*(){try{return{data:{path:(yield Tn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return pr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Tn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return pr(this,void 0,void 0,function*(){try{const s=yield Tn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",o=this._getFinalPath(t),l=()=>Pc(this.fetch,`${this.url}/${s}/${o}${i}`,{headers:this.headers,noResolveJson:!0});return new US(l,this.shouldThrowOnError)}info(t){return pr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Pc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Nf(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}exists(t){return pr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield DS(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n)&&n instanceof Tf){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return pr(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}list(t,r,n){return pr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},$S),r),{prefix:t||""});return{data:yield Tn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}listV2(t,r){return pr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Tn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const WS="2.12.2",zS={"X-Client-Info":`storage-js/${WS}`};var ba=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class VS{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const a=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},zS),r),this.fetch=lv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ba(this,void 0,void 0,function*(){try{return{data:yield Pc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Nt(t))return{data:null,error:t};throw t}})}getBucket(t){return ba(this,void 0,void 0,function*(){try{return{data:yield Pc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ba(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ba(this,void 0,void 0,function*(){try{return{data:yield Cf(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ba(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ba(this,void 0,void 0,function*(){try{return{data:yield cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}}class GS extends VS{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new HS(this.url,this.headers,t,this.fetch)}}const KS="2.58.0";let Xi="";typeof Deno<"u"?Xi="deno":typeof document<"u"?Xi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xi="react-native":Xi="node";const XS={"X-Client-Info":`supabase-js-${Xi}/${KS}`},qS={headers:XS},QS={schema:"public"},YS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},JS={};var ZS=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const e4=e=>{let t;return e?t=e:typeof fetch>"u"?t=X1:t=fetch,(...r)=>t(...r)},t4=()=>typeof Headers>"u"?q1:Headers,r4=(e,t,r)=>{const n=e4(r),s=t4();return(a,i)=>ZS(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new s(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(a,Object.assign(Object.assign({},i),{headers:c}))})};var n4=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function s4(e){return e.endsWith("/")?e:e+"/"}function a4(e,t){var r,n;const{db:s,auth:a,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),a),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>n4(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function i4(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(s4(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const uv="2.72.0",Ia=30*1e3,Af=3,iu=Af*Ia,o4="http://localhost:9999",l4="supabase.auth.token",c4={"X-Client-Info":`gotrue-js/${uv}`},Ff="X-Supabase-Api-Version",fv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},u4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,f4=10*60*1e3;class Vh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Fe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class h4 extends Vh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function d4(e){return Fe(e)&&e.name==="AuthApiError"}class hv extends Vh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Is extends Vh{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class ns extends Is{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function m4(e){return Fe(e)&&e.name==="AuthSessionMissingError"}class Ui extends Is{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Dl extends Is{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ll extends Is{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function g4(e){return Fe(e)&&e.name==="AuthImplicitGrantRedirectError"}class ig extends Is{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class jf extends Is{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ou(e){return Fe(e)&&e.name==="AuthRetryableFetchError"}class og extends Is{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Of extends Is{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ic="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),lg=` 	
\r=`.split(""),p4=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<lg.length;t+=1)e[lg[t].charCodeAt(0)]=-2;for(let t=0;t<Ic.length;t+=1)e[Ic[t].charCodeAt(0)]=t;return e})();function cg(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ic[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ic[n]),t.queuedBits-=6}}function dv(e,t,r){const n=p4[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ug(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{w4(i,n,r)};for(let i=0;i<e.length;i+=1)dv(e.charCodeAt(i),s,a);return t.join("")}function x4(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function v4(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}x4(n,t)}}function w4(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function y4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)dv(e.charCodeAt(s),r,n);return new Uint8Array(t)}function _4(e){const t=[];return v4(e,r=>t.push(r)),new Uint8Array(t)}function k4(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>cg(s,r,n)),cg(null,r,n),t.join("")}function S4(e){return Math.round(Date.now()/1e3)+e}function E4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const $r=()=>typeof window<"u"&&typeof document<"u",Us={tested:!1,writable:!1},mv=()=>{if(!$r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Us.tested)return Us.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Us.tested=!0,Us.writable=!0}catch{Us.tested=!0,Us.writable=!1}return Us.writable};function b4(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const gv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>il(()=>Promise.resolve().then(()=>ki),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},T4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ra=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},$s=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ts=async(e,t)=>{await e.removeItem(t)};class x0{constructor(){this.promise=new x0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}x0.promiseConstructor=Promise;function lu(e){const t=e.split(".");if(t.length!==3)throw new Of("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!u4.test(t[n]))throw new Of("JWT not in base64url format");return{header:JSON.parse(ug(t[0])),payload:JSON.parse(ug(t[1])),signature:y4(t[2]),raw:{header:t[0],payload:t[1]}}}async function N4(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function C4(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){n(i);return}}catch(i){if(!t(a,i)){s(i);return}}})()})}function A4(e){return("0"+e.toString(16)).substr(-2)}function F4(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,A4).join("")}async function j4(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function O4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await j4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ta(e,t,r=!1){const n=F4();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Ra(e,`${t}-code-verifier`,s);const a=await O4(n);return[a,n===a?"plain":"s256"]}const P4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function I4(e){const t=e.headers.get(Ff);if(!t||!t.match(P4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function R4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function D4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const L4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Na(e){if(!L4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function fg(e){return JSON.parse(JSON.stringify(e))}var M4=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const zs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),B4=[502,503,504];async function hg(e){var t;if(!T4(e))throw new jf(zs(e),0);if(B4.includes(e.status))throw new jf(zs(e),e.status);let r;try{r=await e.json()}catch(a){throw new hv(zs(a),a)}let n;const s=I4(e);if(s&&s.getTime()>=fv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new og(zs(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ns}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new og(zs(r),e.status,r.weak_password.reasons);throw new h4(zs(r),e.status||500,n)}const U4=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Me(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Ff]||(a[Ff]=fv["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const i=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await $4(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function $4(e,t,r,n,s,a){const i=U4(t,n,s,a);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new jf(zs(l),0)}if(o.ok||await hg(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await hg(l)}}function kn(e){var t;let r=null;V4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=S4(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function dg(e){const t=kn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ls(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function H4(e){return{data:e,error:null}}function W4(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,i=M4(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function z4(e){return e}function V4(e){return e.access_token&&e.refresh_token&&e.expires_in}const uu=["global","local","others"];var G4=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class K4{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=gv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=uu[0]){if(uu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${uu.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ls})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=G4(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:W4,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Fe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ls})}catch(r){if(Fe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:z4});if(u.error)throw u.error;const h=await u.json(),d=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(x.split(";")[1].split("=")[1]);c[`${v}Page`]=g}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Fe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Na(t);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ls})}catch(r){if(Fe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Na(t);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ls})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Na(t);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ls})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Na(t.userId);try{const{data:r,error:n}=await Me(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Na(t.userId),Na(t.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}}function mg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function X4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ca={debug:!!(globalThis&&mv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class pv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class q4 extends pv{}async function Q4(e,t,r){Ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ca.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Ca.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new q4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ca.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function xv(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Y4(e){return parseInt(e,16)}function J4(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Z4(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:u,uri:h,version:d}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=xv(e.address),x=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",v=`${x} wants you to sign in with your Ethereum account:
${m}

${g}`;let w=`URI: ${h}
Version: ${d}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(s&&(w+=`
Expiration Time: ${s.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let y=`
Resources:`;for(const p of c){if(!p||typeof p!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${p}`);y+=`
- ${p}`}w+=y}return`${v}
${w}`}X4();const eE={url:o4,storageKey:l4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:c4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function gg(e,t,r){return await r()}const Aa={};class Uo{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Uo.nextInstanceID,Uo.nextInstanceID+=1,this.instanceID>0&&$r()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},eE),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new K4({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=gv(s.fetch),this.lock=s.lock||gg,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:$r()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Q4:this.lock=gg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:mv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=mg(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=mg(this.memoryStorage)),$r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Aa[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Aa[this.storageKey]=Object.assign(Object.assign({},Aa[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Aa[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Aa[this.storageKey]=Object.assign(Object.assign({},Aa[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${uv}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=b4(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),$r()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),g4(a)){const l=(t=a.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Fe(r)?{error:r}:{error:new hv("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:kn}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Fe(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:u,password:h,options:d}=t;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Ta(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:m,code_challenge_method:x},xform:kn})}else if("phone"in t){const{phone:u,password:h,options:d}=t;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:kn})}else throw new Dl("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Fe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:o}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:dg})}else if("phone"in t){const{phone:a,password:i,options:o}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:dg})}else throw new Dl("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ui}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,a,i,o,l,c,u,h,d;let m,x;if("message"in t)m=t.message,x=t.signature;else{const{chain:g,wallet:v,statement:w,options:y}=t;let p;if($r())if(typeof v=="object")p=v;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")p=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");p=v}const _=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),S=await p.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=xv(S[0]);let k=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const T=await p.request({method:"eth_chainId"});k=Y4(T)}const C={domain:_.host,address:E,statement:w,uri:_.href,version:"1",chainId:k,nonce:(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=Z4(C),x=await p.request({method:"personal_sign",params:[J4(m),E]})}try{const{data:g,error:v}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:x},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:kn});if(v)throw v;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Ui}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:v})}catch(g){if(Fe(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(t){var r,n,s,a,i,o,l,c,u,h,d,m;let x,g;if("message"in t)x=t.message,g=t.signature;else{const{chain:v,wallet:w,statement:y,options:p}=t;let _;if($r())if(typeof w=="object")_=w;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))_=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=w}const S=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const E=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),y?{statement:y}:null));let k;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")k=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)k=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),g=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${S.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(s=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=p==null?void 0:p.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((h=(u=p==null?void 0:p.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...p.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const E=await _.signMessage(new TextEncoder().encode(x),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=E}}try{const{data:v,error:w}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:k4(g)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:kn});if(w)throw w;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new Ui}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:w})}catch(v){if(Fe(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await $s(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:i}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:kn});if(await ts(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ui}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if(Fe(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:i}=t,o=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:kn}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ui}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ta(this.storage,this.storageKey));const{error:h}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Dl("You must provide either an email or phone number.")}catch(o){if(Fe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:kn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Fe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await Ta(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:H4})}catch(a){if(Fe(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ns;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Fe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:i}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:i,error:o}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Dl("You must provide either an email or phone number and a type")}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await $s(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<iu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await $s(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=cu()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ls}):await this._useSession(async r=>{var n,s,a;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ns}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:ls})})}catch(r){if(Fe(r))return m4(r)&&(await this._removeSession(),await ts(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new ns;const i=s.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Ta(this.storage,this.storageKey));const{data:c,error:u}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:ls});if(u)throw u;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Fe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ns;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:i}=lu(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(Fe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ns;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Fe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!$r())throw new Ll("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ll(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ig("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ll("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ig("No code detected.");const{data:y,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!a||!o||!i||!c)throw new Ll("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let d=u+h;l&&(d=parseInt(l));const m=d-u;m*1e3<=Ia&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const x=d-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,d,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,d,u);const{data:g,error:v}=await this._getUser(a);if(v)throw v;const w={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:h,expires_at:d,refresh_token:i,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(n){if(Fe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await $s(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(d4(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await ts(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=E4(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Ta(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Fe(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var i,o,l,c,u;const{data:h,error:d}=a;if(d)throw d;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return $r()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Fe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)throw i;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await C4(async s=>(s>0&&await N4(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:kn})),(s,a)=>{const i=200*Math.pow(2,s);return a&&ou(a)&&Date.now()+i-n<Ia})}catch(n){if(this._debug(r,"error",n),Fe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),$r()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await $s(this.storage,this.storageKey);if(s&&this.userStorage){let i=await $s(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await Ra(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:cu()}else if(s&&!s.user&&!s.user){const i=await $s(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await ts(this.storage,this.storageKey+"-user"),await Ra(this.storage,this.storageKey,s)):s.user=cu()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<iu;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${iu}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),ou(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(s.access_token);!o&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ns;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new x0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new ns;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(s,"error",a),Fe(a)){const i={session:null,error:a};return ou(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){a.push(l)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ra(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=fg(s);await Ra(this.storage,this.storageKey,a)}else{const s=fg(r);await Ra(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ts(this.storage,this.storageKey),await ts(this.storage,this.storageKey+"-code-verifier"),await ts(this.storage,this.storageKey+"-user"),this.userStorage&&await ts(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&$r()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ia);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Ia);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ia}ms, refresh threshold is ${Af} ticks`),s<=Af&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof pv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!$r()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,i]=await Ta(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Me(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:i,error:o}=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=lu(s.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+f4>s)return n;const{data:a,error:i}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};n=m.session.access_token}const{header:s,payload:a,signature:i,raw:{header:o,payload:l}}=lu(n);r!=null&&r.allowExpired||R4(a.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:a,header:s,signature:i},error:null}}const u=D4(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,_4(`${o}.${l}`)))throw new Of("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(n){if(Fe(n))return{data:null,error:n};throw n}}}Uo.nextInstanceID=0;const tE=Uo;class rE extends tE{constructor(t){super(t)}}var nE=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(u){try{c(n.next(u))}catch(h){i(h)}}function l(u){try{c(n.throw(u))}catch(h){i(h)}}function c(u){u.done?a(u.value):s(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class sE{constructor(t,r,n){var s,a,i;this.supabaseUrl=t,this.supabaseKey=r;const o=i4(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:QS,realtime:JS,auth:Object.assign(Object.assign({},YS),{storageKey:l}),global:qS},u=a4(n??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=r4(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new hS(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new GS(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new zk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return nE(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:i,flowType:o,lock:l,debug:c},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rE({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,flowType:o,lock:l,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new AS(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const aE=(e,t,r)=>new sE(e,t,r);function iE(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}iE()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const fo="https://ckyjdjybhkuthbbuwkcz.supabase.co",Rc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNreWpkanliaGt1dGhiYnV3a2N6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAxNjY0MzUsImV4cCI6MjA3NTc0MjQzNX0.ACbP1DYkKd4_skO7ASpHMe3zq3Z8OYx0JjIFW5CrgYY",cs=()=>{const e=fo.startsWith("http")&&fo.includes(".supabase.co")&&Rc.startsWith("eyJ");return console.log("🔍 Kiểm tra cấu hình Supabase:",{supabaseUrl:`${fo.substring(0,20)}...`,supabaseAnonKey:`${Rc.substring(0,20)}...`,isConfigured:e}),e},he=cs()&&fo&&Rc?aE(fo,Rc,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1,storageKey:"sb-quiz-auth-token",flowType:"pkce"}}):null;function xa(){var i;const[e,t]=K.useState({user:null,loading:!0,error:null});K.useEffect(()=>{r()},[]);const r=async()=>{try{if(console.log("🔄 Checking auth..."),!he){t({user:null,loading:!1,error:null});return}const{data:{session:o}}=await he.auth.getSession();if(o!=null&&o.user){console.log("✅ Session found:",o.user.email);const{data:l,error:c}=await he.from("user_profiles").select("*").eq("id",o.user.id).maybeSingle();c&&console.error("Profile fetch error:",c);const u=l?{id:l.id,email:l.email,role:l.role,full_name:l.full_name,created_at:l.created_at}:{id:o.user.id,email:o.user.email||"",role:"user",full_name:o.user.email||"",created_at:new Date().toISOString()};console.log("✅ User loaded:",u),t({user:u,loading:!1,error:null})}else console.log("ℹ️ No session"),t({user:null,loading:!1,error:null})}catch(o){console.error("❌ Auth error:",o),t({user:null,loading:!1,error:null})}},n=async(o,l)=>{try{if(console.log("🔄 Logging in:",o),t(x=>({...x,loading:!0,error:null})),!he)throw new Error("Supabase not configured");const{data:c,error:u}=await he.auth.signInWithPassword({email:o,password:l});if(u)throw new Error(u.message);if(!c.user)throw new Error("No user returned");console.log("🔍 Fetching profile for user ID:",c.user.id);const{data:h,error:d}=await he.from("user_profiles").select("*").eq("id",c.user.id).maybeSingle();if(console.log("🔍 Profile query result:",{profile:h,profileError:d}),h&&h.status==="pending")throw await he.auth.signOut(),new Error("Tài khoản của bạn chưa được duyệt. Vui lòng chờ quản trị viên phê duyệt.");if(h&&h.status==="inactive")throw await he.auth.signOut(),new Error("Tài khoản của bạn đã bị vô hiệu hóa. Vui lòng liên hệ quản trị viên.");const m=h?{id:h.id,email:h.email,role:h.role,full_name:h.full_name,created_at:h.created_at}:{id:c.user.id,email:c.user.email||"",role:"user",full_name:c.user.email||"",created_at:new Date().toISOString()};return console.log("✅ Login success:"),console.log("   - User ID:",m.id),console.log("   - Email:",m.email),console.log("   - Role:",m.role),console.log("   - Full Name:",m.full_name),console.log("   - RAW profile from DB:",h),t({user:m,loading:!1,error:null}),m}catch(c){console.error("❌ Login error:",c);const u=c.message||"Login failed";throw t(h=>({...h,loading:!1,error:u})),c}},s=async(o,l,c)=>{try{if(console.log("🔄 Registering:",o),t(d=>({...d,loading:!0,error:null})),!he)throw new Error("Supabase not configured");const{data:u,error:h}=await he.auth.signUp({email:o,password:l,options:{data:{full_name:c}}});if(h)throw new Error(h.message);if(!u.user)throw new Error("No user returned");return await he.auth.signOut(),console.log("✅ Register success - account pending approval"),t({user:null,loading:!1,error:null}),null}catch(u){console.error("❌ Register error:",u);const h=u.message||"Registration failed";throw t(d=>({...d,loading:!1,error:h})),u}},a=async()=>{try{console.log("🔄 Logging out..."),he&&await he.auth.signOut(),t({user:null,loading:!1,error:null}),console.log("✅ Logout success")}catch(o){console.error("❌ Logout error:",o),t({user:null,loading:!1,error:null})}};return{user:e.user,loading:e.loading,error:e.error,isAuthenticated:!!e.user,isAdmin:((i=e.user)==null?void 0:i.role)==="admin",isSupabaseConfigured:!!he,login:n,register:s,logout:a}}const oE=({onSwitchToRegister:e,onClose:t})=>{const[r,n]=K.useState(""),[s,a]=K.useState(""),[i,o]=K.useState(!1),[l,c]=K.useState(!0),[u,h]=K.useState(!1),[d,m]=K.useState(""),{login:x}=xa();K.useEffect(()=>{const v=localStorage.getItem("quiz_app_email"),w=localStorage.getItem("quiz_app_password");v&&n(v),w&&a(w)},[]);const g=async v=>{if(v.preventDefault(),!r||!s){m("Vui lòng nhập đầy đủ email và mật khẩu");return}h(!0),m("");try{console.log("🔄 Form đăng nhập - bắt đầu với email:",r),await x(r,s),l?(localStorage.setItem("quiz_app_email",r),localStorage.setItem("quiz_app_password",s)):(localStorage.removeItem("quiz_app_email"),localStorage.removeItem("quiz_app_password")),console.log("✅ Đăng nhập thành công, đóng modal"),t()}catch(w){console.error("❌ Lỗi trong form đăng nhập:",w);let y="Lỗi đăng nhập";w instanceof Error&&(w.message.includes("timeout")||w.message.includes("Login timeout")?y="⏱️ Kết nối chậm, thử lại sau":w.message.includes("Invalid login credentials")?y="❌ Email hoặc mật khẩu sai":w.message.includes("network")||w.message.includes("fetch")?y="🌐 Lỗi mạng, kiểm tra kết nối":w.message.includes("Database error")?y="🔧 Lỗi database, thử xóa cache trình duyệt (Ctrl+Shift+Del)":y=w.message),m(y)}finally{h(!1)}};return f.jsxs("div",{className:"w-full max-w-md mx-auto",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(jk,{className:"w-8 h-8 text-[#A50034]"})}),f.jsx("h2",{className:"text-2xl font-bold text-[#A50034]",children:"Đăng nhập"}),f.jsx("p",{className:"text-gray-700 mt-2 text-base font-semibold",children:"Đăng nhập để truy cập hệ thống"})]}),d&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),f.jsxs("div",{className:"relative",children:[f.jsx(al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("input",{type:"email",value:r,onChange:v=>n(v.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập email của bạn"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu"}),f.jsxs("div",{className:"relative",children:[f.jsx(yf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("input",{type:i?"text":"password",value:s,onChange:v=>a(v.target.value),required:!0,className:"w-full pl-10 pr-12 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập mật khẩu"}),f.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?f.jsx(Mo,{className:"w-5 h-5"}):f.jsx(Bo,{className:"w-5 h-5"})})]})]}),f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx("input",{type:"checkbox",id:"rememberPassword",checked:l,onChange:v=>c(v.target.checked),className:"w-4 h-4 text-agribank-primary bg-gray-100 border-gray-300 rounded focus:ring-agribank-primary focus:ring-2 accent-agribank-primary"}),f.jsx("label",{htmlFor:"rememberPassword",className:"ml-2 text-sm text-gray-700",children:"Ghi nhớ mật khẩu"})]}),f.jsx("button",{type:"submit",disabled:u,className:"w-full bg-[#A50034] text-white py-3 px-4 rounded-md hover:bg-[#8B002D] disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:u?"Đang đăng nhập...":"Đăng nhập"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsxs("p",{className:"text-gray-600",children:["Chưa có tài khoản?"," ",f.jsx("button",{onClick:e,className:"text-[#A50034] hover:text-[#8B002D] font-medium",children:"Đăng ký ngay"})]})}),f.jsxs("div",{className:"mt-6 text-center",children:[f.jsx("p",{className:"text-[#A50034] text-xs font-semibold mb-1 whitespace-nowrap",children:"© 2025 Agribank CN Cư M'gar Bắc Đắk Lắk"}),f.jsx("p",{className:"text-[#A50034] text-xs",children:"Địa chỉ: 124 Hùng vương, X. Quảng Phú, T. Đắk Lắk"}),f.jsx("p",{className:"text-[#A50034] text-xs",children:"📞 Hotline: 0972 116 275 | ✉️ Email: congsu@gmail.com"})]})]})},lE=({title:e,message:t,isOpen:r,onClose:n})=>{const[s,a]=K.useState(!1),[i,o]=K.useState(!1);if(K.useEffect(()=>{r?(a(!0),setTimeout(()=>o(!0),10)):(o(!1),setTimeout(()=>a(!1),300))},[r]),!s)return null;const l=()=>{o(!1),setTimeout(()=>{a(!1),n()},300)};return f.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center p-4 transition-all duration-300 ${i?"bg-black bg-opacity-50":"bg-black bg-opacity-0"}`,onClick:l,children:f.jsx("div",{className:`bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all duration-300 ${i?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:c=>c.stopPropagation(),children:f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:f.jsx(Uh,{className:"w-10 h-10 text-green-600"})}),f.jsx("h3",{className:"text-xl font-bold text-[#9C1C1C] mb-3",children:e}),f.jsx("p",{className:"text-gray-700 text-base leading-relaxed mb-6",children:t}),f.jsx("button",{onClick:l,className:"w-full bg-[#9C1C1C] text-white py-3 px-6 rounded-lg font-semibold text-base hover:bg-[#7A1616] active:bg-[#5A1010] transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] shadow-lg",children:"OK"})]})})})})};let oc=null;const cE=(e,t)=>new Promise(r=>{oc=r;const n=new CustomEvent("showCustomAlert",{detail:{title:e,message:t}});window.dispatchEvent(n)}),uE=()=>{oc&&(oc(),oc=null)},fE=({onSwitchToLogin:e,onClose:t})=>{const[r,n]=K.useState({email:"",password:"",confirmPassword:"",fullName:"",role:"user"}),[s,a]=K.useState(!1),[i,o]=K.useState(!1),[l,c]=K.useState(!1),[u,h]=K.useState(""),{register:d}=xa(),m=async g=>{if(g.preventDefault(),c(!0),h(""),r.password!==r.confirmPassword){h("Mật khẩu xác nhận không khớp"),c(!1);return}if(r.password.length<6){h("Mật khẩu phải có ít nhất 6 ký tự"),c(!1);return}try{await d(r.email,r.password,r.fullName),await cE("Đăng ký thành công","Tài khoản của bạn đã được gửi để phê duyệt. Vui lòng chờ quản trị viên xác nhận."),e()}catch(v){if(v&&typeof v=="object"&&"code"in v)switch(v.code){case"email_provider_disabled":h("Đăng ký bằng email đã bị vô hiệu hóa. Vui lòng liên hệ quản trị viên để kích hoạt tính năng này trong Supabase Dashboard.");break;case"signup_disabled":h("Đăng ký tài khoản mới đã bị vô hiệu hóa. Vui lòng liên hệ quản trị viên.");break;case"email_address_invalid":h("Địa chỉ email không hợp lệ.");break;case"password_too_short":h("Mật khẩu quá ngắn. Vui lòng nhập ít nhất 6 ký tự.");break;case"user_already_exists":h("Email này đã được sử dụng để đăng ký. Vui lòng sử dụng email khác hoặc đăng nhập.");break;default:h(v instanceof Error?v.message:"Lỗi đăng ký")}else h(v instanceof Error?v.message:"Lỗi đăng ký")}finally{c(!1)}},x=(g,v)=>{n(w=>({...w,[g]:v}))};return f.jsxs("div",{className:"w-full max-w-md mx-auto",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-4",children:f.jsx(K1,{className:"w-8 h-8 text-[#A50034]"})}),f.jsx("h2",{className:"text-2xl font-bold text-[#A50034]",children:"Đăng ký"}),f.jsx("p",{className:"text-gray-700 mt-2 text-base font-semibold",children:"Tạo tài khoản mới"})]}),u&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:u}),f.jsxs("form",{onSubmit:m,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Họ và tên"}),f.jsxs("div",{className:"relative",children:[f.jsx(al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("input",{type:"text",value:r.fullName,onChange:g=>x("fullName",g.target.value),className:"w-full pl-10 pr-4 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập họ và tên"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),f.jsxs("div",{className:"relative",children:[f.jsx(Ok,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("input",{type:"email",value:r.email,onChange:g=>x("email",g.target.value),required:!0,className:"w-full pl-10 pr-4 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập email của bạn"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại tài khoản (chỉ có thể đăng ký User)"}),f.jsxs("div",{className:"relative",children:[f.jsx(V1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("select",{value:r.role,onChange:g=>x("role",g.target.value),disabled:!0,className:"w-full pl-10 pr-4 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",children:f.jsx("option",{value:"user",children:"Người dùng (Ôn thi & Thi thử)"})})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"💡 Chỉ có thể đăng ký tài khoản Người dùng. Để có tài khoản Quản trị viên, vui lòng liên hệ admin."})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu"}),f.jsxs("div",{className:"relative",children:[f.jsx(yf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("input",{type:s?"text":"password",value:r.password,onChange:g=>x("password",g.target.value),required:!0,className:"w-full pl-10 pr-12 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập mật khẩu (ít nhất 6 ký tự)"}),f.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?f.jsx(Mo,{className:"w-5 h-5"}):f.jsx(Bo,{className:"w-5 h-5"})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Xác nhận mật khẩu"}),f.jsxs("div",{className:"relative",children:[f.jsx(yf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-[#A50034]"}),f.jsx("input",{type:i?"text":"password",value:r.confirmPassword,onChange:g=>x("confirmPassword",g.target.value),required:!0,className:"w-full pl-10 pr-12 py-3 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập lại mật khẩu"}),f.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?f.jsx(Mo,{className:"w-5 h-5"}):f.jsx(Bo,{className:"w-5 h-5"})})]})]}),f.jsx("button",{type:"submit",disabled:l,className:"w-full bg-[#A50034] text-white py-3 px-4 rounded-md hover:bg-[#8B002D] disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:l?"Đang đăng ký...":"Đăng ký"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsxs("p",{className:"text-gray-600",children:["Đã có tài khoản?"," ",f.jsx("button",{onClick:e,className:"text-[#A50034] hover:text-[#8B002D] font-medium",children:"Đăng nhập ngay"})]})}),f.jsxs("div",{className:"mt-6 text-center",children:[f.jsx("p",{className:"text-[#A50034] text-xs font-semibold mb-1 whitespace-nowrap",children:"© 2025 Agribank CN Cư M'gar Bắc Đắk Lắk"}),f.jsx("p",{className:"text-[#A50034] text-xs",children:"Địa chỉ: 124 Hùng vương, X. Quảng Phú, T. Đắk Lắk"}),f.jsx("p",{className:"text-[#A50034] text-xs",children:"📞 Hotline: 0972 116 275 | ✉️ Email: congsu@gmail.com"})]})]})},hE=({isOpen:e,onClose:t,initialMode:r="login"})=>{const[n,s]=K.useState(r);return console.log("🔄 AuthModal render:",{isOpen:e,mode:n}),e?(console.log("✅ AuthModal: Hiển thị modal"),f.jsx("div",{className:"fixed inset-0 bg-pink-50 bg-opacity-95 flex items-center justify-center z-50 p-4",onClick:a=>{a.target===a.currentTarget&&t()},children:f.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[f.jsxs("div",{className:"flex justify-between items-center px-4 py-2 bg-agribank-primary border-b border-gray-200",children:[f.jsx("div",{className:"flex items-center",children:f.jsx("img",{src:"/logo-agribank-300x295.png",alt:"Agribank Logo",className:"w-12 h-12 md:w-14 md:h-14 object-contain"})}),f.jsx("button",{onClick:()=>{console.log("🔄 Đóng modal từ nút X"),t()},className:"p-1.5 hover:bg-red-800 rounded-full transition-colors text-white",children:f.jsx(Ss,{className:"w-5 h-5"})})]}),f.jsx("div",{className:"p-6",children:n==="login"?f.jsx(oE,{onSwitchToRegister:()=>s("register"),onClose:()=>{console.log("🔄 Đóng modal từ LoginForm"),t()}}):f.jsx(fE,{onSwitchToLogin:()=>s("login"),onClose:()=>{console.log("🔄 Đóng modal từ RegisterForm"),t()}})})]})})):(console.log("❌ AuthModal: isOpen = false, không hiển thị modal"),null)};class dE{constructor(){A0(this,"heartbeatInterval",null);A0(this,"currentSessionId",null)}async checkExistingSession(t,r){if(!he)return!1;try{const{data:n,error:s}=await he.from("active_sessions").select("*").eq("user_id",t).eq("is_active",!0).neq("session_id",r);return s?(console.error("Lỗi kiểm tra session:",s),!1):!!(n&&n.length>0)}catch(n){return console.error("Lỗi:",n),!1}}async createSession(t,r){if(!he)return!1;try{const n=this.getDeviceInfo(),s=await this.getIPAddress();console.log("🔄 Tạo session mới, vô hiệu hóa các session cũ..."),await he.from("active_sessions").update({is_active:!1}).eq("user_id",t).eq("is_active",!0).neq("session_id",r);const{error:a}=await he.from("active_sessions").upsert([{user_id:t,session_id:r,device_info:n,ip_address:s,is_active:!0,last_activity:new Date().toISOString()}],{onConflict:"session_id",ignoreDuplicates:!1});return a?(console.error("Lỗi tạo session:",a),!1):(console.log("✅ Session được tạo thành công"),this.currentSessionId=r,this.startHeartbeat(t,r),!0)}catch(n){return console.error("Lỗi:",n),!1}}async endSession(t,r){if(he)try{await he.from("active_sessions").update({is_active:!1}).eq("user_id",t).eq("session_id",r),this.stopHeartbeat(),this.currentSessionId=null}catch(n){console.error("Lỗi kết thúc session:",n)}}startHeartbeat(t,r){this.stopHeartbeat(),this.heartbeatInterval=setInterval(async()=>{if(he)try{const{data:n}=await he.from("active_sessions").select("is_active").eq("user_id",t).eq("session_id",r).maybeSingle();if(!n||!n.is_active){window.dispatchEvent(new CustomEvent("sessionTerminated")),this.stopHeartbeat();return}await he.from("active_sessions").update({last_activity:new Date().toISOString()}).eq("user_id",t).eq("session_id",r)}catch(n){console.error("Lỗi heartbeat:",n)}},3e4)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}getDeviceInfo(){const t=navigator.userAgent;let r="Unknown";/Mobile|Android|iPhone|iPad/i.test(t)?r="Mobile":/Tablet|iPad/i.test(t)?r="Tablet":r="Desktop";const n=this.getBrowser(t);return`${r} - ${n}`}getBrowser(t){return t.includes("Chrome")?"Chrome":t.includes("Firefox")?"Firefox":t.includes("Safari")?"Safari":t.includes("Edge")?"Edge":"Unknown"}async getIPAddress(){try{const t=new AbortController,r=setTimeout(()=>t.abort(),2e3),n=await fetch("https://api.ipify.org?format=json",{signal:t.signal});return clearTimeout(r),(await n.json()).ip||"Unknown"}catch{return"Unknown"}}getCurrentSessionId(){return this.currentSessionId}}const pg=new dE,vv=()=>{var o;const[e,t]=K.useState({user:null,loading:!0,error:null});K.useEffect(()=>{let l=!0,c;if(!cs()||!he){console.log("⚠️ Supabase chưa được cấu hình, bỏ qua authentication"),l&&t({user:null,loading:!1,error:null});return}console.log("🔄 Bắt đầu kiểm tra session..."),(async()=>{try{console.log("🔄 Đang lấy session từ Supabase..."),c=setTimeout(()=>{l&&(console.warn("⚠️ Session timeout sau 15s, fallback to no auth"),t({user:null,loading:!1,error:null}))},15e3);const{data:{session:d},error:m}=await he.auth.getSession();if(c&&clearTimeout(c),!l)return;if(m){console.error("❌ Lỗi khi lấy session:",m),t({user:null,loading:!1,error:null});return}if(console.log("✅ Lấy session thành công:",d?"Có session":"Không có session"),d!=null&&d.user){console.log("🔄 Có user trong session, đang lấy profile...");try{const x=await r(d.user.id,1e4,2);console.log("✅ Lấy profile thành công:",x),l&&t({user:x,loading:!1,error:null})}catch(x){console.error("❌ Lỗi lấy profile:",x),l&&t({user:null,loading:!1,error:"Không thể kết nối database. Vui lòng thử lại."})}}else console.log("ℹ️ Không có user trong session"),l&&t({user:null,loading:!1,error:null})}catch(d){console.error("❌ Lỗi trong getSession:",d),c&&clearTimeout(c),l&&t({user:null,loading:!1,error:null})}})(),console.log("🔄 Đang thiết lập listener cho auth state changes...");const{data:{subscription:h}}=he.auth.onAuthStateChange((d,m)=>{if(console.log("🔄 Auth state changed:",d,m?"Có session":"Không có session"),!!l){if(d==="SIGNED_OUT"){console.log("🚪 Đã bị đăng xuất từ thiết bị khác"),t({user:null,loading:!1,error:null});return}m!=null&&m.user?(async()=>{try{const x=await r(m.user.id,5e3,1);l&&t({user:x,loading:!1,error:null})}catch(x){console.error("❌ Lỗi lấy profile trong auth change:",x),l&&t({user:null,loading:!1,error:"Không thể tải thông tin người dùng"})}})():t({user:null,loading:!1,error:null})}});return console.log("✅ Auth listener đã được thiết lập"),()=>{l=!1,c&&clearTimeout(c),h.unsubscribe()}},[]);const r=async(l,c=1e4,u=2)=>{var h,d,m,x;if(!he)throw new Error("Supabase chưa được cấu hình");console.log("🔄 Đang lấy profile cho user ID:",l,"(timeout:",c,"ms, retries:",u,")");for(let g=0;g<=u;g++)try{const v=new Promise((_,S)=>{setTimeout(()=>{console.warn("⏱️ TIMEOUT lấy profile sau",c,"ms (attempt",g+1,")"),S(new Error("Timeout"))},c)}),w=he.from("user_profiles").select("*").eq("id",l).maybeSingle(),{data:y,error:p}=await Promise.race([w,v]);if(p){if(console.error(`❌ Lỗi lấy profile từ DB (attempt ${g+1}):`,p),g<u){console.log("🔄 Retry sau 1 giây..."),await new Promise(_=>setTimeout(_,1e3));continue}throw p}if(!y){console.warn("⚠️ Không tìm thấy profile, tạo mới...");const{data:_}=await he.auth.getUser(),S={id:l,email:((h=_.user)==null?void 0:h.email)||"",role:"user",full_name:((m=(d=_.user)==null?void 0:d.user_metadata)==null?void 0:m.full_name)||((x=_.user)==null?void 0:x.email)||"",created_at:new Date().toISOString()},{error:E}=await he.from("user_profiles").insert([S]);if(E)throw console.error("❌ Không thể tạo profile:",E),E;return console.log("✅ Đã tạo profile mới:",S),S}return console.log("✅ Lấy profile từ DB thành công:",y),console.log("🔍 Profile role:",y.role),y}catch(v){if(g<u&&v.message==="Timeout"){console.log(`🔄 Retry lần ${g+2} sau 1 giây...`),await new Promise(w=>setTimeout(w,1e3));continue}throw console.error("❌ Lỗi khi lấy profile:",v),v}throw new Error("Không thể lấy profile sau nhiều lần thử")};return{...e,login:async l=>{var c,u,h,d,m,x;if(!he)throw new Error("Chưa cấu hình Supabase. Vui lòng cấu hình Supabase để sử dụng tính năng đăng nhập.");t(g=>({...g,loading:!0,error:null}));try{console.log("🔄 Đang thử đăng nhập với email:",l.email);const{data:g,error:v}=await he.auth.signInWithPassword({email:l.email,password:l.password});if(v)throw console.error("❌ Lỗi đăng nhập từ Supabase:",v),(c=v.message)!=null&&c.includes("Invalid login credentials")?new Error("❌ Email hoặc mật khẩu không đúng"):(u=v.message)!=null&&u.includes("Email not confirmed")?new Error("📧 Email chưa được xác nhận"):(h=v.message)!=null&&h.includes("Too many requests")?new Error("⏳ Quá nhiều lần thử. Vui lòng đợi 1 phút"):(d=v.message)!=null&&d.includes("timeout")?new Error("⏱️ Kết nối chậm. Vui lòng thử lại"):(m=v.message)!=null&&m.includes("fetch")||(x=v.message)!=null&&x.includes("network")?new Error("🌐 Lỗi kết nối mạng"):v;if(console.log("✅ Đăng nhập Supabase thành công:",g),g.user&&g.session){console.log("🔄 Đang lấy thông tin profile user...");const w=await r(g.user.id,1e4,2);return console.log("✅ Lấy profile thành công:",w),t({user:w,loading:!1,error:null}),console.log("✅ Đã cập nhật auth state với role:",w.role),w}else throw new Error("Không nhận được thông tin user từ Supabase")}catch(g){console.error("❌ Chi tiết lỗi đăng nhập:",g);let v="Lỗi đăng nhập không xác định";throw g instanceof Error&&(g.message.includes("timeout")?v="⏱️ Kết nối chậm. Kiểm tra mạng và thử lại":g.message.includes("fetch")||g.message.includes("network")?v="🌐 Không thể kết nối server":v=g.message),t(w=>({...w,loading:!1,error:v})),g}},register:async l=>{if(!he)throw new Error("Chưa cấu hình Supabase. Vui lòng cấu hình Supabase để sử dụng tính năng đăng ký.");t(c=>({...c,loading:!0,error:null}));try{console.log("🔄 Bắt đầu đăng ký với:",{email:l.email,role:l.role,full_name:l.full_name});const c=he.auth.signUp({email:l.email,password:l.password,options:{data:{full_name:l.full_name||"",role:l.role||"user"}}}),u=new Promise((m,x)=>{setTimeout(()=>x(new Error("Register timeout after 10 seconds")),1e4)}),{data:h,error:d}=await Promise.race([c,u]);if(d)throw d;if(console.log("✅ Đăng ký auth thành công:",h),h.user){const m={id:h.user.id,email:l.email,role:l.role||"user",full_name:l.full_name||"",created_at:new Date().toISOString()};return console.log("🔄 Tạo user profile:",m),he.from("user_profiles").insert([m]).then(({error:x})=>{x?console.warn("⚠️ Không thể tạo profile trong DB:",x):console.log("✅ Tạo user profile thành công (background)")}).catch(x=>console.warn("⚠️ Lỗi khi tạo profile:",x)),t({user:m,loading:!1,error:null}),console.log("✅ Đăng ký hoàn tất thành công"),m}}catch(c){console.error("❌ Lỗi đăng ký:",c);const u=c instanceof Error?c.message:"Lỗi đăng ký";throw t(h=>({...h,loading:!1,error:u})),c}},logout:async()=>{if(he)try{const l=e.user,c=pg.getCurrentSessionId();l&&c&&await pg.endSession(l.id,c);const{error:u}=await he.auth.signOut({scope:"global"});if(u)throw u;t({user:null,loading:!1,error:null}),typeof window<"u"&&(Object.keys(localStorage).forEach(h=>{(h.includes("supabase")||h.includes("sb-"))&&localStorage.removeItem(h)}),Object.keys(sessionStorage).forEach(h=>{(h.includes("supabase")||h.includes("sb-"))&&sessionStorage.removeItem(h)}))}catch(l){console.error("Lỗi đăng xuất:",l),t({user:null,loading:!1,error:null})}},updateProfile:async l=>{if(!(!he||!e.user))try{const{error:c}=await he.from("user_profiles").update(l).eq("id",e.user.id);if(c)throw c;t(u=>({...u,user:u.user?{...u.user,...l}:null}))}catch(c){throw console.error("Lỗi cập nhật profile:",c),c}},isAdmin:((o=e.user)==null?void 0:o.role)==="admin",isAuthenticated:!!e.user,isSupabaseConfigured:cs()}},wv=()=>{const[e,t]=K.useState([]),[r,n]=K.useState(!0),[s,a]=K.useState(null),{user:i}=vv(),o=K.useCallback(async()=>{var d,m,x,g;try{n(!0),a(null);let v=0;const w=3;let y=null;for(;v<w;)try{const p=new AbortController,_=setTimeout(()=>p.abort(),15e3),{data:S,error:E}=await he.from("quiz_templates").select("*").eq("is_active",!0).order("created_at",{ascending:!1}).abortSignal(p.signal);if(clearTimeout(_),E)throw E;const k=(S||[]).map(C=>({id:C.id,name:C.name,description:C.description,mode:C.mode,timeLimit:C.time_limit||60,totalQuestions:C.total_questions||20,categories:C.categories||{},isActive:C.is_active,createdBy:C.created_by,createdAt:C.created_at,updatedAt:C.updated_at}));console.log("🔄 Formatted templates:",k),t(k),a(null);return}catch(p){if(y=p,v++,p.name==="AbortError")throw new Error("Kết nối timeout. Vui lòng kiểm tra kết nối mạng.");if(p.code==="PGRST116"||(d=p.message)!=null&&d.includes("relation")||(m=p.message)!=null&&m.includes("does not exist"))throw new Error("Bảng quiz_templates chưa được tạo. Vui lòng chạy SQL script trong hướng dẫn Supabase.");if(p.code==="42501"||(x=p.message)!=null&&x.includes("permission denied"))throw new Error("Lỗi phân quyền. Vui lòng kiểm tra RLS policies trong Supabase.");v<w&&await new Promise(_=>setTimeout(_,Math.pow(2,v)*1e3))}throw y||new Error("Không thể tải danh sách đề thi sau nhiều lần thử.")}catch(v){console.error("Error loading quiz templates:",v);let w="Không thể tải danh sách đề thi";(g=v.message)!=null&&g.includes("Failed to fetch")?w=`Lỗi kết nối. Vui lòng kiểm tra:
• Kết nối internet
• Cấu hình Supabase URL/Key trong file .env
• Supabase project có đang hoạt động`:v.message&&(w=v.message),a(w),t([])}finally{n(!1)}},[i]);K.useCallback(async d=>{try{if(!i)throw new Error("Bạn cần đăng nhập để tạo đề thi");const{data:m,error:x}=await he.from("quiz_templates").insert([{...d,created_by:i.id}]).select().single();if(x)throw x;return await o(),m}catch(m){throw console.error("Error creating template:",m),m}},[i,o]);const l=K.useCallback(async(d,m)=>{var x,g,v,w,y;try{if(!i)throw new Error("Bạn cần đăng nhập để cập nhật đề thi");console.log("🔄 Updating template:",d,"with updates:",m);const p={};if(m.name!==void 0&&(p.name=m.name),m.description!==void 0&&(p.description=m.description),m.mode!==void 0&&(p.mode=m.mode),m.timeLimit!==void 0){const E=typeof m.timeLimit=="string"?parseInt(m.timeLimit):m.timeLimit;p.time_limit=isNaN(E)?60:E,console.log("🔄 Setting time_limit to:",m.timeLimit)}if(m.totalQuestions!==void 0){const E=typeof m.totalQuestions=="string"?parseInt(m.totalQuestions):m.totalQuestions;p.total_questions=isNaN(E)?20:E,console.log("🔄 Setting total_questions to:",m.totalQuestions)}m.categories!==void 0&&(p.categories=m.categories),m.isActive!==void 0&&(p.is_active=m.isActive),m.createdBy!==void 0&&(p.created_by=m.createdBy),p.updated_at=new Date().toISOString(),console.log("🔄 Database updates:",p);let _,S;try{if(_=await he.from("quiz_templates").update(p).eq("id",d).select().single(),_.error)throw _.error;console.log("✅ Standard update successful:",_.data)}catch(E){console.warn("⚠️ Standard update failed:",E),S=E;try{const k=await he.from("quiz_templates").update(p).eq("id",d);if(k.error)throw k.error;const{data:C,error:T}=await he.from("quiz_templates").select("*").eq("id",d).single();if(T)throw T;_={data:C,error:null},console.log("✅ Simple update + select successful:",C)}catch(k){console.warn("⚠️ Simple update also failed:",k);try{const C=await he.rpc("update_quiz_template",{template_id:d,updates:p});if(C.error)throw C.error;return console.log("✅ RPC update successful"),await o(),!0}catch(C){throw console.error("❌ All update methods failed:",{err:E,err2:k,err3:C}),S||E}}}if(_!=null&&_.error)throw console.error("❌ Update failed with error:",_.error),_.error;return console.log("✅ Template updated successfully"),await o(),!0}catch(p){console.error("❌ updateTemplate error:",p);let _="Không thể cập nhật bộ đề thi";throw(x=p.message)!=null&&x.includes("permission denied")||p.code==="42501"?_="❌ Không có quyền cập nhật bộ đề thi này. Chỉ người tạo hoặc admin mới có thể cập nhật.":(g=p.message)!=null&&g.includes("Could not find")||p.code==="PGRST204"?_="❌ Lỗi cấu trúc database. Vui lòng kiểm tra bảng quiz_templates trong Supabase.":(v=p.message)!=null&&v.includes("timeout")?_="⏱️ Timeout khi cập nhật. Vui lòng thử lại.":((w=p.message)!=null&&w.includes("network")||(y=p.message)!=null&&y.includes("fetch"))&&(_="🌐 Lỗi kết nối mạng. Kiểm tra internet và thử lại."),new Error(_)}},[i,o]),c=K.useCallback(async d=>{var m,x,g,v,w;try{if(!i)throw new Error("Bạn cần đăng nhập để xóa đề thi");console.log("🔄 Attempting to delete template:",d);try{const y=await he.rpc("delete_quiz_template",{template_id:d});if(y.error)throw console.warn("⚠️ RPC delete failed:",y.error),y.error;const p=y.data;if(p&&!p.success)throw new Error(p.error||"RPC delete failed");return console.log("✅ RPC delete successful:",p),await o(),!0}catch(y){console.warn("⚠️ RPC delete failed, trying soft delete:",y);try{const p=await he.from("quiz_templates").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",d);if(p.error)throw console.warn("⚠️ Soft delete failed:",p.error),p.error;return console.log("✅ Soft delete successful"),await o(),!0}catch(p){console.warn("⚠️ Soft delete failed, trying hard delete:",p);try{const _=await he.from("quiz_templates").delete().eq("id",d);if(_.error)throw console.error("❌ Hard delete also failed:",_.error),_.error;return console.log("✅ Hard delete successful"),await o(),!0}catch(_){throw console.error("❌ All delete methods failed:",{rpcError:y,softError:p,hardError:_}),y}}}}catch(y){console.error("❌ deleteTemplate error:",y);let p="Không thể xóa bộ đề thi";throw(m=y.message)!=null&&m.includes("permission denied")||y.code==="42501"?p="❌ Không có quyền xóa bộ đề thi này. Chỉ người tạo hoặc admin mới có thể xóa.":(x=y.message)!=null&&x.includes("Could not find")||y.code==="PGRST204"?p="❌ Lỗi cấu trúc database. Vui lòng kiểm tra bảng quiz_templates trong Supabase.":(g=y.message)!=null&&g.includes("timeout")?p="⏱️ Timeout khi xóa. Vui lòng thử lại.":((v=y.message)!=null&&v.includes("network")||(w=y.message)!=null&&w.includes("fetch"))&&(p="🌐 Lỗi kết nối mạng. Kiểm tra internet và thử lại."),new Error(p)}},[i,o]),u=K.useCallback(async d=>{try{if(!i)throw new Error("Bạn cần đăng nhập để tạo đề thi");console.log("🔄 Creating new template:",d.name);const{data:m,error:x}=await he.from("quiz_templates").insert([{name:d.name,description:d.description,mode:d.mode,time_limit:typeof d.timeLimit=="string"?parseInt(d.timeLimit):d.timeLimit,total_questions:typeof d.totalQuestions=="string"?parseInt(d.totalQuestions):d.totalQuestions,categories:d.categories,is_active:d.isActive,created_by:d.createdBy}]).select().single();if(x)throw console.error("❌ Create template failed:",x),new Error(`Không thể tạo bộ đề thi: ${x.message}`);return console.log("✅ Template created successfully:",m),await o(),!0}catch(m){throw console.error("Error creating template:",m),m}},[i,o]),h=K.useCallback(()=>{const d=setTimeout(()=>{o()},300);return()=>clearTimeout(d)},[o]);return K.useEffect(()=>{o()},[o]),{templates:e,loading:r,error:s,loadTemplates:o,saveTemplate:u,updateTemplate:l,deleteTemplate:c,reloadTemplates:h}},mE=({questions:e})=>{const[t,r]=K.useState(""),[n,s]=K.useState("all"),[a,i]=K.useState([]),[o,l]=K.useState(!1),[c,u]=K.useState(!1),h=K.useRef(null),d=["all",...new Set(e.map(p=>p.category))],m=p=>p.toLowerCase().trim().replace(/[.,!?;:()"\[\]{}]/g," ").replace(/\s+/g," ").trim(),x=(p,_)=>{const S=m(p),E=m(_);if(S===E)return 1;if(S.includes(E))return .95;if(E.includes(S))return .9;const k=S.split(/\s+/).filter(D=>D.length>0),C=E.split(/\s+/).filter(D=>D.length>0);let T=0;const R=C.filter(D=>D.length>=1);for(const D of R)for(const q of k)if(!(q.length<1)){if(D.length<=2){if(q===D||q.includes(D)){T++;break}}else if(q.includes(D)||D.includes(q)){T++;break}}if(T===0)return 0;const L=T/R.length;return L>=.5?.6+L*.3:L*.5},g=(p,_)=>{const S=[];return e.forEach((E,k)=>{if(_!=="all"&&E.category!==_)return;const C=x(E.question,p);let T=0;E.options.forEach(L=>{const D=x(L,p);T=Math.max(T,D)});const R=Math.max(C,T);R>.15&&S.push({question:E,index:k+1,similarity:R})}),S.sort((E,k)=>k.similarity-E.similarity).slice(0,3)};K.useEffect(()=>{if(t.trim().length<1){i([]);return}l(!0);const p=t.toLowerCase().trim(),_=g(p,n);i(_),l(!1)},[t,n,e]);const v=()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){alert("Trình duyệt của bạn không hỗ trợ nhận dạng giọng nói. Vui lòng sử dụng Chrome hoặc Edge.");return}const p=window.SpeechRecognition||window.webkitSpeechRecognition,_=new p;_.lang="vi-VN",_.continuous=!1,_.interimResults=!1,_.maxAlternatives=1,_.onstart=()=>{u(!0)},_.onresult=S=>{let E=S.results[0][0].transcript;E=E.trim(),E=E.replace(/[.,!?;:]$/g,""),E=E.trim(),r(E),u(!1)},_.onerror=S=>{console.error("Speech recognition error:",S.error),u(!1),S.error==="no-speech"?alert("Không nhận được giọng nói. Vui lòng thử lại."):S.error==="not-allowed"?alert("Vui lòng cho phép truy cập microphone để sử dụng tính năng này."):alert("Lỗi nhận dạng giọng nói. Vui lòng thử lại.")},_.onend=()=>{u(!1)},h.current=_,_.start()},w=()=>{h.current&&(h.current.stop(),u(!1))},y=(p,_)=>{if(!_.trim())return p;const E=m(_).split(/\s+/).filter(C=>C.length>=1);if(E.length===0)return p;let k=p;return E.forEach(C=>{const T=C.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),R=new RegExp(`(${T})`,"gi");k=k.replace(R,'<mark class="bg-yellow-200 font-semibold">$1</mark>')}),f.jsx("span",{dangerouslySetInnerHTML:{__html:k}})};return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(W1,{className:"w-5 h-5"}),"Tra cứu nhanh đáp án"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[f.jsxs("div",{className:"flex-1 relative",children:[f.jsx("input",{type:"text",placeholder:"Nhập từ khóa hoặc nói để tìm kiếm...",value:t,onChange:p=>r(p.target.value),className:"w-full px-4 py-3 pr-16 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),f.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2",children:f.jsx("button",{onClick:c?w:v,className:`p-2 rounded-lg transition-colors ${c?"bg-red-100 text-red-600 hover:bg-red-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:"Tìm kiếm bằng giọng nói",children:c?f.jsxs("div",{className:"relative",children:[f.jsx(ru,{className:"w-5 h-5 animate-pulse"}),f.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full animate-ping"})]}):f.jsx(ru,{className:"w-5 h-5"})})})]}),f.jsxs("select",{value:n,onChange:p=>s(p.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent md:min-w-[200px] w-full md:w-auto",children:[f.jsx("option",{value:"all",children:"Tất cả chuyên đề"}),d.filter(p=>p!=="all").map(p=>f.jsx("option",{value:p,children:p},p))]})]}),c&&f.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[f.jsx(ru,{className:"w-5 h-5 text-red-600 animate-pulse"}),f.jsx("span",{className:"text-red-800 font-medium",children:"Đang lắng nghe..."})]}),f.jsx("button",{onClick:w,className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:"Dừng"})]}),t.trim().length>0&&t.trim().length<1&&f.jsx("div",{className:"text-sm text-gray-500 p-3 bg-gray-50 rounded-lg",children:"Vui lòng nhập ít nhất 1 ký tự để tìm kiếm"}),t.trim().length>=1&&a.length===0&&!o&&f.jsxs("div",{className:"text-sm text-gray-600 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[f.jsx("p",{className:"font-medium text-yellow-800 mb-1",children:"❌ Không tìm thấy kết quả"}),f.jsxs("p",{className:"text-yellow-700",children:['Không tìm thấy câu hỏi phù hợp với từ khóa "',t,'"',n!=="all"&&` trong chuyên đề "${n}"`,"."]}),f.jsx("p",{className:"text-yellow-700 mt-2",children:"💡 Vui lòng thử lại với từ khóa khác."})]}),a.length>0&&f.jsxs("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:[f.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Tìm thấy ",f.jsx("strong",{children:a.length})," kết quả (Top 3 câu hỏi phù hợp nhất)"]}),a.map(({question:p,index:_,similarity:S})=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 hover:border-blue-300 hover:shadow-sm transition-all",children:[f.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[f.jsx("span",{className:"inline-flex items-center justify-center px-2 py-1 bg-blue-100 text-blue-700 rounded font-semibold text-xs flex-shrink-0",children:_}),f.jsx("p",{className:"text-gray-900 text-sm leading-relaxed flex-1",children:y(p.question,t.trim())})]}),f.jsx("div",{className:"space-y-1.5 ml-0 md:ml-12",children:p.options.map((E,k)=>{const C=k===p.correctAnswer;return f.jsx("div",{className:`p-2 rounded-lg ${C?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"}`,children:f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsxs("span",{className:`text-sm font-semibold flex-shrink-0 ${C?"text-green-700":"text-gray-600"}`,children:[String.fromCharCode(65+k),"."]}),f.jsx("span",{className:`text-sm flex-1 ${C?"text-green-900 font-medium":"text-gray-700"}`,children:y(E,t.trim())}),C&&f.jsxs("span",{className:"text-green-600 font-semibold flex items-center gap-1 text-xs flex-shrink-0",children:[f.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),f.jsx("span",{className:"hidden md:inline",children:"Đáp án"})]})]})},k)})}),p.explanation&&f.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-lg ml-0 md:ml-12",children:f.jsxs("p",{className:"text-xs text-blue-900",children:[f.jsx("strong",{children:"Giải thích:"})," ",p.explanation]})})]},p.id))]})]})]})},gE=({refreshTrigger:e})=>{const[t,r]=K.useState([]),[n,s]=K.useState(!0),[a,i]=K.useState(null);K.useEffect(()=>{o()},[e]),K.useEffect(()=>{o();const m=setInterval(()=>{o()},3e4);return()=>clearInterval(m)},[]);const o=async()=>{if(!he){i("Chưa cấu hình Supabase"),s(!1);return}try{s(!0);const{data:m,error:x}=await he.from("quiz_rankings").select("*").limit(10);if(x)throw x;r(m||[]),i(null)}catch(m){console.error("Lỗi khi lấy bảng xếp hạng:",m),i("Không thể tải bảng xếp hạng")}finally{s(!1)}},l=m=>["🏆 CAO THỦ VÀNG - THIÊN HẠ VÔ ĐỊCH","🥈 CAO THỦ BẠC - ĐỘC CÔ CẦU BẠI","🥉 CAO THỦ ĐỒNG - ĐẠI HIỆP LANG THANG","⭐ CAO THỦ - TÂN MINH CHỦ VÕ LÂM","⭐ CAO THỦ - ẨN THẾ CAO NHÂN","⭐ CAO THỦ - TRƯỞNG LÃO ĂN MAY","⭐ CAO THỦ - ĐỆ NHẤT ĂN HÀNH","⭐ CAO THỦ - CẦN VƯƠNG KIẾM KHÁCH","⭐ CAO THỦ - ĐỒ ĐỆ VỪA XUỐNG NÚI","⭐ CAO THỦ - TÂN THỦ TẬP TỄNH"][m-1]||"⭐ CAO THỦ - TẬP TỄNH HỌC HỎI",c=m=>{switch(m){case 1:return f.jsx(Fr,{className:"w-6 h-6 md:w-7 md:h-7 text-yellow-500"});case 2:return f.jsx(Pk,{className:"w-6 h-6 md:w-7 md:h-7 text-gray-400"});case 3:return f.jsx(wf,{className:"w-6 h-6 md:w-7 md:h-7 text-amber-600"});default:return f.jsx(G1,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-500"})}},u=m=>{switch(m){case 1:return"bg-gradient-to-r from-yellow-50 to-yellow-100 border-yellow-300";case 2:return"bg-gradient-to-r from-gray-50 to-gray-100 border-gray-300";case 3:return"bg-gradient-to-r from-amber-50 to-amber-100 border-amber-300";case 4:case 5:return"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200";case 6:case 7:return"bg-gradient-to-r from-green-50 to-green-100 border-green-200";default:return"bg-gradient-to-r from-gray-50 to-gray-100 border-gray-200"}},h=m=>{switch(m){case 1:return"text-yellow-600";case 2:return"text-gray-600";case 3:return"text-amber-600";case 4:case 5:return"text-blue-600";case 6:case 7:return"text-green-600";default:return"text-gray-600"}},d=m=>{const x=Math.floor(m/60),g=m%60;return`${x}:${g.toString().padStart(2,"0")}`};return n?f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx(Fr,{className:"w-6 h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bảng Xếp Hạng"})]}),f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Đang tải..."})]}):a?f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx(Fr,{className:"w-6 h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bảng Xếp Hạng"})]}),f.jsx("div",{className:"text-center py-8 text-red-500",children:a})]}):t.length===0?f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx(Fr,{className:"w-6 h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bảng Xếp Hạng"})]}),f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Chưa có dữ liệu xếp hạng"})]}):f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 md:p-6",children:[f.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-4",children:[f.jsx(Fr,{className:"w-5 h-5 md:w-6 md:h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-800",children:"🏆 Bảng Xếp Hạng Cao Thủ"})]}),f.jsx("div",{className:"space-y-2",children:t.map(m=>f.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border-2 transition-all hover:shadow-md ${u(m.rank)}`,children:[f.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[f.jsxs("div",{className:"text-lg font-bold text-gray-700 w-6 text-center",children:["#",m.rank]}),c(m.rank)]}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"font-semibold text-gray-900 text-sm md:text-base truncate",children:m.user_name||m.email}),f.jsx("div",{className:`text-xs md:text-sm font-medium ${h(m.rank)}`,children:l(m.rank)})]}),f.jsxs("div",{className:"text-right flex-shrink-0",children:[f.jsxs("div",{className:"text-lg md:text-xl font-bold text-green-600",children:[m.average_score.toFixed(0),"% ",m.average_score>=80?"✅":"📊"]}),f.jsxs("div",{className:"text-xs text-gray-500",children:["⏱️ ",d(m.best_time)]})]})]},m.user_id))}),f.jsx("div",{className:"mt-4 p-3 bg-gradient-to-r from-yellow-50 to-amber-50 border-2 border-yellow-300 rounded-lg",children:f.jsxs("p",{className:"text-xs md:text-sm text-gray-700",children:[f.jsx("strong",{className:"text-[#A50034]",children:"🌟 Bảng Vinh Danh Cao Thủ:"})," Top 10 thí sinh có điểm số cao nhất. Nếu điểm bằng nhau, thứ hạng được xếp theo thời gian hoàn thành nhanh nhất. Danh hiệu cao thủ sẽ tự động cập nhật theo thứ hạng!"]})})]})},pE=()=>{const{user:e}=xa(),[t,r]=K.useState(null),[n,s]=K.useState([]),[a,i]=K.useState(0),[o,l]=K.useState(!0),[c,u]=K.useState(null);K.useEffect(()=>{h();const _=()=>{h()};return window.addEventListener("quizCompleted",_),()=>window.removeEventListener("quizCompleted",_)},[e]);const h=async()=>{if(!he||!e){l(!1);return}try{l(!0);const{data:_,error:S}=await he.from("quiz_rankings").select("*").eq("user_id",e.id).maybeSingle();if(S)throw S;const{count:E,error:k}=await he.from("quiz_rankings").select("*",{count:"exact",head:!0});if(k)throw k;const{data:C,error:T}=await he.from("quiz_results").select("*").eq("user_id",e.id).eq("quiz_type","exam").order("created_at",{ascending:!1}).limit(1);if(T)throw T;r(_),i(E||0),s(C||[]),u(null)}catch(_){console.error("Lỗi khi lấy thống kê:",_),u("Không thể tải thống kê")}finally{l(!1)}},d=_=>{const S=Math.floor(_/60),E=_%60;return`${S}:${E.toString().padStart(2,"0")}`},m=_=>new Date(_).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),x=_=>_>=90?{text:"Xuất sắc",color:"text-green-600",bg:"bg-green-100"}:_>=80?{text:"Giỏi",color:"text-blue-600",bg:"bg-blue-100"}:_>=70?{text:"Khá",color:"text-yellow-600",bg:"bg-yellow-100"}:_>=60?{text:"Trung bình",color:"text-orange-600",bg:"bg-orange-100"}:{text:"Cần cố gắng",color:"text-red-600",bg:"bg-red-100"},g=_=>_===1?"text-yellow-600":_===2?"text-gray-500":_===3?"text-amber-600":_<=10?"text-blue-600":"text-gray-700",v=_=>_===1?"🥇":_===2?"🥈":_===3?"🥉":_<=10?"🏆":"📊";if(o)return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(jn,{className:"w-5 h-5 text-[#A50034]"}),"Thống kê của bạn"]}),f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Đang tải..."})]});if(c)return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(jn,{className:"w-5 h-5 text-[#A50034]"}),"Thống kê của bạn"]}),f.jsx("div",{className:"text-center py-8 text-red-500",children:c})]});if(!t)return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(jn,{className:"w-5 h-5 text-[#A50034]"}),"Thống kê của bạn"]}),f.jsxs("div",{className:"text-center py-8",children:[f.jsx(wf,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600 mb-2",children:"Bạn chưa có kết quả nào"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Hãy bắt đầu làm bài để xem thống kê và xếp hạng của mình!"})]})]});const w=x(t.average_score),y=t.rank<=10,p=a>0?((a-t.rank+1)/a*100).toFixed(0):0;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-pink-50 rounded-lg border-2 border-red-200 p-3 md:p-6",children:[f.jsxs("h2",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4 flex items-center gap-2 text-gray-800",children:[f.jsx(Fr,{className:"w-4 h-4 md:w-5 md:h-5 text-[#A50034]"}),"Thống kê của bạn"]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4",children:[f.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 text-center border border-red-100 shadow-sm",children:[f.jsx("div",{className:"text-xl md:text-3xl mb-1 md:mb-2",children:v(t.rank)}),f.jsxs("div",{className:`text-lg md:text-2xl font-bold mb-0.5 md:mb-1 ${g(t.rank)}`,children:["#",t.rank]}),f.jsxs("div",{className:"text-[10px] md:text-xs text-gray-600",children:["/ ",a]}),f.jsxs("div",{className:"text-[10px] md:text-xs text-gray-500 mt-0.5 md:mt-1",children:["Top ",p,"%"]})]}),f.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 text-center border border-red-100 shadow-sm",children:[f.jsx(G1,{className:"w-4 h-4 md:w-6 md:h-6 mx-auto mb-1 md:mb-2 text-[#A50034]"}),f.jsxs("div",{className:"text-lg md:text-2xl font-bold mb-0.5 md:mb-1 text-[#A50034]",children:[t.average_score.toFixed(1),"%"]}),f.jsx("div",{className:"text-[10px] md:text-xs text-gray-600",children:"Điểm TB"}),f.jsx("div",{className:`text-[9px] md:text-xs mt-0.5 md:mt-1 px-1.5 md:px-2 py-0.5 rounded-full ${w.bg} ${w.color} inline-block`,children:w.text})]}),f.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 text-center border border-red-100 shadow-sm",children:[f.jsx(wf,{className:"w-4 h-4 md:w-6 md:h-6 mx-auto mb-1 md:mb-2 text-[#A50034]"}),f.jsxs("div",{className:"text-lg md:text-2xl font-bold mb-0.5 md:mb-1 text-[#A50034]",children:[t.best_score.toFixed(1),"%"]}),f.jsx("div",{className:"text-[10px] md:text-xs text-gray-600",children:"Điểm cao nhất"}),f.jsxs("div",{className:"text-[10px] md:text-xs text-gray-500 mt-0.5 md:mt-1",children:[t.total_attempts," lần"]})]}),f.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 text-center border border-red-100 shadow-sm",children:[f.jsx(mi,{className:"w-4 h-4 md:w-6 md:h-6 mx-auto mb-1 md:mb-2 text-[#A50034]"}),f.jsx("div",{className:"text-lg md:text-2xl font-bold mb-0.5 md:mb-1 text-gray-800",children:d(t.best_time)}),f.jsx("div",{className:"text-[10px] md:text-xs text-gray-600",children:"TG tốt nhất"})]})]}),f.jsx("div",{className:"mt-2 md:mt-4 p-2 md:p-3 bg-white rounded-lg border border-red-200",children:y?f.jsxs("p",{className:"text-xs md:text-sm text-center text-gray-700",children:["🌟 ",f.jsx("strong",{className:"text-[#A50034]",children:"Xuất sắc!"})," Bạn đang ở Top ",t.rank,". Tiếp tục phấn đấu!"]}):t.rank<=20?f.jsxs("p",{className:"text-xs md:text-sm text-center text-gray-700",children:["💪 ",f.jsx("strong",{className:"text-[#A50034]",children:"Rất tốt!"})," Còn cách Top 10 ",t.rank-10," vị trí!"]}):f.jsxs("p",{className:"text-xs md:text-sm text-center text-gray-700",children:["🎯 ",f.jsx("strong",{className:"text-[#A50034]",children:"Hãy cố gắng!"})," Làm thêm bài để cải thiện điểm!"]})})]}),n.length>0&&f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 md:p-6",children:[f.jsxs("h3",{className:"text-base font-semibold mb-4 flex items-center gap-2",children:[f.jsx(mi,{className:"w-4 h-4 text-[#A50034]"}),"Lần thi thử gần nhất"]}),f.jsx("div",{className:"space-y-2",children:n.map((_,S)=>{const E=x(_.percentage),k=S<n.length-1&&_.percentage>n[S+1].percentage,C=S<n.length-1&&_.percentage<n[S+1].percentage;return f.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx("div",{className:`w-12 h-12 rounded-full ${E.bg} flex items-center justify-center`,children:f.jsx("span",{className:`text-lg font-bold ${E.color}`,children:_.percentage.toFixed(0)})})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${E.bg} ${E.color}`,children:E.text}),f.jsx("span",{className:"text-xs text-gray-500",children:_.quiz_type==="practice"?"🎯 Ôn thi":"📝 Thi thử"}),k&&f.jsxs("span",{className:"text-xs text-green-600 flex items-center gap-0.5",children:[f.jsx(Ak,{className:"w-3 h-3"}),"Tiến bộ"]}),C&&f.jsxs("span",{className:"text-xs text-red-600 flex items-center gap-0.5",children:[f.jsx(Ck,{className:"w-3 h-3"}),"Giảm"]})]}),f.jsxs("div",{className:"text-xs text-gray-600",children:[_.correct_answers,"/",_.total_questions," câu đúng • ",d(_.time_spent)]}),f.jsx("div",{className:"text-xs text-gray-400",children:m(_.created_at)})]}),f.jsx("div",{className:"flex-shrink-0 text-right",children:f.jsxs("div",{className:`text-lg font-bold ${E.color}`,children:[_.percentage.toFixed(1),"%"]})})]},_.id)})})]})]})},yv=({onClose:e})=>{K.useState("");const[t,r]=K.useState(""),[n,s]=K.useState("");K.useState(!1);const[a,i]=K.useState(!1),[o,l]=K.useState(!1),[c,u]=K.useState(!1),[h,d]=K.useState(""),[m,x]=K.useState(""),g=async v=>{if(v.preventDefault(),d(""),x(""),t.length<6){d("Mật khẩu mới phải có ít nhất 6 ký tự");return}if(t!==n){d("Mật khẩu xác nhận không khớp");return}u(!0),console.log("🔄 [ChangePassword] Bắt đầu đổi mật khẩu...");try{if(!he){console.error("❌ [ChangePassword] Supabase không khả dụng"),u(!1),d("Supabase chưa được cấu hình");return}console.log("🔄 [ChangePassword] Gọi RPC function...");const{data:w,error:y}=await he.rpc("change_user_password",{new_password:t});if(console.log("📝 [ChangePassword] Kết quả RPC:",{data:w,error:y}),y)throw console.error("❌ [ChangePassword] Lỗi RPC:",y),y;if(w&&!w.success)throw console.error("❌ [ChangePassword] Function trả về lỗi:",w.error),new Error(w.error);console.log("✅ [ChangePassword] Đổi mật khẩu thành công!"),u(!1),x("Đổi mật khẩu thành công!"),setTimeout(()=>{e()},1500)}catch(w){console.error("❌ [ChangePassword] Exception:",w),u(!1);let y="Lỗi khi đổi mật khẩu";w.message?y=w.message:w.error_description&&(y=w.error_description),d(y)}};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(f0,{className:"w-6 h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-xl font-bold text-[#A50034]",children:"Đổi mật khẩu"})]}),f.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:f.jsx(Ss,{className:"w-6 h-6"})})]}),h&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h}),m&&f.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm",children:m}),f.jsxs("form",{onSubmit:g,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu mới"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:a?"text":"password",value:t,onChange:v=>r(v.target.value),required:!0,className:"w-full px-4 py-3 pr-12 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập mật khẩu mới"}),f.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?f.jsx(Mo,{className:"w-5 h-5"}):f.jsx(Bo,{className:"w-5 h-5"})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Xác nhận mật khẩu mới"}),f.jsxs("div",{className:"relative",children:[f.jsx("input",{type:o?"text":"password",value:n,onChange:v=>s(v.target.value),required:!0,className:"w-full px-4 py-3 pr-12 border border-[#C1B5B0] rounded-md focus:ring-2 focus:ring-[#A50034] focus:border-transparent",placeholder:"Nhập lại mật khẩu mới"}),f.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?f.jsx(Mo,{className:"w-5 h-5"}):f.jsx(Bo,{className:"w-5 h-5"})})]})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors font-medium",children:"Hủy"}),f.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-4 py-3 bg-[#A50034] text-white rounded-md hover:bg-[#8B002D] disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:c?"Đang xử lý...":"Đổi mật khẩu"})]})]})]})})},xE=({onStartQuiz:e,questions:t,loading:r})=>{const{user:n,logout:s}=xa(),{templates:a,loadTemplates:i}=wv(),[o,l]=K.useState(!1),[c,u]=K.useState(0),[h,d]=K.useState(null),[m,x]=K.useState({mode:"practice",timeLimit:60,totalQuestions:20}),[g,v]=K.useState(!1),[w,y]=K.useState(null),[p,_]=K.useState({title:"",description:""});K.useEffect(()=>{const W=()=>{u(ee=>ee+1),S()};return window.addEventListener("quizCompleted",W),()=>window.removeEventListener("quizCompleted",W)},[]),K.useEffect(()=>{S()},[n,c]);const S=async()=>{if(!(!n||!he))try{const{data:W,error:ee}=await he.from("quiz_rankings").select("rank").eq("user_id",n.id).maybeSingle();if(ee){console.error("Lỗi khi lấy thứ hạng:",ee);return}d((W==null?void 0:W.rank)||null)}catch(W){console.error("Lỗi:",W)}},k=[...new Set(t.map(W=>W.category))].sort((W,ee)=>{const ne=W.match(/^(\d+)/),Z=ee.match(/^(\d+)/),U=ne?parseInt(ne[1]):999999,re=Z?parseInt(Z[1]):999999;return U!==re?U-re:W.localeCompare(ee)}),C=W=>({total:t.filter(ne=>ne.category===W).length,category:W}),T=k.map(C),R=W=>{if(t.length===0){alert("Không có câu hỏi nào để bắt đầu bài thi. Vui lòng liên hệ quản trị viên.");return}const ee=t.filter(Z=>Z.category===W),ne={mode:"practice",timeLimit:60*60,totalQuestions:ee.length,categories:{[W]:ee.length}};_({title:"Bắt đầu ôn luyện?",description:`Bạn sắp bắt đầu ôn luyện chuyên đề:

"${W}"

• Số câu hỏi: ${ee.length} câu
• Thời gian: 60 phút
• Chế độ: Ôn tập (xem đáp án ngay)

Bạn có muốn tiếp tục không?`}),y(ne),v(!0)},L=W=>{if(t.length===0){alert("Không có câu hỏi nào để bắt đầu bài thi. Vui lòng liên hệ quản trị viên.");return}const ee={mode:W.mode,timeLimit:W.timeLimit*60,totalQuestions:W.totalQuestions,categories:W.categories},ne=W.mode==="practice"?"Ôn tập":"Thi thử",Z=W.mode==="practice"?"xem đáp án ngay":"không xem đáp án, nộp bài khi hết giờ";_({title:`Bắt đầu ${ne.toLowerCase()}?`,description:`Bạn sắp bắt đầu bộ đề:

"${W.name}"

• Số câu hỏi: ${W.totalQuestions} câu
• Thời gian: ${W.timeLimit} phút
• Chế độ: ${ne} (${Z})

Bạn có muốn tiếp tục không?`}),y(ee),v(!0)},D=()=>{w&&(console.log("🎯 Starting quiz with config:",w),e(w),v(!1),y(null))},q=()=>{v(!1),y(null)},oe=async()=>{window.confirm("Bạn có chắc chắn muốn đăng xuất?")&&await s()};return qf.useEffect(()=>{console.log("🔄 UserDashboard mounted, reloading templates"),i()},[i]),f.jsxs("div",{className:"min-h-screen bg-pink-50",children:[f.jsx("div",{className:"bg-[#A50034] shadow-sm",children:f.jsx("div",{className:"max-w-4xl mx-auto px-4 py-3",children:f.jsxs("div",{className:"flex justify-between items-center gap-3",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[f.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center flex-shrink-0",children:f.jsx(al,{className:"w-5 h-5 text-white"})}),f.jsx("span",{className:"font-medium text-sm text-white truncate",children:(n==null?void 0:n.full_name)||(n==null?void 0:n.email)})]}),f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-1.5 px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",title:"Đổi mật khẩu",children:[f.jsx(f0,{className:"w-4 h-4"}),f.jsx("span",{className:"text-sm hidden sm:inline",children:"Đổi MK"})]}),f.jsxs("button",{onClick:oe,className:"flex items-center gap-1.5 px-3 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",children:[f.jsx(H1,{className:"w-4 h-4"}),f.jsx("span",{className:"text-sm",children:"Thoát"})]})]})]})})}),f.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[f.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-2",children:f.jsx(gn,{className:"w-5 h-5 text-blue-600"})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900",children:r?"...":t.length}),f.jsx("p",{className:"text-xs text-gray-600",children:"Tổng câu hỏi"})]})}),f.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mb-2",children:f.jsx(jn,{className:"w-5 h-5 text-green-600"})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900",children:k.length}),f.jsx("p",{className:"text-xs text-gray-600",children:"Chuyên đề"})]})}),f.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center mb-2",children:f.jsx(Fr,{className:"w-5 h-5 text-amber-600"})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900",children:h?`#${h}`:"-"}),f.jsx("p",{className:"text-xs text-gray-600",children:"Thứ hạng"})]})})]}),f.jsx(pE,{}),f.jsx("div",{className:"mt-6",children:f.jsx(gE,{refreshTrigger:c})}),f.jsx("div",{className:"mt-6",children:f.jsx(mE,{questions:t})}),T.length>0&&f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(jn,{className:"w-5 h-5"}),"Ôn tập theo chuyên đề"]}),f.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-2 md:gap-3",children:T.map((W,ee)=>f.jsx("div",{className:"border rounded-lg p-2 md:p-3 cursor-pointer transition-all hover:border-blue-400 hover:shadow-md border-gray-200 bg-gradient-to-br from-white to-gray-50",onClick:()=>R(W.category),children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-7 h-7 md:w-10 md:h-10 bg-red-100 rounded-full flex items-center justify-center mb-1 md:mb-2",children:f.jsx("span",{className:"text-[#A50034] font-bold text-xs md:text-base",children:ee+1})}),f.jsx("h3",{className:"font-semibold text-gray-900 text-[10px] md:text-xs mb-1 line-clamp-3 min-h-[2.5rem] leading-tight",children:W.category}),f.jsxs("p",{className:"text-[10px] md:text-xs text-gray-500",children:[W.total," câu"]})]})},W.category))})]}),a.length>0&&f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(gn,{className:"w-5 h-5"}),"Thi thử nghiệp vụ"]}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-2 md:gap-4",children:a.map(W=>f.jsx("div",{className:"border rounded-lg p-2 md:p-4 cursor-pointer transition-all hover:border-blue-400 hover:shadow-md border-gray-200",onClick:()=>L(W),children:f.jsxs("div",{className:"mb-2 md:mb-3",children:[f.jsx("h3",{className:"font-semibold text-gray-900 text-xs md:text-base text-center md:text-left line-clamp-2 mb-2",children:W.name}),W.description&&f.jsx("p",{className:"text-gray-600 text-[10px] md:text-sm mb-2 line-clamp-2 hidden md:block",children:W.description}),f.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-2 md:gap-4 text-[10px] md:text-sm",children:[f.jsx("span",{className:`px-1.5 md:px-2 py-0.5 md:py-1 rounded-full text-[10px] md:text-xs font-medium flex-shrink-0 ${W.mode==="practice"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:W.mode==="practice"?"🎯":"📝"}),f.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 text-gray-500",children:[f.jsx(mi,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsxs("span",{children:[W.timeLimit,"p"]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 md:gap-1 text-gray-500",children:[f.jsx(jn,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsxs("span",{children:[W.totalQuestions,"c"]})]})]})]})},W.id))})]}),a.length===0&&f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6 mt-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-6 flex items-center gap-2",children:[f.jsx(Qm,{className:"w-5 h-5"}),"Cấu hình bài thi tùy chỉnh"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chế độ luyện thi"}),f.jsxs("select",{value:m.mode,onChange:W=>x(ee=>({...ee,mode:W.target.value})),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"practice",children:"🎯 Ôn thi (hiện đáp án ngay)"}),f.jsx("option",{value:"exam",children:"📝 Thi thử (ẩn đáp án)"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Thời gian (phút)"}),f.jsx("input",{type:"number",value:m.timeLimit,onChange:W=>x(ee=>({...ee,timeLimit:parseInt(W.target.value)||60})),min:"5",max:"180",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Số câu hỏi"}),f.jsx("input",{type:"number",value:m.totalQuestions,onChange:W=>x(ee=>({...ee,totalQuestions:parseInt(W.target.value)||20})),min:"5",max:Math.min(t.length,100),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),a.length===0&&t.length===0&&!r&&f.jsx("div",{className:"text-center mt-6 p-6 bg-gray-50 rounded-lg border border-gray-200",children:f.jsx("p",{className:"text-gray-500",children:"Chưa có câu hỏi nào. Vui lòng liên hệ quản trị viên để thêm câu hỏi."})})]}),o&&f.jsx(yv,{onClose:()=>l(!1)}),g&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsx("div",{className:"bg-white rounded-lg max-w-md w-full mx-4 shadow-xl",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx(Qm,{className:"w-6 h-6 text-blue-600"})}),f.jsx("div",{children:f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.title})})]}),f.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:f.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:p.description})}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:q,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Hủy"}),f.jsx("button",{onClick:D,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Bắt đầu"})]})]})})})]})};function xg(e){const t=[];let r="",n=!1;for(let s=0;s<e.length;s++){const a=e[s],i=e[s+1];a==='"'?n&&i==='"'?(r+='"',s++):n=!n:a===","&&!n?(t.push(r.trim()),r=""):r+=a}return t.push(r.trim()),t}function vE(e){let t=e;t.charCodeAt(0)===65279&&(t=t.slice(1));const r=t.split(/\r?\n/).filter(i=>i.trim()),n=[],s=[];if(r.length===0)throw new Error("File CSV rỗng");const a=xg(r[0]);console.log("📋 CSV Header:",a);for(let i=1;i<r.length;i++){const o=xg(r[i]);if(o.length<6){s.push({row:i+1,message:`Không đủ cột (cần 6, có ${o.length})`});continue}const[l,c,u,h,d,m,x,g]=o;if(!l||l===""){s.push({row:i+1,message:"Thiếu câu hỏi"});continue}const v=[c,u,h,d].filter(y=>y&&y!=="");if(v.length<2){s.push({row:i+1,message:`Không đủ đáp án (cần ít nhất 2, có ${v.length})`});continue}const w=parseInt(m);if(isNaN(w)||w<1||w>v.length){s.push({row:i+1,message:`Đáp án đúng không hợp lệ ("${m}")`});continue}n.push({id:`q-${Date.now()}-${i}`,question:l,options:v,correctAnswer:w-1,category:g||"Uncategorized",explanation:x||void 0})}if(s.length>0&&console.warn(`⚠️ Bỏ qua ${s.length} dòng lỗi`),n.length===0)throw new Error(`Không tìm thấy câu hỏi hợp lệ. ${s.length} dòng bị lỗi.`);return console.log(`✅ Import ${n.length} câu hỏi${s.length>0?`, bỏ qua ${s.length} dòng`:""}`),{questions:n,errors:s}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Dc={};Dc.version="0.18.5";var _v=1252,wE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gh={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Kh=function(e){wE.indexOf(e)!=-1&&(_v=Gh[0]=e)};function yE(){Kh(1252)}var fn=function(e){Kh(e)};function Xh(){fn(1200),yE()}function vg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function _E(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function kv(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var qi=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?_E(e.slice(2)):t==254&&r==255?kv(e.slice(2)):t==65279?e.slice(1):e},Ml=function(t){return String.fromCharCode(t)},wg=function(t){return String.fromCharCode(t)},us,ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $o(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=ds.charAt(a)+ds.charAt(i)+ds.charAt(o)+ds.charAt(l);return t}function Dr(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=ds.indexOf(e.charAt(c++)),i=ds.indexOf(e.charAt(c++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=ds.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=ds.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Re=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Yn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ns(e){return Re?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yg(e){return Re?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var jr=function(t){return Re?Yn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function v0(e){if(typeof ArrayBuffer>"u")return jr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Rs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function kE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function qh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qh(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Bt=Re?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Yn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function SE(e){for(var t=[],r=0,n=e.length+250,s=Ns(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Ns(65535),n=65530)}return t.push(s.slice(0,r)),Bt(t)}var fr=/\u0000/g,Qi=/[\u0001-\u0006]/g;function ni(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function hn(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}function Qh(e,t){var r=""+e;return r.length>=t?r:gt(" ",t-r.length)+r}function Lc(e,t){var r=""+e;return r.length>=t?r:r+gt(" ",t-r.length)}function EE(e,t){var r=""+Math.round(e);return r.length>=t?r:gt("0",t-r.length)+r}function bE(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}var _g=Math.pow(2,32);function Fa(e,t){if(e>_g||e<-_g)return EE(e,t);var r=Math.round(e);return bE(r,t)}function Mc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var kg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function TE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Se={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Sg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},NE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bc(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,c=0,u=0,h=Math.floor(s);c<t&&(h=Math.floor(s),o=h*i+a,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=i)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function Qs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=PE(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var Sv=new Date(1899,11,31,0,0,0),CE=Sv.getTime(),AE=new Date(1900,2,1,0,0,0);function Ev(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=AE&&(r+=24*60*60*1e3),(r-(CE+(e.getTimezoneOffset()-Sv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Yh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function FE(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jE(e){var t=e<0?12:11,r=Yh(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function OE(e){var t=Yh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Ho(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jE(e):t===10?r=e.toFixed(10).substr(0,12):r=OE(e),Yh(FE(r.toUpperCase()))}function la(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ho(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return tn(14,Ev(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function PE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function IE(e,t,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return fu[r.m-1][1];case 5:return fu[r.m-1][0];default:return fu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return kg[r.q][0];default:return kg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?hn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=hn(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?hn(l,c):"";return u}function ms(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var bv=/%/g;function RE(e,t,r){var n=t.replace(bv,""),s=t.length-n.length;return Hn(e,n,r*Math.pow(10,2*s))+gt("%",s)}function DE(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Tv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Tv(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Nv=/# (\?+)( ?)\/( ?)(\d+)/;function LE(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?gt(" ",e[1].length+1+e[4].length):Qh(i,e[1].length)+e[2]+"/"+e[3]+hn(o,e[4].length))}function ME(e,t,r){return r+(t===0?"":""+t)+gt(" ",e[1].length+2+e[4].length)}var Cv=/^#*0*\.([0#]+)/,Av=/\).*[0#]/,Fv=/\(###\) ###\\?-####/;function lr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Eg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function bg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function BE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function UE(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Hr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Av)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hr("n",n,r):"("+Hr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return DE(e,t,r);if(t.indexOf("%")!==-1)return RE(e,t,r);if(t.indexOf("E")!==-1)return Tv(t,r);if(t.charCodeAt(0)===36)return"$"+Hr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Fa(l,t.length);if(t.match(/^[#?]+$/))return s=Fa(r,0),s==="0"&&(s=""),s.length>t.length?s:lr(t.substr(0,t.length-s.length))+s;if(a=t.match(Nv))return LE(a,l,c);if(t.match(/^#+0+$/))return c+Fa(l,t.length-t.indexOf("0"));if(a=t.match(Cv))return s=Eg(r,a[1].length).replace(/^([^\.]+)$/,"$1."+lr(a[1])).replace(/\.$/,"."+lr(a[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+gt("0",lr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+Eg(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+ms(Fa(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hr(e,t,-r):ms(""+(Math.floor(r)+BE(r,a[1].length)))+"."+hn(bg(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Hr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ni(Hr(e,t.replace(/[\\-]/g,""),r)),i=0,ni(ni(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(Fv))return s=Hr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Bc(l,Math.pow(10,i)-1,!1),s=""+c,u=Hn("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Lc(o[2],i),u.length<a[4].length&&(u=lr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Bc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Qh(o[1],i)+a[2]+"/"+a[3]+Lc(o[2],i):gt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Fa(r,0),t.length<=s.length?s:lr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,d=t.length-s.length-h;return lr(t.substr(0,h)+s+t.substr(t.length-d))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=bg(r,a[1].length),r<0?"-"+Hr(e,t,-r):ms(UE(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?hn(0,3-x.length):"")+x})+"."+hn(i,a[1].length);switch(t){case"###,##0.00":return Hr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ms(Fa(l,0));return m!=="0"?c+m:"";case"###,###.00":return Hr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Hr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function $E(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function HE(e,t,r){var n=t.replace(bv,""),s=t.length-n.length;return Hn(e,n,r*Math.pow(10,2*s))+gt("%",s)}function jv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+jv(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Av)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sn("n",n,r):"("+Sn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $E(e,t,r);if(t.indexOf("%")!==-1)return HE(e,t,r);if(t.indexOf("E")!==-1)return jv(t,r);if(t.charCodeAt(0)===36)return"$"+Sn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+hn(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:lr(t.substr(0,t.length-s.length))+s;if(a=t.match(Nv))return ME(a,l,c);if(t.match(/^#+0+$/))return c+hn(l,t.length-t.indexOf("0"));if(a=t.match(Cv))return s=(""+r).replace(/^([^\.]+)$/,"$1."+lr(a[1])).replace(/\.$/,"."+lr(a[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+gt("0",lr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+ms(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sn(e,t,-r):ms(""+r)+"."+gt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Sn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ni(Sn(e,t.replace(/[\\-]/g,""),r)),i=0,ni(ni(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(Fv))return s=Sn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Bc(l,Math.pow(10,i)-1,!1),s=""+c,u=Hn("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Lc(o[2],i),u.length<a[4].length&&(u=lr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Bc(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Qh(o[1],i)+a[2]+"/"+a[3]+Lc(o[2],i):gt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:lr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,d=t.length-s.length-h;return lr(t.substr(0,h)+s+t.substr(t.length-d))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sn(e,t,-r):ms(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?hn(0,3-x.length):"")+x})+"."+hn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=ms(""+l);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return Sn(e,t.slice(0,t.lastIndexOf(".")),r)+lr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Hn(e,t,r){return(r|0)===r?Sn(e,t,r):Hr(e,t,r)}function WE(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ov=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ei(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Mc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Ov))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function zE(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",c,u,h,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Mc(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var m=e.charAt(++i),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Qs(t,r,e.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Qs(t,r),c==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(c==null&&(c=Qs(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(c!=null&&(g.v=c.H>=12?"下午":"上午"),g.t="T",i+=5,d="h"):(g.t="t",++i),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Ov)){if(c==null&&(c=Qs(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ei(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var v=0,w=0,y;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=d,l="h",v<1&&(v=1);break;case"s":(y=s[i].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[i].v.match(/[Hh]/)&&(v=1),v<2&&s[i].v.match(/[Mm]/)&&(v=2),v<3&&s[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var p="",_;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=IE(s[i].t.charCodeAt(0),s[i].v,c,w),s[i].t="t";break;case"n":case"?":for(_=i+1;s[_]!=null&&((o=s[_].t)==="?"||o==="D"||(o===" "||o==="t")&&s[_+1]!=null&&(s[_+1].t==="?"||s[_+1].t==="t"&&s[_+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[_].v==="/"||s[_].v===" "&&s[_+1]!=null&&s[_+1].t=="?"));)s[i].v+=s[_].v,s[_]={v:"",t:";"},++_;p+=s[i].v,i=_-1;break;case"G":s[i].t="t",s[i].v=la(t,r);break}var S="",E,k;if(p.length>0){p.charCodeAt(0)==40?(E=t<0&&p.charCodeAt(0)===45?-t:t,k=Hn("n",p,E)):(E=t<0&&n>1?-t:t,k=Hn("n",p,E),E<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),_=k.length-1;var C=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){C=i;break}var T=s.length;if(C===s.length&&k.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(_>=s[i].v.length-1?(_-=s[i].v.length,s[i].v=k.substr(_+1,s[i].v.length)):_<0?s[i].v="":(s[i].v=k.substr(0,_+1),_=-1),s[i].t="t",T=i);_>=0&&T<s.length&&(s[T].v=k.substr(0,_+1)+s[T].v)}else if(C!==s.length&&k.indexOf("E")===-1){for(_=k.indexOf(".")-1,i=C;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===C?s[i].v.indexOf(".")-1:s[i].v.length-1,S=s[i].v.substr(u+1);u>=0;--u)_>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(S=k.charAt(_--)+S);s[i].v=S,s[i].t="t",T=i}for(_>=0&&T<s.length&&(s[T].v=k.substr(0,_+1)+s[T].v),_=k.indexOf(".")+1,i=C;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==C)){for(u=s[i].v.indexOf(".")>-1&&i===C?s[i].v.indexOf(".")+1:0,S=s[i].v.substr(0,u);u<s[i].v.length;++u)_<k.length&&(S+=k.charAt(_++));s[i].v=S,s[i].t="t",T=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(E=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Hn(s[i].t,s[i].v,E),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var Tg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ng(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function VE(e,t){var r=WE(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Tg),o=r[1].match(Tg);return Ng(t,i)?[n,r[0]]:Ng(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function tn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Se)[e],n==null&&(n=r.table&&r.table[Sg[e]]||Se[Sg[e]]),n==null&&(n=NE[e]||"General");break}if(Mc(n,0))return la(t,r);t instanceof Date&&(t=Ev(t,r.date1904));var s=VE(n,t);if(Mc(s[1]))return la(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return zE(s[1],t,r,s[0])}function Wn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Se[r]==null){t<0&&(t=r);continue}if(Se[r]==e){t=r;break}}t<0&&(t=391)}return Se[t]=e,t}function w0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Wn(e[t],t)}function bi(){Se=TE()}var GE={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Pv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function KE(e){var t=typeof e=="number"?Se[e]:e;return t=t.replace(Pv,"(\\d+)"),new RegExp("^"+t+"$")}function XE(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(Pv)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":i=m;break;case"s":l=m;break;case"m":i>=0?o=m:s=m;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?u:c+"T"+u}var qE=function(){var e={};e.version="1.2.0";function t(){for(var k=0,C=new Array(256),T=0;T!=256;++T)k=T,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,C[T]=k;return typeof Int32Array<"u"?new Int32Array(C):C}var r=t();function n(k){var C=0,T=0,R=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)L[R]=k[R];for(R=0;R!=256;++R)for(T=k[R],C=256+R;C<4096;C+=256)T=L[C]=T>>>8^k[T&255];var D=[];for(R=1;R!=16;++R)D[R-1]=typeof Int32Array<"u"?L.subarray(R*256,R*256+256):L.slice(R*256,R*256+256);return D}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],u=s[5],h=s[6],d=s[7],m=s[8],x=s[9],g=s[10],v=s[11],w=s[12],y=s[13],p=s[14];function _(k,C){for(var T=C^-1,R=0,L=k.length;R<L;)T=T>>>8^r[(T^k.charCodeAt(R++))&255];return~T}function S(k,C){for(var T=C^-1,R=k.length-15,L=0;L<R;)T=p[k[L++]^T&255]^y[k[L++]^T>>8&255]^w[k[L++]^T>>16&255]^v[k[L++]^T>>>24]^g[k[L++]]^x[k[L++]]^m[k[L++]]^d[k[L++]]^h[k[L++]]^u[k[L++]]^c[k[L++]]^l[k[L++]]^o[k[L++]]^i[k[L++]]^a[k[L++]]^r[k[L++]];for(R+=15;L<R;)T=T>>>8^r[(T^k[L++])&255];return~T}function E(k,C){for(var T=C^-1,R=0,L=k.length,D=0,q=0;R<L;)D=k.charCodeAt(R++),D<128?T=T>>>8^r[(T^D)&255]:D<2048?(T=T>>>8^r[(T^(192|D>>6&31))&255],T=T>>>8^r[(T^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,q=k.charCodeAt(R++)&1023,T=T>>>8^r[(T^(240|D>>8&7))&255],T=T>>>8^r[(T^(128|D>>2&63))&255],T=T>>>8^r[(T^(128|q>>6&15|(D&3)<<4))&255],T=T>>>8^r[(T^(128|q&63))&255]):(T=T>>>8^r[(T^(224|D>>12&15))&255],T=T>>>8^r[(T^(128|D>>6&63))&255],T=T>>>8^r[(T^(128|D&63))&255]);return~T}return e.table=r,e.bstr=_,e.buf=S,e.str=E,e}(),_e=function(){var t={};t.version="1.2.1";function r(b,j){for(var A=b.split("/"),F=j.split("/"),P=0,I=0,V=Math.min(A.length,F.length);P<V;++P){if(I=A[P].length-F[P].length)return I;if(A[P]!=F[P])return A[P]<F[P]?-1:1}return A.length-F.length}function n(b){if(b.charAt(b.length-1)=="/")return b.slice(0,-1).indexOf("/")===-1?b:n(b.slice(0,-1));var j=b.lastIndexOf("/");return j===-1?b:b.slice(0,j+1)}function s(b){if(b.charAt(b.length-1)=="/")return s(b.slice(0,-1));var j=b.lastIndexOf("/");return j===-1?b:b.slice(j+1)}function a(b,j){typeof j=="string"&&(j=new Date(j));var A=j.getHours();A=A<<6|j.getMinutes(),A=A<<5|j.getSeconds()>>>1,b.write_shift(2,A);var F=j.getFullYear()-1980;F=F<<4|j.getMonth()+1,F=F<<5|j.getDate(),b.write_shift(2,F)}function i(b){var j=b.read_shift(2)&65535,A=b.read_shift(2)&65535,F=new Date,P=A&31;A>>>=5;var I=A&15;A>>>=4,F.setMilliseconds(0),F.setFullYear(A+1980),F.setMonth(I-1),F.setDate(P);var V=j&31;j>>>=5;var J=j&63;return j>>>=6,F.setHours(j),F.setMinutes(J),F.setSeconds(V<<1),F}function o(b){zt(b,0);for(var j={},A=0;b.l<=b.length-4;){var F=b.read_shift(2),P=b.read_shift(2),I=b.l+P,V={};switch(F){case 21589:A=b.read_shift(1),A&1&&(V.mtime=b.read_shift(4)),P>5&&(A&2&&(V.atime=b.read_shift(4)),A&4&&(V.ctime=b.read_shift(4))),V.mtime&&(V.mt=new Date(V.mtime*1e3));break}b.l=I,j[F]=V}return j}var l;function c(){return l||(l={})}function u(b,j){if(b[0]==80&&b[1]==75)return Dd(b,j);if((b[0]|32)==109&&(b[1]|32)==105)return Wy(b,j);if(b.length<512)throw new Error("CFB file size "+b.length+" < 512");var A=3,F=512,P=0,I=0,V=0,J=0,z=0,G=[],X=b.slice(0,512);zt(X,0);var le=h(X);switch(A=le[0],A){case 3:F=512;break;case 4:F=4096;break;case 0:if(le[1]==0)return Dd(b,j);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}F!==512&&(X=b.slice(0,F),zt(X,28));var pe=b.slice(0,F);d(X,A);var we=X.read_shift(4,"i");if(A===3&&we!==0)throw new Error("# Directory Sectors: Expected 0 saw "+we);X.l+=4,V=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),J=X.read_shift(4,"i"),P=X.read_shift(4,"i"),z=X.read_shift(4,"i"),I=X.read_shift(4,"i");for(var fe=-1,ve=0;ve<109&&(fe=X.read_shift(4,"i"),!(fe<0));++ve)G[ve]=fe;var Ae=m(b,F);v(z,I,Ae,F,G);var ot=y(Ae,V,G,F);ot[V].name="!Directory",P>0&&J!==q&&(ot[J].name="!MiniFAT"),ot[G[0]].name="!FAT",ot.fat_addrs=G,ot.ssz=F;var lt={},Xt=[],Ci=[],Ai=[];p(V,ot,Ae,Xt,P,lt,Ci,J),x(Ci,Ai,Xt),Xt.shift();var Fi={FileIndex:Ci,FullPaths:Ai};return j&&j.raw&&(Fi.raw={header:pe,sectors:Ae}),Fi}function h(b){if(b[b.l]==80&&b[b.l+1]==75)return[0,0];b.chk(oe,"Header Signature: "),b.l+=16;var j=b.read_shift(2,"u");return[b.read_shift(2,"u"),j]}function d(b,j){var A=9;switch(b.l+=2,A=b.read_shift(2)){case 9:if(j!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(j!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}b.chk("0600","Mini Sector Shift: "),b.chk("000000000000","Reserved: ")}function m(b,j){for(var A=Math.ceil(b.length/j)-1,F=[],P=1;P<A;++P)F[P-1]=b.slice(P*j,(P+1)*j);return F[A-1]=b.slice(A*j),F}function x(b,j,A){for(var F=0,P=0,I=0,V=0,J=0,z=A.length,G=[],X=[];F<z;++F)G[F]=X[F]=F,j[F]=A[F];for(;J<X.length;++J)F=X[J],P=b[F].L,I=b[F].R,V=b[F].C,G[F]===F&&(P!==-1&&G[P]!==P&&(G[F]=G[P]),I!==-1&&G[I]!==I&&(G[F]=G[I])),V!==-1&&(G[V]=F),P!==-1&&F!=G[F]&&(G[P]=G[F],X.lastIndexOf(P)<J&&X.push(P)),I!==-1&&F!=G[F]&&(G[I]=G[F],X.lastIndexOf(I)<J&&X.push(I));for(F=1;F<z;++F)G[F]===F&&(I!==-1&&G[I]!==I?G[F]=G[I]:P!==-1&&G[P]!==P&&(G[F]=G[P]));for(F=1;F<z;++F)if(b[F].type!==0){if(J=F,J!=G[J])do J=G[J],j[F]=j[J]+"/"+j[F];while(J!==0&&G[J]!==-1&&J!=G[J]);G[F]=-1}for(j[0]+="/",F=1;F<z;++F)b[F].type!==2&&(j[F]+="/")}function g(b,j,A){for(var F=b.start,P=b.size,I=[],V=F;A&&P>0&&V>=0;)I.push(j.slice(V*D,V*D+D)),P-=D,V=Gs(A,V*4);return I.length===0?Y(0):Bt(I).slice(0,b.size)}function v(b,j,A,F,P){var I=q;if(b===q){if(j!==0)throw new Error("DIFAT chain shorter than expected")}else if(b!==-1){var V=A[b],J=(F>>>2)-1;if(!V)return;for(var z=0;z<J&&(I=Gs(V,z*4))!==q;++z)P.push(I);v(Gs(V,F-4),j-1,A,F,P)}}function w(b,j,A,F,P){var I=[],V=[];P||(P=[]);var J=F-1,z=0,G=0;for(z=j;z>=0;){P[z]=!0,I[I.length]=z,V.push(b[z]);var X=A[Math.floor(z*4/F)];if(G=z*4&J,F<4+G)throw new Error("FAT boundary crossed: "+z+" 4 "+F);if(!b[X])break;z=Gs(b[X],G)}return{nodes:I,data:Bg([V])}}function y(b,j,A,F){var P=b.length,I=[],V=[],J=[],z=[],G=F-1,X=0,le=0,pe=0,we=0;for(X=0;X<P;++X)if(J=[],pe=X+j,pe>=P&&(pe-=P),!V[pe]){z=[];var fe=[];for(le=pe;le>=0;){fe[le]=!0,V[le]=!0,J[J.length]=le,z.push(b[le]);var ve=A[Math.floor(le*4/F)];if(we=le*4&G,F<4+we)throw new Error("FAT boundary crossed: "+le+" 4 "+F);if(!b[ve]||(le=Gs(b[ve],we),fe[le]))break}I[pe]={nodes:J,data:Bg([z])}}return I}function p(b,j,A,F,P,I,V,J){for(var z=0,G=F.length?2:0,X=j[b].data,le=0,pe=0,we;le<X.length;le+=128){var fe=X.slice(le,le+128);zt(fe,64),pe=fe.read_shift(2),we=sd(fe,0,pe-G),F.push(we);var ve={name:we,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},Ae=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Ae!==0&&(ve.ct=_(fe,fe.l-8));var ot=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);ot!==0&&(ve.mt=_(fe,fe.l-8)),ve.start=fe.read_shift(4,"i"),ve.size=fe.read_shift(4,"i"),ve.size<0&&ve.start<0&&(ve.size=ve.type=0,ve.start=q,ve.name=""),ve.type===5?(z=ve.start,P>0&&z!==q&&(j[z].name="!StreamData")):ve.size>=4096?(ve.storage="fat",j[ve.start]===void 0&&(j[ve.start]=w(A,ve.start,j.fat_addrs,j.ssz)),j[ve.start].name=ve.name,ve.content=j[ve.start].data.slice(0,ve.size)):(ve.storage="minifat",ve.size<0?ve.size=0:z!==q&&ve.start!==q&&j[z]&&(ve.content=g(ve,j[z].data,(j[J]||{}).data))),ve.content&&zt(ve.content,0),I[we]=ve,V.push(ve)}}function _(b,j){return new Date((Ar(b,j+4)/1e7*Math.pow(2,32)+Ar(b,j)/1e7-11644473600)*1e3)}function S(b,j){return c(),u(l.readFileSync(b),j)}function E(b,j){var A=j&&j.type;switch(A||Re&&Buffer.isBuffer(b)&&(A="buffer"),A||"base64"){case"file":return S(b,j);case"base64":return u(jr(Dr(b)),j);case"binary":return u(jr(b),j)}return u(b,j)}function k(b,j){var A=j||{},F=A.root||"Root Entry";if(b.FullPaths||(b.FullPaths=[]),b.FileIndex||(b.FileIndex=[]),b.FullPaths.length!==b.FileIndex.length)throw new Error("inconsistent CFB structure");b.FullPaths.length===0&&(b.FullPaths[0]=F+"/",b.FileIndex[0]={name:F,type:5}),A.CLSID&&(b.FileIndex[0].clsid=A.CLSID),C(b)}function C(b){var j="Sh33tJ5";if(!_e.find(b,"/"+j)){var A=Y(4);A[0]=55,A[1]=A[3]=50,A[2]=54,b.FileIndex.push({name:j,type:2,content:A,size:4,L:69,R:69,C:69}),b.FullPaths.push(b.FullPaths[0]+j),T(b)}}function T(b,j){k(b);for(var A=!1,F=!1,P=b.FullPaths.length-1;P>=0;--P){var I=b.FileIndex[P];switch(I.type){case 0:F?A=!0:(b.FileIndex.pop(),b.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(I.R*I.L*I.C)&&(A=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!j)){var V=new Date(1987,1,19),J=0,z=Object.create?Object.create(null):{},G=[];for(P=0;P<b.FullPaths.length;++P)z[b.FullPaths[P]]=!0,b.FileIndex[P].type!==0&&G.push([b.FullPaths[P],b.FileIndex[P]]);for(P=0;P<G.length;++P){var X=n(G[P][0]);F=z[X],F||(G.push([X,{name:s(X).replace("/",""),type:1,clsid:ee,ct:V,mt:V,content:null}]),z[X]=!0)}for(G.sort(function(we,fe){return r(we[0],fe[0])}),b.FullPaths=[],b.FileIndex=[],P=0;P<G.length;++P)b.FullPaths[P]=G[P][0],b.FileIndex[P]=G[P][1];for(P=0;P<G.length;++P){var le=b.FileIndex[P],pe=b.FullPaths[P];if(le.name=s(pe).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||ee,P===0)le.C=G.length>1?1:-1,le.size=0,le.type=5;else if(pe.slice(-1)=="/"){for(J=P+1;J<G.length&&n(b.FullPaths[J])!=pe;++J);for(le.C=J>=G.length?-1:J,J=P+1;J<G.length&&n(b.FullPaths[J])!=n(pe);++J);le.R=J>=G.length?-1:J,le.type=1}else n(b.FullPaths[P+1]||"")==n(pe)&&(le.R=P+1),le.type=2}}}function R(b,j){var A=j||{};if(A.fileType=="mad")return zy(b,A);switch(T(b),A.fileType){case"zip":return Ly(b,A)}var F=function(we){for(var fe=0,ve=0,Ae=0;Ae<we.FileIndex.length;++Ae){var ot=we.FileIndex[Ae];if(ot.content){var lt=ot.content.length;lt>0&&(lt<4096?fe+=lt+63>>6:ve+=lt+511>>9)}}for(var Xt=we.FullPaths.length+3>>2,Ci=fe+7>>3,Ai=fe+127>>7,Fi=Ci+ve+Xt+Ai,Bs=Fi+127>>7,C0=Bs<=109?0:Math.ceil((Bs-109)/127);Fi+Bs+C0+127>>7>Bs;)C0=++Bs<=109?0:Math.ceil((Bs-109)/127);var In=[1,C0,Bs,Ai,Xt,ve,fe,0];return we.FileIndex[0].size=fe<<6,In[7]=(we.FileIndex[0].start=In[0]+In[1]+In[2]+In[3]+In[4]+In[5])+(In[6]+7>>3),In}(b),P=Y(F[7]<<9),I=0,V=0;{for(I=0;I<8;++I)P.write_shift(1,W[I]);for(I=0;I<8;++I)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),I=0;I<3;++I)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,F[2]),P.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:q),P.write_shift(4,F[3]),P.write_shift(-4,F[1]?F[0]-1:q),P.write_shift(4,F[1]),I=0;I<109;++I)P.write_shift(-4,I<F[2]?F[1]+I:-1)}if(F[1])for(V=0;V<F[1];++V){for(;I<236+V*127;++I)P.write_shift(-4,I<F[2]?F[1]+I:-1);P.write_shift(-4,V===F[1]-1?q:V+1)}var J=function(we){for(V+=we;I<V-1;++I)P.write_shift(-4,I+1);we&&(++I,P.write_shift(-4,q))};for(V=I=0,V+=F[1];I<V;++I)P.write_shift(-4,ne.DIFSECT);for(V+=F[2];I<V;++I)P.write_shift(-4,ne.FATSECT);J(F[3]),J(F[4]);for(var z=0,G=0,X=b.FileIndex[0];z<b.FileIndex.length;++z)X=b.FileIndex[z],X.content&&(G=X.content.length,!(G<4096)&&(X.start=V,J(G+511>>9)));for(J(F[6]+7>>3);P.l&511;)P.write_shift(-4,ne.ENDOFCHAIN);for(V=I=0,z=0;z<b.FileIndex.length;++z)X=b.FileIndex[z],X.content&&(G=X.content.length,!(!G||G>=4096)&&(X.start=V,J(G+63>>6)));for(;P.l&511;)P.write_shift(-4,ne.ENDOFCHAIN);for(I=0;I<F[4]<<2;++I){var le=b.FullPaths[I];if(!le||le.length===0){for(z=0;z<17;++z)P.write_shift(4,0);for(z=0;z<3;++z)P.write_shift(4,-1);for(z=0;z<12;++z)P.write_shift(4,0);continue}X=b.FileIndex[I],I===0&&(X.start=X.size?X.start-1:q);var pe=I===0&&A.root||X.name;if(G=2*(pe.length+1),P.write_shift(64,pe,"utf16le"),P.write_shift(2,G),P.write_shift(1,X.type),P.write_shift(1,X.color),P.write_shift(-4,X.L),P.write_shift(-4,X.R),P.write_shift(-4,X.C),X.clsid)P.write_shift(16,X.clsid,"hex");else for(z=0;z<4;++z)P.write_shift(4,0);P.write_shift(4,X.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,X.start),P.write_shift(4,X.size),P.write_shift(4,0)}for(I=1;I<b.FileIndex.length;++I)if(X=b.FileIndex[I],X.size>=4096)if(P.l=X.start+1<<9,Re&&Buffer.isBuffer(X.content))X.content.copy(P,P.l,0,X.size),P.l+=X.size+511&-512;else{for(z=0;z<X.size;++z)P.write_shift(1,X.content[z]);for(;z&511;++z)P.write_shift(1,0)}for(I=1;I<b.FileIndex.length;++I)if(X=b.FileIndex[I],X.size>0&&X.size<4096)if(Re&&Buffer.isBuffer(X.content))X.content.copy(P,P.l,0,X.size),P.l+=X.size+63&-64;else{for(z=0;z<X.size;++z)P.write_shift(1,X.content[z]);for(;z&63;++z)P.write_shift(1,0)}if(Re)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}function L(b,j){var A=b.FullPaths.map(function(z){return z.toUpperCase()}),F=A.map(function(z){var G=z.split("/");return G[G.length-(z.slice(-1)=="/"?2:1)]}),P=!1;j.charCodeAt(0)===47?(P=!0,j=A[0].slice(0,-1)+j):P=j.indexOf("/")!==-1;var I=j.toUpperCase(),V=P===!0?A.indexOf(I):F.indexOf(I);if(V!==-1)return b.FileIndex[V];var J=!I.match(Qi);for(I=I.replace(fr,""),J&&(I=I.replace(Qi,"!")),V=0;V<A.length;++V)if((J?A[V].replace(Qi,"!"):A[V]).replace(fr,"")==I||(J?F[V].replace(Qi,"!"):F[V]).replace(fr,"")==I)return b.FileIndex[V];return null}var D=64,q=-2,oe="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(b,j,A){c();var F=R(b,A);l.writeFileSync(j,F)}function U(b){for(var j=new Array(b.length),A=0;A<b.length;++A)j[A]=String.fromCharCode(b[A]);return j.join("")}function re(b,j){var A=R(b,j);switch(j&&j.type||"buffer"){case"file":return c(),l.writeFileSync(j.filename,A),A;case"binary":return typeof A=="string"?A:U(A);case"base64":return $o(typeof A=="string"?A:U(A));case"buffer":if(Re)return Buffer.isBuffer(A)?A:Yn(A);case"array":return typeof A=="string"?jr(A):A}return A}var ge;function O(b){try{var j=b.InflateRaw,A=new j;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)ge=b;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function H(b,j){if(!ge)return Id(b,j);var A=ge.InflateRaw,F=new A,P=F._processChunk(b.slice(b.l),F._finishFlushFlag);return b.l+=F.bytesRead,P}function M(b){return ge?ge.deflateRawSync(b):Le(b)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(b){var j=(b<<1|b<<11)&139536|(b<<5|b<<15)&558144;return(j>>16|j>>8|j)&255}for(var ae=typeof Uint8Array<"u",se=ae?new Uint8Array(256):[],Ne=0;Ne<256;++Ne)se[Ne]=ue(Ne);function N(b,j){var A=se[b&255];return j<=8?A>>>8-j:(A=A<<8|se[b>>8&255],j<=16?A>>>16-j:(A=A<<8|se[b>>16&255],A>>>24-j))}function Ee(b,j){var A=j&7,F=j>>>3;return(b[F]|(A<=6?0:b[F+1]<<8))>>>A&3}function De(b,j){var A=j&7,F=j>>>3;return(b[F]|(A<=5?0:b[F+1]<<8))>>>A&7}function ze(b,j){var A=j&7,F=j>>>3;return(b[F]|(A<=4?0:b[F+1]<<8))>>>A&15}function Pe(b,j){var A=j&7,F=j>>>3;return(b[F]|(A<=3?0:b[F+1]<<8))>>>A&31}function xe(b,j){var A=j&7,F=j>>>3;return(b[F]|(A<=1?0:b[F+1]<<8))>>>A&127}function at(b,j,A){var F=j&7,P=j>>>3,I=(1<<A)-1,V=b[P]>>>F;return A<8-F||(V|=b[P+1]<<8-F,A<16-F)||(V|=b[P+2]<<16-F,A<24-F)||(V|=b[P+3]<<24-F),V&I}function mr(b,j,A){var F=j&7,P=j>>>3;return F<=5?b[P]|=(A&7)<<F:(b[P]|=A<<F&255,b[P+1]=(A&7)>>8-F),j+3}function ke(b,j,A){var F=j&7,P=j>>>3;return A=(A&1)<<F,b[P]|=A,j+1}function Ie(b,j,A){var F=j&7,P=j>>>3;return A<<=F,b[P]|=A&255,A>>>=8,b[P+1]=A,j+8}function Ve(b,j,A){var F=j&7,P=j>>>3;return A<<=F,b[P]|=A&255,A>>>=8,b[P+1]=A&255,b[P+2]=A>>>8,j+16}function Dt(b,j){var A=b.length,F=2*A>j?2*A:j+5,P=0;if(A>=j)return b;if(Re){var I=yg(F);if(b.copy)b.copy(I);else for(;P<b.length;++P)I[P]=b[P];return I}else if(ae){var V=new Uint8Array(F);if(V.set)V.set(b);else for(;P<A;++P)V[P]=b[P];return V}return b.length=F,b}function At(b){for(var j=new Array(b),A=0;A<b;++A)j[A]=0;return j}function nn(b,j,A){var F=1,P=0,I=0,V=0,J=0,z=b.length,G=ae?new Uint16Array(32):At(32);for(I=0;I<32;++I)G[I]=0;for(I=z;I<A;++I)b[I]=0;z=b.length;var X=ae?new Uint16Array(z):At(z);for(I=0;I<z;++I)G[P=b[I]]++,F<P&&(F=P),X[I]=0;for(G[0]=0,I=1;I<=F;++I)G[I+16]=J=J+G[I-1]<<1;for(I=0;I<z;++I)J=b[I],J!=0&&(X[I]=G[J+16]++);var le=0;for(I=0;I<z;++I)if(le=b[I],le!=0)for(J=N(X[I],F)>>F-le,V=(1<<F+4-le)-1;V>=0;--V)j[J|V<<le]=le&15|I<<4;return F}var wn=ae?new Uint16Array(512):At(512),gr=ae?new Uint16Array(32):At(32);if(!ae){for(var vt=0;vt<512;++vt)wn[vt]=0;for(vt=0;vt<32;++vt)gr[vt]=0}(function(){for(var b=[],j=0;j<32;j++)b.push(5);nn(b,gr,32);var A=[];for(j=0;j<=143;j++)A.push(8);for(;j<=255;j++)A.push(9);for(;j<=279;j++)A.push(7);for(;j<=287;j++)A.push(8);nn(A,wn,288)})();var Tr=function(){for(var j=ae?new Uint8Array(32768):[],A=0,F=0;A<ie.length-1;++A)for(;F<ie[A+1];++F)j[F]=A;for(;F<32768;++F)j[F]=29;var P=ae?new Uint8Array(259):[];for(A=0,F=0;A<Q.length-1;++A)for(;F<Q[A+1];++F)P[F]=A;function I(J,z){for(var G=0;G<J.length;){var X=Math.min(65535,J.length-G),le=G+X==J.length;for(z.write_shift(1,+le),z.write_shift(2,X),z.write_shift(2,~X&65535);X-- >0;)z[z.l++]=J[G++]}return z.l}function V(J,z){for(var G=0,X=0,le=ae?new Uint16Array(32768):[];X<J.length;){var pe=Math.min(65535,J.length-X);if(pe<10){for(G=mr(z,G,+(X+pe==J.length)),G&7&&(G+=8-(G&7)),z.l=G/8|0,z.write_shift(2,pe),z.write_shift(2,~pe&65535);pe-- >0;)z[z.l++]=J[X++];G=z.l*8;continue}G=mr(z,G,+(X+pe==J.length)+2);for(var we=0;pe-- >0;){var fe=J[X];we=(we<<5^fe)&32767;var ve=-1,Ae=0;if((ve=le[we])&&(ve|=X&-32768,ve>X&&(ve-=32768),ve<X))for(;J[ve+Ae]==J[X+Ae]&&Ae<250;)++Ae;if(Ae>2){fe=P[Ae],fe<=22?G=Ie(z,G,se[fe+1]>>1)-1:(Ie(z,G,3),G+=5,Ie(z,G,se[fe-23]>>5),G+=3);var ot=fe<8?0:fe-4>>2;ot>0&&(Ve(z,G,Ae-Q[fe]),G+=ot),fe=j[X-ve],G=Ie(z,G,se[fe]>>3),G-=3;var lt=fe<4?0:fe-2>>1;lt>0&&(Ve(z,G,X-ve-ie[fe]),G+=lt);for(var Xt=0;Xt<Ae;++Xt)le[we]=X&32767,we=(we<<5^J[X])&32767,++X;pe-=Ae-1}else fe<=143?fe=fe+48:G=ke(z,G,1),G=Ie(z,G,se[fe]),le[we]=X&32767,++X}G=Ie(z,G,0)-1}return z.l=(G+7)/8|0,z.l}return function(z,G){return z.length<8?I(z,G):V(z,G)}}();function Le(b){var j=Y(50+Math.floor(b.length*1.1)),A=Tr(b,j);return j.slice(0,A)}var wt=ae?new Uint16Array(32768):At(32768),Br=ae?new Uint16Array(32768):At(32768),Ft=ae?new Uint16Array(128):At(128),Ms=1,Pd=1;function Iy(b,j){var A=Pe(b,j)+257;j+=5;var F=Pe(b,j)+1;j+=5;var P=ze(b,j)+4;j+=4;for(var I=0,V=ae?new Uint8Array(19):At(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,G=ae?new Uint8Array(8):At(8),X=ae?new Uint8Array(8):At(8),le=V.length,pe=0;pe<P;++pe)V[B[pe]]=I=De(b,j),z<I&&(z=I),G[I]++,j+=3;var we=0;for(G[0]=0,pe=1;pe<=z;++pe)X[pe]=we=we+G[pe-1]<<1;for(pe=0;pe<le;++pe)(we=V[pe])!=0&&(J[pe]=X[we]++);var fe=0;for(pe=0;pe<le;++pe)if(fe=V[pe],fe!=0){we=se[J[pe]]>>8-fe;for(var ve=(1<<7-fe)-1;ve>=0;--ve)Ft[we|ve<<fe]=fe&7|pe<<3}var Ae=[];for(z=1;Ae.length<A+F;)switch(we=Ft[xe(b,j)],j+=we&7,we>>>=3){case 16:for(I=3+Ee(b,j),j+=2,we=Ae[Ae.length-1];I-- >0;)Ae.push(we);break;case 17:for(I=3+De(b,j),j+=3;I-- >0;)Ae.push(0);break;case 18:for(I=11+xe(b,j),j+=7;I-- >0;)Ae.push(0);break;default:Ae.push(we),z<we&&(z=we);break}var ot=Ae.slice(0,A),lt=Ae.slice(A);for(pe=A;pe<286;++pe)ot[pe]=0;for(pe=F;pe<30;++pe)lt[pe]=0;return Ms=nn(ot,wt,286),Pd=nn(lt,Br,30),j}function Ry(b,j){if(b[0]==3&&!(b[1]&3))return[Ns(j),2];for(var A=0,F=0,P=yg(j||1<<18),I=0,V=P.length>>>0,J=0,z=0;!(F&1);){if(F=De(b,A),A+=3,F>>>1)F>>1==1?(J=9,z=5):(A=Iy(b,A),J=Ms,z=Pd);else{A&7&&(A+=8-(A&7));var G=b[A>>>3]|b[(A>>>3)+1]<<8;if(A+=32,G>0)for(!j&&V<I+G&&(P=Dt(P,I+G),V=P.length);G-- >0;)P[I++]=b[A>>>3],A+=8;continue}for(;;){!j&&V<I+32767&&(P=Dt(P,I+32767),V=P.length);var X=at(b,A,J),le=F>>>1==1?wn[X]:wt[X];if(A+=le&15,le>>>=4,!(le>>>8&255))P[I++]=le;else{if(le==256)break;le-=257;var pe=le<8?0:le-4>>2;pe>5&&(pe=0);var we=I+Q[le];pe>0&&(we+=at(b,A,pe),A+=pe),X=at(b,A,z),le=F>>>1==1?gr[X]:Br[X],A+=le&15,le>>>=4;var fe=le<4?0:le-2>>1,ve=ie[le];for(fe>0&&(ve+=at(b,A,fe),A+=fe),!j&&V<we&&(P=Dt(P,we+100),V=P.length);I<we;)P[I]=P[I-ve],++I}}}return j?[P,A+7>>>3]:[P.slice(0,I),A+7>>>3]}function Id(b,j){var A=b.slice(b.l||0),F=Ry(A,j);return b.l+=F[1],F[0]}function Rd(b,j){if(b)typeof console<"u"&&console.error(j);else throw new Error(j)}function Dd(b,j){var A=b;zt(A,0);var F=[],P=[],I={FileIndex:F,FullPaths:P};k(I,{root:j.root});for(var V=A.length-4;(A[V]!=80||A[V+1]!=75||A[V+2]!=5||A[V+3]!=6)&&V>=0;)--V;A.l=V+4,A.l+=4;var J=A.read_shift(2);A.l+=6;var z=A.read_shift(4);for(A.l=z,V=0;V<J;++V){A.l+=20;var G=A.read_shift(4),X=A.read_shift(4),le=A.read_shift(2),pe=A.read_shift(2),we=A.read_shift(2);A.l+=8;var fe=A.read_shift(4),ve=o(A.slice(A.l+le,A.l+le+pe));A.l+=le+pe+we;var Ae=A.l;A.l=fe+4,Dy(A,G,X,I,ve),A.l=Ae}return I}function Dy(b,j,A,F,P){b.l+=2;var I=b.read_shift(2),V=b.read_shift(2),J=i(b);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var z=b.read_shift(4),G=b.read_shift(4),X=b.read_shift(4),le=b.read_shift(2),pe=b.read_shift(2),we="",fe=0;fe<le;++fe)we+=String.fromCharCode(b[b.l++]);if(pe){var ve=o(b.slice(b.l,b.l+pe));(ve[21589]||{}).mt&&(J=ve[21589].mt),((P||{})[21589]||{}).mt&&(J=P[21589].mt)}b.l+=pe;var Ae=b.slice(b.l,b.l+G);switch(V){case 8:Ae=H(b,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+V)}var ot=!1;I&8&&(z=b.read_shift(4),z==134695760&&(z=b.read_shift(4),ot=!0),G=b.read_shift(4),X=b.read_shift(4)),G!=j&&Rd(ot,"Bad compressed size: "+j+" != "+G),X!=A&&Rd(ot,"Bad uncompressed size: "+A+" != "+X),N0(F,we,Ae,{unsafe:!0,mt:J})}function Ly(b,j){var A=j||{},F=[],P=[],I=Y(1),V=A.compression?8:0,J=0,z=0,G=0,X=0,le=0,pe=b.FullPaths[0],we=pe,fe=b.FileIndex[0],ve=[],Ae=0;for(z=1;z<b.FullPaths.length;++z)if(we=b.FullPaths[z].slice(pe.length),fe=b.FileIndex[z],!(!fe.size||!fe.content||we=="Sh33tJ5")){var ot=X,lt=Y(we.length);for(G=0;G<we.length;++G)lt.write_shift(1,we.charCodeAt(G)&127);lt=lt.slice(0,lt.l),ve[le]=qE.buf(fe.content,0);var Xt=fe.content;V==8&&(Xt=M(Xt)),I=Y(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,J),I.write_shift(2,V),fe.mt?a(I,fe.mt):I.write_shift(4,0),I.write_shift(-4,ve[le]),I.write_shift(4,Xt.length),I.write_shift(4,fe.content.length),I.write_shift(2,lt.length),I.write_shift(2,0),X+=I.length,F.push(I),X+=lt.length,F.push(lt),X+=Xt.length,F.push(Xt),I=Y(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,J),I.write_shift(2,V),I.write_shift(4,0),I.write_shift(-4,ve[le]),I.write_shift(4,Xt.length),I.write_shift(4,fe.content.length),I.write_shift(2,lt.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,ot),Ae+=I.l,P.push(I),Ae+=lt.length,P.push(lt),++le}return I=Y(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,le),I.write_shift(2,le),I.write_shift(4,Ae),I.write_shift(4,X),I.write_shift(2,0),Bt([Bt(F),Bt(P),I])}var xl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function My(b,j){if(b.ctype)return b.ctype;var A=b.name||"",F=A.match(/\.([^\.]+)$/);return F&&xl[F[1]]||j&&(F=(A=j).match(/[\.\\]([^\.\\])+$/),F&&xl[F[1]])?xl[F[1]]:"application/octet-stream"}function By(b){for(var j=$o(b),A=[],F=0;F<j.length;F+=76)A.push(j.slice(F,F+76));return A.join(`\r
`)+`\r
`}function Uy(b){var j=b.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(G){var X=G.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});j=j.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),j.charAt(0)==`
`&&(j="=0D"+j.slice(1)),j=j.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],F=j.split(`\r
`),P=0;P<F.length;++P){var I=F[P];if(I.length==0){A.push("");continue}for(var V=0;V<I.length;){var J=76,z=I.slice(V,V+J);z.charAt(J-1)=="="?J--:z.charAt(J-2)=="="?J-=2:z.charAt(J-3)=="="&&(J-=3),z=I.slice(V,V+J),V+=J,V<I.length&&(z+="="),A.push(z)}}return A.join(`\r
`)}function $y(b){for(var j=[],A=0;A<b.length;++A){for(var F=b[A];A<=b.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+b[++A];j.push(F)}for(var P=0;P<j.length;++P)j[P]=j[P].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return jr(j.join(`\r
`))}function Hy(b,j,A){for(var F="",P="",I="",V,J=0;J<10;++J){var z=j[J];if(!z||z.match(/^\s*$/))break;var G=z.match(/^(.*?):\s*([^\s].*)$/);if(G)switch(G[1].toLowerCase()){case"content-location":F=G[2].trim();break;case"content-type":I=G[2].trim();break;case"content-transfer-encoding":P=G[2].trim();break}}switch(++J,P.toLowerCase()){case"base64":V=jr(Dr(j.slice(J).join("")));break;case"quoted-printable":V=$y(j.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var X=N0(b,F.slice(A.length),V,{unsafe:!0});I&&(X.ctype=I)}function Wy(b,j){if(U(b.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=j&&j.root||"",F=(Re&&Buffer.isBuffer(b)?b.toString("binary"):U(b)).split(`\r
`),P=0,I="";for(P=0;P<F.length;++P)if(I=F[P],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),A||(A=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),I.slice(0,A.length)!=A););var V=(F[1]||"").match(/boundary="(.*?)"/);if(!V)throw new Error("MAD cannot find boundary");var J="--"+(V[1]||""),z=[],G=[],X={FileIndex:z,FullPaths:G};k(X);var le,pe=0;for(P=0;P<F.length;++P){var we=F[P];we!==J&&we!==J+"--"||(pe++&&Hy(X,F.slice(le,P),A),le=P)}return X}function zy(b,j){var A=j||{},F=A.boundary||"SheetJS";F="------="+F;for(var P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],I=b.FullPaths[0],V=I,J=b.FileIndex[0],z=1;z<b.FullPaths.length;++z)if(V=b.FullPaths[z].slice(I.length),J=b.FileIndex[z],!(!J.size||!J.content||V=="Sh33tJ5")){V=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ae){return"_x"+Ae.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ae){return"_u"+Ae.charCodeAt(0).toString(16)+"_"});for(var G=J.content,X=Re&&Buffer.isBuffer(G)?G.toString("binary"):U(G),le=0,pe=Math.min(1024,X.length),we=0,fe=0;fe<=pe;++fe)(we=X.charCodeAt(fe))>=32&&we<128&&++le;var ve=le>=pe*4/5;P.push(F),P.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+V),P.push("Content-Transfer-Encoding: "+(ve?"quoted-printable":"base64")),P.push("Content-Type: "+My(J,V)),P.push(""),P.push(ve?Uy(X):By(X))}return P.push(F+`--\r
`),P.join(`\r
`)}function Vy(b){var j={};return k(j,b),j}function N0(b,j,A,F){var P=F&&F.unsafe;P||k(b);var I=!P&&_e.find(b,j);if(!I){var V=b.FullPaths[0];j.slice(0,V.length)==V?V=j:(V.slice(-1)!="/"&&(V+="/"),V=(V+j).replace("//","/")),I={name:s(j),type:2},b.FileIndex.push(I),b.FullPaths.push(V),P||_e.utils.cfb_gc(b)}return I.content=A,I.size=A?A.length:0,F&&(F.CLSID&&(I.clsid=F.CLSID),F.mt&&(I.mt=F.mt),F.ct&&(I.ct=F.ct)),I}function Gy(b,j){k(b);var A=_e.find(b,j);if(A){for(var F=0;F<b.FileIndex.length;++F)if(b.FileIndex[F]==A)return b.FileIndex.splice(F,1),b.FullPaths.splice(F,1),!0}return!1}function Ky(b,j,A){k(b);var F=_e.find(b,j);if(F){for(var P=0;P<b.FileIndex.length;++P)if(b.FileIndex[P]==F)return b.FileIndex[P].name=s(A),b.FullPaths[P]=A,!0}return!1}function Xy(b){T(b,!0)}return t.find=L,t.read=E,t.parse=u,t.write=re,t.writeFile=Z,t.utils={cfb_new:Vy,cfb_add:N0,cfb_del:Gy,cfb_mov:Ky,cfb_gc:Xy,ReadShift:ho,CheckField:rw,prep_blob:zt,bconcat:Bt,use_zlib:O,_deflateRaw:Le,_inflateRaw:Id,consts:ne},t}();function QE(e){return typeof e=="string"?v0(e):Array.isArray(e)?kE(e):e}function cl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=v0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Cn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([QE(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Rs(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function YE(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function xt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Cg(e,t){for(var r=[],n=xt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function y0(e){for(var t=[],r=xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function _0(e){for(var t=[],r=xt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function JE(e){for(var t=[],r=xt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Uc=new Date(1899,11,30,0,0,0);function Rt(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Uc.getTime()+(e.getTimezoneOffset()-Uc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Iv=new Date,ZE=Uc.getTime()+(Iv.getTimezoneOffset()-Uc.getTimezoneOffset())*6e4,Ag=Iv.getTimezoneOffset();function k0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ZE),t.getTimezoneOffset()!==Ag&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Ag)*6e4),t}function eb(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var Fg=new Date("2017-02-19T19:06:09.000Z"),Rv=isNaN(Fg.getFullYear())?new Date("2/19/17"):Fg,tb=Rv.getFullYear()==2017;function nt(e,t){var r=new Date(e);if(tb)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Rv.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ca(e,t){if(Re&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cn(kv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function st(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=st(e[r]));return t}function gt(e,t){for(var r="";r.length<t;)r+=e;return r}function pn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var rb=["january","february","march","april","may","june","july","august","september","october","november","december"];function pi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&rb.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var nb=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function Dv(e){return e?e.content&&e.type?ca(e.content,!0):e.data?qi(e.data):e.asNodeBuffer&&Re?qi(e.asNodeBuffer().toString("binary")):e.asBinary?qi(e.asBinary()):e._data&&e._data.getContent?qi(ca(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Lv(e){if(!e)return null;if(e.data)return vg(e.data);if(e.asNodeBuffer&&Re)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?vg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function sb(e){return e&&e.name.slice(-4)===".bin"?Lv(e):Dv(e)}function Vr(e,t){for(var r=e.FullPaths||xt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Jh(e,t){var r=Vr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function bt(e,t,r){if(!r)return sb(Jh(e,t));if(!t)return null;try{return bt(e,t)}catch{return null}}function Or(e,t,r){if(!r)return Dv(Jh(e,t));if(!t)return null;try{return Or(e,t)}catch{return null}}function Mv(e,t,r){if(!r)return Lv(Jh(e,t));if(!t)return null;try{return Mv(e,t)}catch{return null}}function jg(e){for(var t=e.FullPaths||xt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Oe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Re?n=Yn(r):n=SE(r),_e.utils.cfb_add(e,t,n)}_e.utils.cfb_add(e,t,r)}else e.file(t,r)}function Zh(){return _e.utils.cfb_new()}function Bv(e,t){switch(t.type){case"base64":return _e.read(e,{type:"base64"});case"binary":return _e.read(e,{type:"binary"});case"buffer":case"array":return _e.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Yi(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var St=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ab=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Og=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ib=/<[^>]*>/g,ir=St.match(Og)?Og:ib,ob=/<\w*:/,lb=/<(\/?)\w+:/;function Te(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(ab),o=0,l="",c=0,u="",h="",d=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(u=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(d=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var m=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[m]&&u.slice(o-3,o)=="ext")continue;n[m]=l,r||(n[m.toLowerCase()]=l)}}return n}function On(e){return e.replace(lb,"<$1")}var Uv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ed=y0(Uv),He=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return Uv[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),td=/[&<>'"]/g,cb=/[\u0000-\u0008\u000b-\u001f]/g;function qe(e){var t=e+"";return t.replace(td,function(r){return ed[r]}).replace(cb,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Pg(e){return qe(e).replace(/ /g,"_x0020_")}var $v=/[\u0000-\u001f]/g;function rd(e){var t=e+"";return t.replace(td,function(r){return ed[r]}).replace(/\n/g,"<br/>").replace($v,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function ub(e){var t=e+"";return t.replace(td,function(r){return ed[r]}).replace($v,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Ig=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function fb(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function tt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hu(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Rg(e){var t=Ns(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Dg(e){return Yn(e,"binary").toString("utf8")}var Bl="foo bar bazâð£",Ye=Re&&(Dg(Bl)==hu(Bl)&&Dg||Rg(Bl)==hu(Bl)&&Rg)||hu,Cn=Re?function(e){return Yn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Wo=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Hv=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),hb=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),db=/<\/?(?:vt:)?variant>/g,mb=/<(?:vt:)([^>]*)>([\s\S]*)</;function Lg(e,t){var r=Te(e),n=e.match(hb(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(db,"").match(mb);i&&s.push({v:Ye(i[2]),t:i[1]})}),s}var Wv=/(^\s|\s$|\n)/;function Vt(e,t){return"<"+e+(t.match(Wv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function zo(e){return xt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function de(e,t,r){return"<"+e+(r!=null?zo(r):"")+(t!=null?(t.match(Wv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Pf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function gb(e,t){switch(typeof e){case"string":var r=de("vt:lpwstr",qe(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return de((e|0)==e?"vt:i4":"vt:r8",qe(String(e)));case"boolean":return de("vt:bool",e?"true":"false")}if(e instanceof Date)return de("vt:filetime",Pf(e));throw new Error("Unable to serialize "+e)}function nd(e){if(Re&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ye(Rs(qh(e)));throw new Error("Bad input format: expected Buffer or string")}var Vo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Pt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},va=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Cr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function pb(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function xb(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var Mg=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Bg=Re?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Yn(t)})):Mg(e)}:Mg,Ug=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Un(e,s)));return n.join("").replace(fr,"")},sd=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(fr,""):Ug(e,t,r)}:Ug,$g=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},zv=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$g(e,t,r)}:$g,Hg=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Da(e,s)));return n.join("")},ul=Re?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Hg(t,r,n)}:Hg,Vv=function(e,t){var r=Ar(e,t);return r>0?ul(e,t+4,t+4+r-1):""},Gv=Vv,Kv=function(e,t){var r=Ar(e,t);return r>0?ul(e,t+4,t+4+r-1):""},Xv=Kv,qv=function(e,t){var r=2*Ar(e,t);return r>0?ul(e,t+4,t+4+r-1):""},Qv=qv,Yv=function(t,r){var n=Ar(t,r);return n>0?sd(t,r+4,r+4+n):""},Jv=Yv,Zv=function(e,t){var r=Ar(e,t);return r>0?ul(e,t+4,t+4+r):""},ew=Zv,tw=function(e,t){return pb(e,t)},$c=tw,ad=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Re&&(Gv=function(t,r){if(!Buffer.isBuffer(t))return Vv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Xv=function(t,r){if(!Buffer.isBuffer(t))return Kv(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Qv=function(t,r){if(!Buffer.isBuffer(t))return qv(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Jv=function(t,r){if(!Buffer.isBuffer(t))return Yv(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},ew=function(t,r){if(!Buffer.isBuffer(t))return Zv(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},$c=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):tw(t,r)},ad=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Da=function(e,t){return e[t]},Un=function(e,t){return e[t+1]*256+e[t]},vb=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ar=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Gs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},wb=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ho(e,t){var r="",n,s,a=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Re&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Un(this,c)),c+=2;e*=2;break;case"utf8":r=ul(this,this.l,this.l+e);break;case"utf16le":e*=2,r=sd(this,this.l,this.l+e);break;case"wstr":return ho.call(this,e,"dbcs");case"lpstr-ansi":r=Gv(this,this.l),e=4+Ar(this,this.l);break;case"lpstr-cp":r=Xv(this,this.l),e=4+Ar(this,this.l);break;case"lpwstr":r=Qv(this,this.l),e=4+2*Ar(this,this.l);break;case"lpp4":e=4+Ar(this,this.l),r=Jv(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ar(this,this.l),r=ew(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Da(this,this.l+e++))!==0;)a.push(Ml(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Un(this,this.l+e))!==0;)a.push(Ml(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Da(this,c),this.l=c+1,o=ho.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Ml(Un(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Da(this,c),this.l=c+1,o=ho.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Ml(Da(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=Da(this,this.l),this.l++,n;case 2:return n=(t==="i"?vb:Un)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Gs:wb)(this,this.l),this.l+=4,n):(s=Ar(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=$c(this,this.l):s=$c([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=zv(this,this.l,e);break}}return this.l+=e,r}var yb=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},_b=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},kb=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Sb(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)kb(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,yb(this,t,this.l);break;case 8:if(n=8,r==="f"){xb(this,t,this.l);break}case 16:break;case-4:n=4,_b(this,t,this.l);break}return this.l+=n,this}function rw(e,t){var r=zv(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function zt(e,t){e.l=t,e.read_shift=ho,e.chk=rw,e.write_shift=Sb}function ar(e,t){e.l+=t}function Y(e){var t=Ns(e);return zt(t,0),t}function Jn(e,t,r){if(e){var n,s,a;zt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Yo[o]||Yo[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var u=c.f&&c.f(e,a,r);if(e.l=l,t(u,c,o))return}}}function Er(){var e=[],t=Re?256:2048,r=function(c){var u=Y(c);return zt(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},i=function(){return s(),Bt(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function te(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=Yo[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&ad(r)&&e.push(r)}}function mo(e,t,r){var n=st(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Wg(e,t,r){var n=st(e);return n.s=mo(n.s,t.s,r),n.e=mo(n.e,t.s,r),n}function go(e,t){if(e.cRel&&e.c<0)for(e=st(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=st(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=be(e);return!e.cRel&&e.cRel!=null&&(r=Tb(r)),!e.rRel&&e.rRel!=null&&(r=Eb(r)),r}function du(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ut(e.s.c)+":"+(e.e.cRel?"":"$")+ut(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kt(e.s.r)+":"+(e.e.rRel?"":"$")+kt(e.e.r):go(e.s,t.biff)+":"+go(e.e,t.biff)}function id(e){return parseInt(bb(e),10)-1}function kt(e){return""+(e+1)}function Eb(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function bb(e){return e.replace(/\$(\d+)$/,"$1")}function od(e){for(var t=Nb(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ut(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Tb(e){return e.replace(/^([A-Z])/,"$$$1")}function Nb(e){return e.replace(/^\$([A-Z])/,"$1")}function Cb(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ft(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function br(e){var t=e.indexOf(":");return t==-1?{s:ft(e),e:ft(e)}:{s:ft(e.slice(0,t)),e:ft(e.slice(t+1))}}function je(e,t){return typeof t>"u"||typeof t=="number"?je(e.s,e.e):(typeof e!="string"&&(e=be(e)),typeof t!="string"&&(t=be(t)),e==t?e:e+":"+t)}function We(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function zg(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=tn(e.z,r?Rt(t):t)}catch{}try{return e.w=tn((e.XF||{}).numFmtId||(r?14:0),r?Rt(t):t)}catch{return""+t}}function qn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Zn[e.v]||e.v:t==null?zg(e,e.v):zg(e,t))}function Ds(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function nw(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=We(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var m={v:t[h][d]},x=i+h,g=o+d;if(c.s.r>x&&(c.s.r=x),c.s.c>g&&(c.s.c=g),c.e.r<x&&(c.e.r=x),c.e.c<g&&(c.e.c=g),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))m=t[h][d];else if(Array.isArray(m.v)&&(m.f=t[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Se[14],n.cellDates?(m.t="d",m.w=tn(m.z,Rt(m.v))):(m.t="n",m.v=Rt(m.v),m.w=tn(m.z,m.v))):m.t="s";if(s)a[x]||(a[x]=[]),a[x][g]&&a[x][g].z&&(m.z=a[x][g].z),a[x][g]=m;else{var v=be({c:g,r:x});a[v]&&a[v].z&&(m.z=a[v].z),a[v]=m}}}return c.s.c<1e7&&(a["!ref"]=je(c)),a}function Ti(e,t){return nw(null,e,t)}function Ab(e){return e.read_shift(4,"i")}function xn(e,t){return t||(t=Y(4)),t.write_shift(4,e),t}function nr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ut(e,t){var r=!1;return t==null&&(r=!0,t=Y(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Fb(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function jb(e,t){return t||(t=Y(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function ld(e,t){var r=e.l,n=e.read_shift(1),s=nr(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(Fb(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function Ob(e,t){var r=!1;return t==null&&(r=!0,t=Y(15+4*e.t.length)),t.write_shift(1,0),Ut(e.t,t),r?t.slice(0,t.l):t}var Pb=ld;function Ib(e,t){var r=!1;return t==null&&(r=!0,t=Y(23+4*e.t.length)),t.write_shift(1,1),Ut(e.t,t),t.write_shift(4,1),jb({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function rn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function wa(e,t){return t==null&&(t=Y(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ya(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function _a(e,t){return t==null&&(t=Y(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Rb=nr,sw=Ut;function cd(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Hc(e,t){var r=!1;return t==null&&(r=!0,t=Y(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Db=nr,If=cd,ud=Hc;function fd(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?$c([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Gs(t,0)>>2;return r?s/100:s}function aw(e,t){t==null&&(t=Y(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function iw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Lb(e,t){return t||(t=Y(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ka=iw,Ni=Lb;function rr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ua(e,t){return(t||Y(8)).write_shift(8,e,"f")}function Mb(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Zs[s];c&&(t.rgb=Ko(c));break;case 2:t.rgb=Ko([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Wc(e,t){if(t||(t=Y(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Bb(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Ub(e,t){t||(t=Y(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function ow(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function $b(e){return ow(e,1)}function Hb(e){return ow(e,2)}var hd=2,xr=3,Ul=11,Vg=12,zc=19,$l=64,Wb=65,zb=71,Vb=4108,Gb=4126,Lt=80,lw=81,Kb=[Lt,lw],Rf={1:{n:"CodePage",t:hd},2:{n:"Category",t:Lt},3:{n:"PresentationFormat",t:Lt},4:{n:"ByteCount",t:xr},5:{n:"LineCount",t:xr},6:{n:"ParagraphCount",t:xr},7:{n:"SlideCount",t:xr},8:{n:"NoteCount",t:xr},9:{n:"HiddenCount",t:xr},10:{n:"MultimediaClipCount",t:xr},11:{n:"ScaleCrop",t:Ul},12:{n:"HeadingPairs",t:Vb},13:{n:"TitlesOfParts",t:Gb},14:{n:"Manager",t:Lt},15:{n:"Company",t:Lt},16:{n:"LinksUpToDate",t:Ul},17:{n:"CharacterCount",t:xr},19:{n:"SharedDoc",t:Ul},22:{n:"HyperlinksChanged",t:Ul},23:{n:"AppVersion",t:xr,p:"version"},24:{n:"DigSig",t:Wb},26:{n:"ContentType",t:Lt},27:{n:"ContentStatus",t:Lt},28:{n:"Language",t:Lt},29:{n:"Version",t:Lt},255:{},2147483648:{n:"Locale",t:zc},2147483651:{n:"Behavior",t:zc},1919054434:{}},Df={1:{n:"CodePage",t:hd},2:{n:"Title",t:Lt},3:{n:"Subject",t:Lt},4:{n:"Author",t:Lt},5:{n:"Keywords",t:Lt},6:{n:"Comments",t:Lt},7:{n:"Template",t:Lt},8:{n:"LastAuthor",t:Lt},9:{n:"RevNumber",t:Lt},10:{n:"EditTime",t:$l},11:{n:"LastPrinted",t:$l},12:{n:"CreatedDate",t:$l},13:{n:"ModifiedDate",t:$l},14:{n:"PageCount",t:xr},15:{n:"WordCount",t:xr},16:{n:"CharCount",t:xr},17:{n:"Thumbnail",t:zb},18:{n:"Application",t:Lt},19:{n:"DocSecurity",t:xr},255:{},2147483648:{n:"Locale",t:zc},2147483651:{n:"Behavior",t:zc},1919054434:{}},Gg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Xb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function qb(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Qb=qb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zs=st(Qb),Zn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Lf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Yb(e){var t=dd();if(!e||!e.match)return t;var r={};if((e.match(ir)||[]).forEach(function(n){var s=Te(n);switch(s[0].replace(ob,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Lf[s.ContentType]]!==void 0&&t[Lf[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Pt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function uw(e,t){var r=JE(Lf),n=[],s;n[n.length]=St,n[n.length]=de("Types",null,{xmlns:Pt.CT,"xmlns:xsd":Pt.xsd,"xmlns:xsi":Pt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return de("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(s=e[l][0],n[n.length]=de("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Hl[l][t.bookType]||Hl[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){n[n.length]=de("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Hl[l][t.bookType]||Hl[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=de("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Be={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Go(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function po(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ir)||[]).forEach(function(s){var a=Te(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Yi(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function si(e){var t=[St,de("Relationships",null,{xmlns:Pt.RELS})];return xt(e["!id"]).forEach(function(r){t[t.length]=de("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Xe(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,a?s.TargetMode=a:[Be.HLINK,Be.XPATH,Be.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Jb="application/vnd.oasis.opendocument.spreadsheet";function Zb(e,t){for(var r=nd(e),n,s;n=Vo.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Te(n[0],!1),s.path=="/"&&s.type!==Jb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function eT(e){var t=[St];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Kg(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function tT(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function rT(e){var t=[St];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Kg(e[r][0],e[r][1])),t.push(tT("",e[r][0]));return t.push(Kg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function fw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dc.version+"</meta:generator></office:meta></office:document-meta>"}var Yr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],nT=function(){for(var e=new Array(Yr.length),t=0;t<Yr.length;++t){var r=Yr[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function hw(e){var t={};e=Ye(e);for(var r=0;r<Yr.length;++r){var n=Yr[r],s=e.match(nT[r]);s!=null&&s.length>0&&(t[n[1]]=He(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=nt(t[n[1]]))}return t}function mu(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=qe(t),n[n.length]=r?de(e,t,r):Vt(e,t))}function dw(e,t){var r=t||{},n=[St,de("cp:coreProperties",null,{"xmlns:cp":Pt.CORE_PROPS,"xmlns:dc":Pt.dc,"xmlns:dcterms":Pt.dcterms,"xmlns:dcmitype":Pt.dcmitype,"xmlns:xsi":Pt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&mu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Pf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&mu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Pf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Yr.length;++a){var i=Yr[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&mu(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ea=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],mw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function gw(e,t,r,n){var s=[];if(typeof e=="string")s=Lg(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(u){return{v:u}}));var i=typeof t=="string"?Lg(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function sT(e,t,r){var n={};return t||(t={}),e=Ye(e),ea.forEach(function(s){var a=(e.match(Wo(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=He(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&gw(n.HeadingPairs,n.TitlesOfParts,t,r),t}function pw(e){var t=[],r=de;return e||(e={}),e.Application="SheetJS",t[t.length]=St,t[t.length]=de("Properties",null,{xmlns:Pt.EXT_PROPS,"xmlns:vt":Pt.vt}),ea.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=qe(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+qe(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var aT=/<[^>]+>[^<]*/g;function iT(e,t){var r={},n="",s=e.match(aT);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Te(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=He(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=He(u);break;case"bool":r[n]=tt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=nt(u);break;case"cy":case"error":r[n]=He(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function xw(e){var t=[St,de("Properties",null,{xmlns:Pt.CUST_PROPS,"xmlns:vt":Pt.vt})];if(!e)return t.join("");var r=1;return xt(e).forEach(function(s){++r,t[t.length]=de("property",gb(e[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:qe(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Mf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gu;function oT(e,t,r){gu||(gu=y0(Mf)),t=gu[t]||t,e[t]=r}function lT(e,t){var r=[];return xt(Mf).map(function(n){for(var s=0;s<Yr.length;++s)if(Yr[s][1]==n)return Yr[s];for(s=0;s<ea.length;++s)if(ea[s][1]==n)return ea[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Vt(Mf[n[1]]||n[1],s))}}),de("DocumentProperties",r.join(""),{xmlns:Cr.o})}function cT(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&xt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Yr.length;++i)if(a==Yr[i][1])return;for(i=0;i<ea.length;++i)if(a==ea[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(de(Pg(a),o,{"dt:dt":l}))}}),t&&xt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(de(Pg(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Cr.o+'">'+s.join("")+"</"+n+">"}function md(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function uT(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=Y(8);return i.write_shift(4,n),i.write_shift(4,s),i}function vw(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function ww(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function yw(e,t,r){return t===31?ww(e):vw(e,t,r)}function Bf(e,t,r){return yw(e,t,r===!1?0:4)}function fT(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yw(e,t,0)}function hT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(fr,""),e.l-s&2&&(e.l+=2)}return r}function dT(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(fr,"");return r}function mT(e){var t=e.l,r=Vc(e,lw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Vc(e,xr);return[r,n]}function gT(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(mT(e));return r}function Xg(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(fr,"").replace(Qi,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function _w(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function pT(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vc(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==Vg&&n!==t&&Kb.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Vg?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return vw(e,n,4).replace(fr,"");case 31:return ww(e);case 64:return md(e);case 65:return _w(e);case 71:return pT(e);case 80:return Bf(e,n,!a.raw).replace(fr,"");case 81:return fT(e,n).replace(fr,"");case 4108:return gT(e);case 4126:case 4127:return n==4127?hT(e):dT(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function qg(e,t){var r=Y(4),n=Y(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Y(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=uT(t);break;case 31:case 80:for(n=Y(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Bt([r,n])}function Qg(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var u=e.read_shift(4),h=e.read_shift(4);a[i]=[u,h+r]}a.sort(function(y,p){return y[1]-p[1]});var d={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var m=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(m=!1,e.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(d[x.n]=Vc(e,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fn(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(a[i][0]===1){if(o=d.CodePage=Vc(e,hd),fn(o),l!==-1){var g=e.l;e.l=a[l][1],c=Xg(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}c=Xg(e,o)}else{var v=c[a[i][0]],w;switch(e[e.l]){case 65:e.l+=4,w=_w(e);break;case 30:e.l+=4,w=Bf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Bf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=yt(e,4);break;case 64:e.l+=4,w=nt(md(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=w}}return e.l=r+n,d}var kw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xT(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Yg(e,t,r){var n=Y(8),s=[],a=[],i=8,o=0,l=Y(8),c=Y(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),s.push(c),i+=8+l.length,!t){c=Y(8),c.write_shift(4,0),s.unshift(c);var u=[Y(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=Y(4+4+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Bt(u),a.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(kw.indexOf(e[o][0])>-1||mw.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],m=0;if(t){m=+t[e[o][0]];var x=r[m];if(x.p=="version"&&typeof d=="string"){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=qg(x.t,d)}else{var v=xT(d);v==-1&&(v=31,d=String(d)),l=qg(v,d)}a.push(l),c=Y(8),c.write_shift(4,t?m:2+o),s.push(c),i+=8+l.length}var w=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,w),w+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Bt([n].concat(s).concat(a))}function Jg(e,t,r){var n=e.content;if(!n)return{};zt(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==_e.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=Qg(n,t),d={SystemIdentifier:c};for(var m in h)d[m]=h[m];if(d.FMTID=a,s===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Qg(n,null)}catch{}for(m in x)d[m]=x[m];return d.FMTID=[a,i],d}function Zg(e,t,r,n,s,a){var i=Y(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,_e.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var l=Yg(e,r,n);if(o.push(l),s){var c=Yg(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(c)}return Bt(o)}function rs(e,t){return e.read_shift(t),null}function vT(e,t){t||(t=Y(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function wT(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function yt(e,t){return e.read_shift(t)===1}function cr(e,t){return t||(t=Y(2)),t.write_shift(2,+!!e),t}function Tt(e){return e.read_shift(2,"u")}function Gr(e,t){return t||(t=Y(2)),t.write_shift(2,e),t}function Sw(e,t){return wT(e,t,Tt)}function yT(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Ew(e,t,r){return r||(r=Y(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function fl(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function _T(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function kT(e){var t=e.t||"",r=Y(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=Y(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Bt(s)}function fa(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function hl(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):fa(e,n,r)}function Sa(e,t,r){if(r.biff>5)return hl(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function bw(e,t,r){return r||(r=Y(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ST(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ET(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(fr,"");return n&&(e.l+=24),s}function bT(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(fr,"");return r+i}function TT(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ET(e);case"0303000000000000c000000000000046":return bT(e);default:throw new Error("Unsupported Moniker "+r)}}function Wl(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(fr,""):"";return r}function ep(e,t){t||(t=Y(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function NT(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,c="",u,h;s&16&&(a=Wl(e,r-e.l)),s&128&&(i=Wl(e,r-e.l)),(s&257)===257&&(o=Wl(e,r-e.l)),(s&257)===1&&(l=TT(e,r-e.l)),s&8&&(c=Wl(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(h=md(e)),e.l=r;var d=i||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return u&&(m.guid=u),h&&(m.time=h),a&&(m.Tooltip=a),m}function CT(e){var t=Y(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),ep(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&ep(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Tw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function Nw(e,t){var r=Tw(e);return r[3]=0,r}function Pn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ha(e,t,r,n){return n||(n=Y(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function AT(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function FT(e,t,r){return t===0?"":Sa(e,t,r)}function jT(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function Cw(e){var t=e.read_shift(2),r=fd(e);return[t,r]}function OT(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=fl(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function S0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Aw(e,t){return t||(t=Y(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Fw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var PT=Fw;function jw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function IT(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function RT(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Yt(e){e.l+=2,e.l+=e.read_shift(2)}var DT={0:Yt,4:Yt,5:Yt,6:Yt,7:RT,8:Yt,9:Yt,10:Yt,11:Yt,12:Yt,13:IT,14:Yt,15:Yt,16:Yt,17:Yt,18:Yt,19:Yt,20:Yt,21:jw};function LT(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(DT[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function zl(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function gd(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Y(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function MT(e,t){return t===0||e.read_shift(2),1200}function BT(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Sa(e,0,r);return e.read_shift(t+n-e.l),s}function UT(e,t){var r=!t||t.biff==8,n=Y(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function $T(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function HT(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=fl(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function WT(e,t){var r=!t||t.biff>=8?2:1,n=Y(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function zT(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(_T(e));return a.Count=n,a.Unique=s,a}function VT(e,t){var r=Y(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=kT(e[s]);var a=Bt([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function GT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function KT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function XT(e){var t=AT(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function qT(e){return e.read_shift(2),e.read_shift(4)}function tp(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function QT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function YT(){var e=Y(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function JT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function ZT(e){var t=Y(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function e3(){}function t3(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=fl(e,0,r),n}function r3(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Y(s);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function n3(e){var t=Pn(e);return t.isst=e.read_shift(4),t}function s3(e,t,r,n){var s=Y(10);return ha(e,t,n,s),s.write_shift(4,r),s}function a3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Pn(e);r.biff==2&&e.l++;var a=hl(e,n-e.l,r);return s.val=a,s}function i3(e,t,r,n,s){var a=!s||s.biff==8,i=Y(6+2+ +a+(1+a)*r.length);return ha(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function o3(e,t,r){var n=e.read_shift(2),s=Sa(e,0,r);return[n,s]}function l3(e,t,r,n){var s=r&&r.biff==5;n||(n=Y(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var c3=Sa;function rp(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function u3(e,t){var r=t.biff==8||!t.biff?4:2,n=Y(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function f3(e){var t=e.read_shift(2),r=e.read_shift(2),n=Cw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function h3(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(Cw(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function d3(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function m3(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=Xb[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function g3(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=m3(e,t,n.fStyle,r),n}function np(e,t,r,n){var s=r&&r.biff==5;n||(n=Y(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function p3(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function x3(e){var t=Y(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function sp(e,t,r){var n=Pn(e);(r.biff==2||t==9)&&++e.l;var s=yT(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function v3(e,t,r,n,s,a){var i=Y(8);return ha(e,t,n,i),Ew(r,a,i),i}function w3(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Pn(e),s=rr(e);return n.val=s,n}function y3(e,t,r,n){var s=Y(14);return ha(e,t,n,s),ua(r,s),s}var ap=FT;function _3(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=fa(e,a),o=[];n>e.l;)o.push(hl(e));return[a,s,i,o]}function ip(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=OT(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var k3=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function op(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=fa(e,i,r);s&32&&(c=k3[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||o===0||!(u>0)?[]:L6(e,u,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function Ow(e,t,r){if(r.biff<8)return S3(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(jT(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function S3(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=fl(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function E3(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=fa(e,n,r),i=fa(e,s,r);return[a,i]}function b3(e,t,r){var n=Fw(e);e.l++;var s=e.read_shift(1);return t-=8,[M6(e,t,r),s,n]}function lp(e,t,r){var n=PT(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,R6(e,t,r)]}function T3(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function N3(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=Sa(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function C3(e,t,r){return N3(e,t,r)}function A3(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(S0(e));return r}function F3(e){var t=Y(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Aw(e[r],t);return t}function j3(e,t,r){if(r&&r.biff<8)return P3(e,t,r);var n=jw(e),s=LT(e,t-22,n[1]);return{cmo:n,ft:s}}var O3={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function P3(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((O3[n]||ar)(e,t,r)),{cmo:[s,n,a],ft:i}}function I3(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=ST(e,6,r);var o=e.read_shift(2);e.read_shift(2),Tt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=fa(e,e.lens[c+1]-e.lens[c]-1);if(s+=h,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function R3(e,t){var r=S0(e);e.l+=16;var n=NT(e,t-24);return[r,n]}function D3(e){var t=Y(24),r=ft(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Bt([t,CT(e[1])])}function L3(e,t){e.read_shift(2);var r=S0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(fr,""),[r,n]}function M3(e){var t=e[1].Tooltip,r=Y(10+2*(t.length+1));r.write_shift(2,2048);var n=ft(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function B3(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Gg[r]||r,r=e.read_shift(2),t[1]=Gg[r]||r,t}function U3(e){return e||(e=Y(4)),e.write_shift(2,1),e.write_shift(2,1),e}function $3(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Nw(e));return r}function H3(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Nw(e));return r}function W3(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Pw(e,t,r){if(!r.cellStyles)return ar(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function z3(e,t){var r=Y(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function V3(e,t){var r={};return t<32||(e.l+=16,r.header=rr(e),r.footer=rr(e),e.l+=2),r}function G3(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function K3(e){for(var t=Y(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var X3=Pn,q3=Sw,Q3=hl;function Y3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function J3(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Pn(e);++e.l;var s=Sa(e,t-7,r);return n.t="str",n.val=s,n}function Z3(e){var t=Pn(e);++e.l;var r=rr(e);return t.t="n",t.val=r,t}function eN(e,t,r){var n=Y(15);return pl(n,e,t),n.write_shift(8,r,"f"),n}function tN(e){var t=Pn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function rN(e,t,r){var n=Y(9);return pl(n,e,t),n.write_shift(2,r),n}function nN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function sN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function aN(e,t,r){var n=e.l+t,s=Pn(e),a=e.read_shift(2),i=fa(e,a,r);return e.l=n,s.t="str",s.val=i,s}var iN=[2,3,48,49,131,139,140,245],Uf=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=y0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Ns(1);switch(l.type){case"base64":u=jr(Dr(o));break;case"binary":u=jr(o);break;case"buffer":case"array":u=o;break}zt(u,0);var h=u.read_shift(1),d=!!(h&136),m=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,v=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(v=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var p=[],_={},S=Math.min(u.length,h==2?521:v-10-(m?264:0)),E=x?32:11;u.l<S&&u[u.l]!=13;)switch(_={},_.name=us.utils.decode(y,u.slice(u.l,u.l+E)).replace(/[\u0000\r\n].*$/g,""),u.l+=E,_.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(_.offset=u.read_shift(4)),_.len=u.read_shift(1),h==2&&(_.offset=u.read_shift(2)),_.dec=u.read_shift(1),_.name.length&&p.push(_),h!=2&&(u.l+=x?13:14),_.type){case"B":(!m||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var k=0,C=0;for(c[0]=[],C=0;C!=p.length;++C)c[0][C]=p[C].name;for(;g-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++k]=[],C=0,C=0;C!=p.length;++C){var T=u.slice(u.l,u.l+p[C].len);u.l+=p[C].len,zt(T,0);var R=us.utils.decode(y,T);switch(p[C].type){case"C":R.trim().length&&(c[k][C]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[k][C]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[k][C]=R;break;case"F":c[k][C]=parseFloat(R.trim());break;case"+":case"I":c[k][C]=x?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[k][C]=!0;break;case"N":case"F":c[k][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[k][C]="##MEMO##"+(x?parseInt(R.trim(),10):T.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[k][C]=+R||0);break;case"@":c[k][C]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[k][C]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[k][C]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][C]=-T.read_shift(-8,"f");break;case"B":if(m&&p[C].len==8){c[k][C]=T.read_shift(8,"f");break}case"G":case"P":T.l+=p[C].len;break;case"0":if(p[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+p[C].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=p,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Ti(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(o,l){try{return Ds(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&fn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Er(),h=Xc(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),x=o["!cols"]||[],g=0,v=0,w=0,y=1;for(g=0;g<d.length;++g){if(((x[g]||{}).DBF||{}).name){d[g]=x[g].DBF.name,++w;continue}if(d[g]!=null){if(++w,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(v=0;v<1024;++v)if(d.indexOf(d[g]+"_"+v)==-1){d[g]+="_"+v;break}}}}var p=We(o["!ref"]),_=[],S=[],E=[];for(g=0;g<=p.e.c-p.s.c;++g){var k="",C="",T=0,R=[];for(v=0;v<m.length;++v)m[v][g]!=null&&R.push(m[v][g]);if(R.length==0||d[g]==null){_[g]="?";continue}for(v=0;v<R.length;++v){switch(typeof R[v]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=R[v]instanceof Date?"D":"C";break;default:C="C"}T=Math.max(T,String(R[v]).length),k=k&&k!=C?"C":C}T>250&&(T=250),C=((x[g]||{}).DBF||{}).type,C=="C"&&x[g].DBF.len>T&&(T=x[g].DBF.len),k=="B"&&C=="N"&&(k="N",E[g]=x[g].DBF.dec,T=x[g].DBF.len),S[g]=k=="C"||C=="N"?T:a[k]||0,y+=S[g],_[g]=k}var L=u.next(32);for(L.write_shift(4,318902576),L.write_shift(4,m.length),L.write_shift(2,296+32*w),L.write_shift(2,y),g=0;g<4;++g)L.write_shift(4,0);for(L.write_shift(4,0|(+t[_v]||3)<<8),g=0,v=0;g<d.length;++g)if(d[g]!=null){var D=u.next(32),q=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,q,"sbcs"),D.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),D.write_shift(4,v),D.write_shift(1,S[g]||a[_[g]]||0),D.write_shift(1,E[g]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),v+=S[g]||a[_[g]]||0}var oe=u.next(264);for(oe.write_shift(4,13),g=0;g<65;++g)oe.write_shift(4,0);for(g=0;g<m.length;++g){var W=u.next(y);for(W.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(_[v]){case"L":W.write_shift(1,m[g][v]==null?63:m[g][v]?84:70);break;case"B":W.write_shift(8,m[g][v]||0,"f");break;case"N":var ee="0";for(typeof m[g][v]=="number"&&(ee=m[g][v].toFixed(E[v]||0)),w=0;w<S[v]-ee.length;++w)W.write_shift(1,32);W.write_shift(1,ee,"sbcs");break;case"D":m[g][v]?(W.write_shift(4,("0000"+m[g][v].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(m[g][v].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+m[g][v].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(m[g][v]!=null?m[g][v]:"").slice(0,S[v]);for(W.write_shift(1,ne,"sbcs"),w=0;w<S[v]-ne.length;++w)W.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),Iw=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+xt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var x=e[m];return typeof x=="number"?wg(x):x},n=function(d,m,x){var g=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?d:wg(g)};e["|"]=254;function s(d,m){switch(m.type){case"base64":return a(Dr(d),m);case"binary":return a(d,m);case"buffer":return a(Re&&Buffer.isBuffer(d)?d.toString("binary"):Rs(d),m);case"array":return a(ca(d),m)}throw new Error("Unrecognized type "+m.type)}function a(d,m){var x=d.split(/[\n\r]+/),g=-1,v=-1,w=0,y=0,p=[],_=[],S=null,E={},k=[],C=[],T=[],R=0,L;for(+m.codepage>=0&&fn(+m.codepage);w!==x.length;++w){R=0;var D=x[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=D.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),oe=q[0],W;if(D.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&_.push(D.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,ne=!1,Z=!1,U=!1,re=-1,ge=-1;for(y=1;y<q.length;++y)switch(q[y].charAt(0)){case"A":break;case"X":v=parseInt(q[y].slice(1))-1,ne=!0;break;case"Y":for(g=parseInt(q[y].slice(1))-1,ne||(v=0),L=p.length;L<=g;++L)p[L]=[];break;case"K":W=q[y].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(pn(W))?isNaN(pi(W).getDate())||(W=nt(W)):(W=pn(W),S!==null&&Ei(S)&&(W=k0(W))),ee=!0;break;case"E":U=!0;var O=ai(q[y].slice(1),{r:g,c:v});p[g][v]=[p[g][v],O];break;case"S":Z=!0,p[g][v]=[p[g][v],"S5S"];break;case"G":break;case"R":re=parseInt(q[y].slice(1))-1;break;case"C":ge=parseInt(q[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}if(ee&&(p[g][v]&&p[g][v].length==2?p[g][v][0]=W:p[g][v]=W,S=null),Z){if(U)throw new Error("SYLK shared formula cannot have own formula");var H=re>-1&&p[re][ge];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");p[g][v][1]=Jw(H[1],{r:g-re,c:v-ge})}break;case"F":var M=0;for(y=1;y<q.length;++y)switch(q[y].charAt(0)){case"X":v=parseInt(q[y].slice(1))-1,++M;break;case"Y":for(g=parseInt(q[y].slice(1))-1,L=p.length;L<=g;++L)p[L]=[];break;case"M":R=parseInt(q[y].slice(1))/20;break;case"F":break;case"G":break;case"P":S=_[parseInt(q[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=q[y].slice(1).split(" "),L=parseInt(T[0],10);L<=parseInt(T[1],10);++L)R=parseInt(T[2],10),C[L-1]=R===0?{hidden:!0}:{wch:R},Cs(C[L-1]);break;case"C":v=parseInt(q[y].slice(1))-1,C[v]||(C[v]={});break;case"R":g=parseInt(q[y].slice(1))-1,k[g]||(k[g]={}),R>0?(k[g].hpt=R,k[g].hpx=vi(R)):R===0&&(k[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}M<1&&(S=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(E["!rows"]=k),C.length>0&&(E["!cols"]=C),m&&m.sheetRows&&(p=p.slice(0,m.sheetRows)),[p,E]}function i(d,m){var x=s(d,m),g=x[0],v=x[1],w=Ti(g,m);return xt(v).forEach(function(y){w[y]=v[y]}),w}function o(d,m){return Ds(i(d,m),m)}function l(d,m,x,g){var v="C;Y"+(x+1)+";X"+(g+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+_d(d.f,{r:x,c:g}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(d,m){m.forEach(function(x,g){var v="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?v+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Xo(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=qo(x.wpx)),typeof x.wch=="number"&&(v+=Math.round(x.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function u(d,m){m.forEach(function(x,g){var v="F;";x.hidden?v+="M0;":x.hpt?v+="M"+20*x.hpt+";":x.hpx&&(v+="M"+20*Qo(x.hpx)+";"),v.length>2&&d.push(v+"R"+(g+1))})}function h(d,m){var x=["ID;PWXL;N;E"],g=[],v=We(d["!ref"]),w,y=Array.isArray(d),p=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&c(x,d["!cols"]),d["!rows"]&&u(x,d["!rows"]),x.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var _=v.s.r;_<=v.e.r;++_)for(var S=v.s.c;S<=v.e.c;++S){var E=be({r:_,c:S});w=y?(d[_]||[])[S]:d[E],!(!w||w.v==null&&(!w.f||w.F))&&g.push(l(w,d,_,S))}return x.join(p)+p+g.join(p)+p+"E"+p}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),Rw=function(){function e(a,i){switch(i.type){case"base64":return t(Dr(a),i);case"binary":return t(a,i);case"buffer":return t(Re&&Buffer.isBuffer(a)?a.toString("binary"):Rs(a),i);case"array":return t(ca(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),m=d[0],x=d[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(pn(x))?isNaN(pi(x).getDate())?h[l][c]=x:h[l][c]=nt(x):h[l][c]=pn(x),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return Ti(e(a,i),i)}function n(a,i){return Ds(r(a,i),i)}var s=function(){var a=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},i=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=We(l["!ref"]),h,d=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var g=be({r:m,c:x});if(h=d?(l[m]||[])[x]:l[g],!h){i(c,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?i(c,1,0,"="+h.f):i(c,1,0,""):i(c,0,v,"V");break;case"b":i(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=tn(h.z||Se[14],Rt(nt(h.v)))),i(c,0,h.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),Dw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),x=-1,g=-1,v=0,w=[];v!==m.length;++v){var y=m[v].trim().split(":");if(y[0]==="cell"){var p=ft(y[1]);if(w.length<=p.r)for(x=w.length;x<=p.r;++x)w[x]||(w[x]=[]);switch(x=p.r,g=p.c,y[2]){case"t":w[x][g]=e(y[3]);break;case"v":w[x][g]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[x][g]=!!+y[4];break;default:w[x][g]=+y[4];break}y[2]=="vtf"&&(w[x][g]=[w[x][g],_])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return Ti(r(h,d),d)}function s(h,d){return Ds(n(h,d),d)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],x,g="",v=br(h["!ref"]),w=Array.isArray(h),y=v.s.r;y<=v.e.r;++y)for(var p=v.s.c;p<=v.e.c;++p)if(g=be({r:y,c:p}),x=w?(h[y]||[])[p]:h[g],!(!x||x.v==null||x.t==="z")){switch(m=["cell",g,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var _=Rt(nt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+_,m[5]=x.w||tn(x.z||Se[14],_);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[a,i,o,i,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),xi=function(){function e(u,h,d,m,x){x.raw?h[d][m]=u:u===""||(u==="TRUE"?h[d][m]=!0:u==="FALSE"?h[d][m]=!1:isNaN(pn(u))?isNaN(pi(u).getDate())?h[d][m]=u:h[d][m]=nt(u):h[d][m]=pn(u))}function t(u,h){var d=h||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var v=10,w=0,y=0;y<=g;++y)w=x[y].indexOf(" "),w==-1?w=x[y].length:w++,v=Math.max(v,w);for(y=0;y<=g;++y){m[y]=[];var p=0;for(e(x[y].slice(0,v).trim(),m,y,p,d),p=1;p<=(x[y].length-v)/10+1;++p)e(x[y].slice(v+(p-1)*10,v+p*10).trim(),m,y,p,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},d=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?d=!d:!d&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m]);if(!x.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&x.push([h[m],m])}return x.sort(function(g,v){return g[0]-v[0]||n[g[1]]-n[v[1]]}),r[x.pop()[1]]||44}function a(u,h){var d=h||{},m="",x=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):d&&d.FS?m=d.FS:m=s(u.slice(0,1024));var v=0,w=0,y=0,p=0,_=0,S=m.charCodeAt(0),E=!1,k=0,C=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=d.dateNF!=null?KE(d.dateNF):null;function R(){var L=u.slice(p,_),D={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)D.t="z";else if(d.raw)D.t="s",D.v=L;else if(L.trim().length===0)D.t="s",D.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(D.t="s",D.v=L.slice(2,-1).replace(/""/g,'"')):_A(L)?(D.t="n",D.f=L.slice(1)):(D.t="s",D.v=L);else if(L=="TRUE")D.t="b",D.v=!0;else if(L=="FALSE")D.t="b",D.v=!1;else if(!isNaN(y=pn(L)))D.t="n",d.cellText!==!1&&(D.w=L),D.v=y;else if(!isNaN(pi(L).getDate())||T&&L.match(T)){D.z=d.dateNF||Se[14];var q=0;T&&L.match(T)&&(L=XE(L,d.dateNF,L.match(T)||[]),q=1),d.cellDates?(D.t="d",D.v=nt(L,q)):(D.t="n",D.v=Rt(nt(L,q))),d.cellText!==!1&&(D.w=tn(D.z,D.v instanceof Date?Rt(D.v):D.v)),d.cellNF||delete D.z}else D.t="s",D.v=L;if(D.t=="z"||(d.dense?(x[v]||(x[v]=[]),x[v][w]=D):x[be({c:w,r:v})]=D),p=_+1,C=u.charCodeAt(p),g.e.c<w&&(g.e.c=w),g.e.r<v&&(g.e.r=v),k==S)++w;else if(w=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;_<u.length;++_)switch(k=u.charCodeAt(_)){case 34:C===34&&(E=!E);break;case S:case 10:case 13:if(!E&&R())break e;break}return _-p>0&&R(),x["!ref"]=je(g),x}function i(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):Ti(t(u,h),h)}function o(u,h){var d="",m=h.type=="string"?[0,0,0,0]:Ad(u,h);switch(h.type){case"base64":d=Dr(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof us<"u"?d=us.utils.decode(h.codepage,u):d=Re&&Buffer.isBuffer(u)?u.toString("binary"):Rs(u);break;case"array":d=ca(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=Ye(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Ye(d):h.type=="binary"&&typeof us<"u"&&h.codepage&&(d=us.utils.decode(h.codepage,us.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?Dw.to_sheet(h.type=="string"?d:Ye(d),h):i(d,h)}function l(u,h){return Ds(o(u,h),h)}function c(u){for(var h=[],d=We(u["!ref"]),m,x=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var v=[],w=d.s.c;w<=d.e.c;++w){var y=be({r:g,c:w});if(m=x?(u[g]||[])[w]:u[y],!m||m.v==null){v.push("          ");continue}for(var p=(m.w||(qn(m),m.w)||"").slice(0,10);p.length<10;)p+=" ";v.push(p+(w===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function oN(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=Iw.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return xi.to_workbook(e,t)}}var ta=function(){function e(O,H,M){if(O){zt(O,O.l||0);for(var B=M.Enum||re;O.l<O.length;){var Q=O.read_shift(2),ie=B[Q]||B[65535],ue=O.read_shift(2),ae=O.l+ue,se=ie.f&&ie.f(O,ue,M);if(O.l=ae,H(se,ie,Q))return}}}function t(O,H){switch(H.type){case"base64":return r(jr(Dr(O)),H);case"binary":return r(jr(O),H);case"buffer":case"array":return r(O,H)}throw"Unsupported type "+H.type}function r(O,H){if(!O)return O;var M=H||{},B=M.dense?[]:{},Q="Sheet1",ie="",ue=0,ae={},se=[],Ne=[],N={s:{r:0,c:0},e:{r:0,c:0}},Ee=M.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)M.Enum=re,e(O,function(xe,at,mr){switch(mr){case 0:M.vers=xe,xe>=4096&&(M.qpro=!0);break;case 6:N=xe;break;case 204:xe&&(ie=xe);break;case 222:ie=xe;break;case 15:case 51:M.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:mr==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=M.dateNF||Se[14],M.cellDates&&(xe[1].t="d",xe[1].v=k0(xe[1].v))),M.qpro&&xe[3]>ue&&(B["!ref"]=je(N),ae[Q]=B,se.push(Q),B=M.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},ue=xe[3],Q=ie||"Sheet"+(ue+1),ie="");var ke=M.dense?(B[xe[0].r]||[])[xe[0].c]:B[be(xe[0])];if(ke){ke.t=xe[1].t,ke.v=xe[1].v,xe[1].z!=null&&(ke.z=xe[1].z),xe[1].f!=null&&(ke.f=xe[1].f);break}M.dense?(B[xe[0].r]||(B[xe[0].r]=[]),B[xe[0].r][xe[0].c]=xe[1]):B[be(xe[0])]=xe[1];break}},M);else if(O[2]==26||O[2]==14)M.Enum=ge,O[2]==14&&(M.qpro=!0,O.l=0),e(O,function(xe,at,mr){switch(mr){case 204:Q=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>ue&&(B["!ref"]=je(N),ae[Q]=B,se.push(Q),B=M.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},ue=xe[3],Q="Sheet"+(ue+1)),Ee>0&&xe[0].r>=Ee)break;M.dense?(B[xe[0].r]||(B[xe[0].r]=[]),B[xe[0].r][xe[0].c]=xe[1]):B[be(xe[0])]=xe[1],N.e.c<xe[0].c&&(N.e.c=xe[0].c),N.e.r<xe[0].r&&(N.e.r=xe[0].r);break;case 27:xe[14e3]&&(Ne[xe[14e3][0]]=xe[14e3][1]);break;case 1537:Ne[xe[0]]=xe[1],xe[0]==ue&&(Q=xe[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(B["!ref"]=je(N),ae[ie||Q]=B,se.push(ie||Q),!Ne.length)return{SheetNames:se,Sheets:ae};for(var De={},ze=[],Pe=0;Pe<Ne.length;++Pe)ae[se[Pe]]?(ze.push(Ne[Pe]||se[Pe]),De[Ne[Pe]]=ae[Ne[Pe]]||ae[se[Pe]]):(ze.push(Ne[Pe]),De[Ne[Pe]]={"!ref":"A1"});return{SheetNames:ze,Sheets:De}}function n(O,H){var M=H||{};if(+M.codepage>=0&&fn(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Er(),Q=We(O["!ref"]),ie=Array.isArray(O),ue=[];me(B,0,a(1030)),me(B,6,l(Q));for(var ae=Math.min(Q.e.r,8191),se=Q.s.r;se<=ae;++se)for(var Ne=kt(se),N=Q.s.c;N<=Q.e.c;++N){se===Q.s.r&&(ue[N]=ut(N));var Ee=ue[N]+Ne,De=ie?(O[se]||[])[N]:O[Ee];if(!(!De||De.t=="z"))if(De.t=="n")(De.v|0)==De.v&&De.v>=-32768&&De.v<=32767?me(B,13,m(se,N,De.v)):me(B,14,g(se,N,De.v));else{var ze=qn(De);me(B,15,h(se,N,ze.slice(0,239)))}}return me(B,1),B.end()}function s(O,H){var M=H||{};if(+M.codepage>=0&&fn(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Er();me(B,0,i(O));for(var Q=0,ie=0;Q<O.SheetNames.length;++Q)(O.Sheets[O.SheetNames[Q]]||{})["!ref"]&&me(B,27,U(O.SheetNames[Q],ie++));var ue=0;for(Q=0;Q<O.SheetNames.length;++Q){var ae=O.Sheets[O.SheetNames[Q]];if(!(!ae||!ae["!ref"])){for(var se=We(ae["!ref"]),Ne=Array.isArray(ae),N=[],Ee=Math.min(se.e.r,8191),De=se.s.r;De<=Ee;++De)for(var ze=kt(De),Pe=se.s.c;Pe<=se.e.c;++Pe){De===se.s.r&&(N[Pe]=ut(Pe));var xe=N[Pe]+ze,at=Ne?(ae[De]||[])[Pe]:ae[xe];if(!(!at||at.t=="z"))if(at.t=="n")me(B,23,R(De,Pe,ue,at.v));else{var mr=qn(at);me(B,22,k(De,Pe,ue,mr.slice(0,239)))}}++ue}}return me(B,1),B.end()}function a(O){var H=Y(2);return H.write_shift(2,O),H}function i(O){var H=Y(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var M=0,B=0,Q=0,ie=0;ie<O.SheetNames.length;++ie){var ue=O.SheetNames[ie],ae=O.Sheets[ue];if(!(!ae||!ae["!ref"])){++Q;var se=br(ae["!ref"]);M<se.e.r&&(M=se.e.r),B<se.e.c&&(B=se.e.c)}}return M>8191&&(M=8191),H.write_shift(2,M),H.write_shift(1,Q),H.write_shift(1,B),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(O,H,M){var B={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&M.qpro?(B.s.c=O.read_shift(1),O.l++,B.s.r=O.read_shift(2),B.e.c=O.read_shift(1),O.l++,B.e.r=O.read_shift(2),B):(B.s.c=O.read_shift(2),B.s.r=O.read_shift(2),H==12&&M.qpro&&(O.l+=2),B.e.c=O.read_shift(2),B.e.r=O.read_shift(2),H==12&&M.qpro&&(O.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(O){var H=Y(8);return H.write_shift(2,O.s.c),H.write_shift(2,O.s.r),H.write_shift(2,O.e.c),H.write_shift(2,O.e.r),H}function c(O,H,M){var B=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(B[0].c=O.read_shift(1),B[3]=O.read_shift(1),B[0].r=O.read_shift(2),O.l+=2):(B[2]=O.read_shift(1),B[0].c=O.read_shift(2),B[0].r=O.read_shift(2)),B}function u(O,H,M){var B=O.l+H,Q=c(O,H,M);if(Q[1].t="s",M.vers==20768){O.l++;var ie=O.read_shift(1);return Q[1].v=O.read_shift(ie,"utf8"),Q}return M.qpro&&O.l++,Q[1].v=O.read_shift(B-O.l,"cstr"),Q}function h(O,H,M){var B=Y(7+M.length);B.write_shift(1,255),B.write_shift(2,H),B.write_shift(2,O),B.write_shift(1,39);for(var Q=0;Q<B.length;++Q){var ie=M.charCodeAt(Q);B.write_shift(1,ie>=128?95:ie)}return B.write_shift(1,0),B}function d(O,H,M){var B=c(O,H,M);return B[1].v=O.read_shift(2,"i"),B}function m(O,H,M){var B=Y(7);return B.write_shift(1,255),B.write_shift(2,H),B.write_shift(2,O),B.write_shift(2,M,"i"),B}function x(O,H,M){var B=c(O,H,M);return B[1].v=O.read_shift(8,"f"),B}function g(O,H,M){var B=Y(13);return B.write_shift(1,255),B.write_shift(2,H),B.write_shift(2,O),B.write_shift(8,M,"f"),B}function v(O,H,M){var B=O.l+H,Q=c(O,H,M);if(Q[1].v=O.read_shift(8,"f"),M.qpro)O.l=B;else{var ie=O.read_shift(2);_(O.slice(O.l,O.l+ie),Q),O.l+=ie}return Q}function w(O,H,M){var B=H&32768;return H&=-32769,H=(B?O:0)+(H>=8192?H-16384:H),(B?"":"$")+(M?ut(H):kt(H))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},p=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(O,H){zt(O,0);for(var M=[],B=0,Q="",ie="",ue="",ae="";O.l<O.length;){var se=O[O.l++];switch(se){case 0:M.push(O.read_shift(8,"f"));break;case 1:ie=w(H[0].c,O.read_shift(2),!0),Q=w(H[0].r,O.read_shift(2),!1),M.push(ie+Q);break;case 2:{var Ne=w(H[0].c,O.read_shift(2),!0),N=w(H[0].r,O.read_shift(2),!1);ie=w(H[0].c,O.read_shift(2),!0),Q=w(H[0].r,O.read_shift(2),!1),M.push(Ne+N+":"+ie+Q)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(O.read_shift(2));break;case 6:{for(var Ee="";se=O[O.l++];)Ee+=String.fromCharCode(se);M.push('"'+Ee.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ae=M.pop(),ue=M.pop(),M.push(["AND","OR"][se-20]+"("+ue+","+ae+")");break;default:if(se<32&&p[se])ae=M.pop(),ue=M.pop(),M.push(ue+p[se]+ae);else if(y[se]){if(B=y[se][1],B==69&&(B=O[O.l++]),B>M.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+M.join("|")+"|");return}var De=M.slice(-B);M.length-=B,M.push(y[se][0]+"("+De.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}M.length==1?H[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function S(O){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=O.read_shift(2),H[3]=O[O.l++],H[0].c=O[O.l++],H}function E(O,H){var M=S(O);return M[1].t="s",M[1].v=O.read_shift(H-4,"cstr"),M}function k(O,H,M,B){var Q=Y(6+B.length);Q.write_shift(2,O),Q.write_shift(1,M),Q.write_shift(1,H),Q.write_shift(1,39);for(var ie=0;ie<B.length;++ie){var ue=B.charCodeAt(ie);Q.write_shift(1,ue>=128?95:ue)}return Q.write_shift(1,0),Q}function C(O,H){var M=S(O);M[1].v=O.read_shift(2);var B=M[1].v>>1;if(M[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return M[1].v=B,M}function T(O,H){var M=S(O),B=O.read_shift(4),Q=O.read_shift(4),ie=O.read_shift(2);if(ie==65535)return B===0&&Q===3221225472?(M[1].t="e",M[1].v=15):B===0&&Q===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ue=ie&32768;return ie=(ie&32767)-16446,M[1].v=(1-ue*2)*(Q*Math.pow(2,ie+32)+B*Math.pow(2,ie)),M}function R(O,H,M,B){var Q=Y(14);if(Q.write_shift(2,O),Q.write_shift(1,M),Q.write_shift(1,H),B==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var ie=0,ue=0,ae=0,se=0;return B<0&&(ie=1,B=-B),ue=Math.log2(B)|0,B/=Math.pow(2,ue-31),se=B>>>0,se&2147483648||(B/=2,++ue,se=B>>>0),B-=se,se|=2147483648,se>>>=0,B*=Math.pow(2,32),ae=B>>>0,Q.write_shift(4,ae),Q.write_shift(4,se),ue+=16383+(ie?32768:0),Q.write_shift(2,ue),Q}function L(O,H){var M=T(O);return O.l+=H-14,M}function D(O,H){var M=S(O),B=O.read_shift(4);return M[1].v=B>>6,M}function q(O,H){var M=S(O),B=O.read_shift(8,"f");return M[1].v=B,M}function oe(O,H){var M=q(O);return O.l+=H-10,M}function W(O,H){return O[O.l+H-1]==0?O.read_shift(H,"cstr"):""}function ee(O,H){var M=O[O.l++];M>H-1&&(M=H-1);for(var B="";B.length<M;)B+=String.fromCharCode(O[O.l++]);return B}function ne(O,H,M){if(!(!M.qpro||H<21)){var B=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var Q=O.read_shift(H-21,"cstr");return[B,Q]}}function Z(O,H){for(var M={},B=O.l+H;O.l<B;){var Q=O.read_shift(2);if(Q==14e3){for(M[Q]=[0,""],M[Q][0]=O.read_shift(2);O[O.l];)M[Q][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return M}function U(O,H){var M=Y(5+O.length);M.write_shift(2,14e3),M.write_shift(2,H);for(var B=0;B<O.length;++B){var Q=O.charCodeAt(B);M[M.l++]=Q>127?95:Q}return M[M.l++]=0,M}var re={0:{n:"BOF",f:Tt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function lN(e){var t={},r=e.match(ir),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Te(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Gh[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var cN=function(){var e=Wo("t"),t=Wo("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:He(i[1])},l=a.match(t);return l&&(o.s=lN(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),uN=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),fN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,hN=/<(?:\w+:)?r>/,dN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function pd(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=He(Ye(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ye(e),r&&(n.h=rd(n.t))):e.match(hN)&&(n.r=Ye(e),n.t=He(Ye((e.replace(dN,"").match(fN)||[]).join("").replace(ir,""))),r&&(n.h=uN(cN(n.r)))),n):{t:""}}var mN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,gN=/<(?:\w+:)?(?:si|sstItem)>/g,pN=/<\/(?:\w+:)?(?:si|sstItem)>/;function xN(e,t){var r=[],n="";if(!e)return r;var s=e.match(mN);if(s){n=s[2].replace(gN,"").split(pN);for(var a=0;a!=n.length;++a){var i=pd(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Te(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var vN=/^\s|\s$|[\t\n\r]/;function Lw(e,t){if(!t.bookSST)return"";var r=[St];r[r.length]=de("sst",null,{xmlns:va[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(vN)&&(a+=' xml:space="preserve"'),a+=">"+qe(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function wN(e){return[e.read_shift(4),e.read_shift(4)]}function yN(e,t){var r=[],n=!1;return Jn(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function _N(e,t){return t||(t=Y(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var kN=Ob;function SN(e){var t=Er();te(t,159,_N(e));for(var r=0;r<e.length;++r)te(t,19,kN(e[r]));return te(t,160),t.end()}function Mw(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function zn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function EN(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=zn(e,4),t.U=zn(e,4),t.W=zn(e,4),t}function bN(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function TN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(bN(e));return t}function NN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function CN(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=zn(e,4),t.U=zn(e,4),t.W=zn(e,4),t}function AN(e){var t=CN(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Bw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Uw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function FN(e){var t=zn(e);switch(t.Minor){case 2:return[t.Minor,jN(e)];case 3:return[t.Minor,ON()];case 4:return[t.Minor,PN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function jN(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Bw(e,r),s=Uw(e,e.length-e.l);return{t:"Std",h:n,v:s}}function ON(){throw new Error("File is password-protected: ECMA-376 Extensible")}function PN(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ir,function(a){var i=Te(a);switch(On(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function IN(e,t){var r={},n=r.EncryptionVersionInfo=zn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Bw(e,s),t-=s,r.EncryptionVerifier=Uw(e,t),r}function RN(e){var t={},r=t.EncryptionVersionInfo=zn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function xd(e){var t=0,r,n=Mw(e),s=n.length+1,a,i,o,l,c;for(r=Ns(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var $w=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=Mw(i),l=a(o),c=o.length,u=Ns(16),h=0;h!=16;++h)u[h]=0;var d,m,x;for((c&1)===1&&(d=l>>8,u[c]=s(e[0],d),--c,d=l&255,m=o[o.length-1],u[c]=s(m,d));c>0;)--c,d=l>>8,u[c]=s(o[c],d),--c,d=l&255,u[c]=s(o[c],d);for(c=15,x=15-o.length;x>0;)d=l>>8,u[c]=s(e[x],d),--c,--x,d=l&255,u[c]=s(o[c],d),--c,--x;return u}}(),DN=function(e,t,r,n,s){s||(s=t),n||(n=$w(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},LN=function(e){var t=0,r=$w(e);return function(n){var s=DN("",n,t,r);return t=s[1],s[0]}};function MN(e,t,r,n){var s={key:Tt(e),verificationBytes:Tt(e)};return r.password&&(s.verifier=xd(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=LN(r.password)),s}function BN(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=RN(e):n.Data=IN(e,t),n}function UN(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?BN(e,t-2,n):MN(e,r.biff>=8?t:t-2,r,n),n}var Hw=function(){function e(s,a){switch(a.type){case"base64":return t(Dr(s),a);case"binary":return t(s,a);case"buffer":return t(Re&&Buffer.isBuffer(s)?s.toString("binary"):Rs(s),a);case"array":return t(ca(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,x,g=-1;x=d.exec(u);){switch(x[0]){case"\\cell":var v=u.slice(m,d.lastIndex-x[0].length);if(v[0]==" "&&(v=v.slice(1)),++g,v.length){var w={v,t:"s"};Array.isArray(o)?o[h][g]=w:o[be({r:h,c:g})]=w}break}m=d.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=je(c),o}function r(s,a){return Ds(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=We(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var h=be({r:c,c:u});o=l?(s[c]||[])[u]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(qn(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function $N(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ko(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function HN(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function WN(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Gc(e,t){if(t===0)return e;var r=HN($N(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ko(WN(r))}var Ww=6,zN=15,VN=1,tr=Ww;function Xo(e){return Math.floor((e+Math.round(128/tr)/256)*tr)}function qo(e){return Math.floor((e-5)/tr*100+.5)/100}function Kc(e){return Math.round((e*tr+5)/tr*256)/256}function pu(e){return Kc(qo(Xo(e)))}function vd(e){var t=Math.abs(e-pu(e)),r=tr;if(t>.005)for(tr=VN;tr<zN;++tr)Math.abs(e-pu(e))<=t&&(t=Math.abs(e-pu(e)),r=tr);tr=r}function Cs(e){e.width?(e.wpx=Xo(e.width),e.wch=qo(e.wpx),e.MDW=tr):e.wpx?(e.wch=qo(e.wpx),e.width=Kc(e.wch),e.MDW=tr):typeof e.wch=="number"&&(e.width=Kc(e.wch),e.wpx=Xo(e.width),e.MDW=tr),e.customWidth&&delete e.customWidth}var GN=96,zw=GN;function Qo(e){return e*96/zw}function vi(e){return e*zw/96}var KN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function XN(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(ir)||[]).forEach(function(i){var o=Te(i);switch(On(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=tt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=tt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function qN(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(ir)||[]).forEach(function(i){var o=Te(i);switch(On(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function QN(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(ir)||[]).forEach(function(i){var o=Te(i);switch(On(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Ye(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?tt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?tt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?tt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?tt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?tt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?tt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?tt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Gh[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=tt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Zs[s.color.index];s.color.index==81&&(l=Zs[1]),l||(l=Zs[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Gc(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function YN(e,t,r){t.NumberFmt=[];for(var n=xt(Se),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Se[n[s]];var a=e[0].match(ir);if(a)for(s=0;s<a.length;++s){var i=Te(a[s]);switch(On(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=He(Ye(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Wn(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function JN(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=de("numFmt",null,{numFmtId:n,formatCode:qe(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=de("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Vl=["numFmtId","fillId","fontId","borderId","xfId"],Gl=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ZN(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(ir)||[]).forEach(function(a){var i=Te(a),o=0;switch(On(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Vl.length;++o)n[Vl[o]]&&(n[Vl[o]]=parseInt(n[Vl[o]],10));for(o=0;o<Gl.length;++o)n[Gl[o]]&&(n[Gl[o]]=tt(n[Gl[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=tt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function eC(e){var t=[];return t[t.length]=de("cellXfs",null),e.forEach(function(r){t[t.length]=de("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=de("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var tC=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&YN(h,u,c),(h=o.match(s))&&QN(h,u,l,c),(h=o.match(n))&&qN(h,u,l,c),(h=o.match(a))&&XN(h,u,l,c),(h=o.match(r))&&ZN(h,u,c),u}}();function Vw(e,t){var r=[St,de("styleSheet",null,{xmlns:va[0],"xmlns:vt":Pt.vt})],n;return e.SSF&&(n=JN(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=eC(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function rC(e,t){var r=e.read_shift(2),n=nr(e);return[r,n]}function nC(e,t,r){r||(r=Y(6+4*t.length)),r.write_shift(2,e),Ut(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function sC(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=Bb(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Mb(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=nr(e),n}function aC(e,t){t||(t=Y(25+4*32)),t.write_shift(2,e.sz*20),Ub(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Wc(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Ut(e.name,t),t.length>t.l?t.slice(0,t.l):t}var iC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xu,oC=ar;function cp(e,t){t||(t=Y(4*3+8*7+16*1)),xu||(xu=y0(iC));var r=xu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Wc({auto:1},t),Wc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function lC(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function Gw(e,t,r){r||(r=Y(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function $i(e,t){return t||(t=Y(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var cC=ar;function uC(e,t){return t||(t=Y(51)),t.write_shift(1,0),$i(null,t),$i(null,t),$i(null,t),$i(null,t),$i(null,t),t.length>t.l?t.slice(0,t.l):t}function fC(e,t){return t||(t=Y(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Hc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function hC(e,t,r){var n=Y(2052);return n.write_shift(4,e),Hc(t,n),Hc(r,n),n.length>n.l?n.slice(0,n.l):n}function dC(e,t,r){var n={};n.NumberFmt=[];for(var s in Se)n.NumberFmt[s]=Se[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Jn(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Wn(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Gc(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function mC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(te(e,615,xn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&te(e,44,nC(s,t[s]))}),te(e,616))}}function gC(e){var t=1;te(e,611,xn(t)),te(e,43,aC({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),te(e,612)}function pC(e){var t=2;te(e,603,xn(t)),te(e,45,cp({patternType:"none"})),te(e,45,cp({patternType:"gray125"})),te(e,604)}function xC(e){var t=1;te(e,613,xn(t)),te(e,46,uC()),te(e,614)}function vC(e){var t=1;te(e,626,xn(t)),te(e,47,Gw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),te(e,627)}function wC(e,t){te(e,617,xn(t.length)),t.forEach(function(r){te(e,47,Gw(r,0))}),te(e,618)}function yC(e){var t=1;te(e,619,xn(t)),te(e,48,fC({xfId:0,builtinId:0,name:"Normal"})),te(e,620)}function _C(e){var t=0;te(e,505,xn(t)),te(e,506)}function kC(e){var t=0;te(e,508,hC(t,"TableStyleMedium9","PivotStyleMedium4")),te(e,509)}function SC(e,t){var r=Er();return te(r,278),mC(r,e.SSF),gC(r),pC(r),xC(r),vC(r),wC(r,t.cellXfs),yC(r),_C(r),kC(r),te(r,279),r.end()}var EC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function bC(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ir)||[]).forEach(function(s){var a=Te(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[EC.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function TC(){}function NC(){}var CC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,AC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,FC=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jC(e,t,r){t.themeElements={};var n;[["clrScheme",CC,bC],["fontScheme",AC,TC],["fmtScheme",FC,NC]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var OC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Kw(e,t){(!e||e.length===0)&&(e=wd());var r,n={};if(!(r=e.match(OC)))throw new Error("themeElements not found in theme");return jC(r[0],n,t),n.raw=e,n}function wd(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[St];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function PC(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=Bv(a,{type:"array"})}catch{return}var o=Or(i,"theme/theme/theme1.xml",!0);if(o)return Kw(o,r)}}function IC(e){return e.read_shift(4)}function RC(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=DC(e,4);break;case 2:t.xclrValue=Tw(e);break;case 3:t.xclrValue=IC(e);break;case 4:e.l+=4;break}return e.l+=8,t}function DC(e,t){return ar(e,t)}function LC(e,t){return ar(e,t)}function MC(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=RC(e);break;case 6:n[1]=LC(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function BC(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(MC(e,r-e.l));return{ixfe:n,ext:a}}function UC(e,t){t.forEach(function(r){switch(r[0]){}})}function $C(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:nr(e)}}function HC(e){var t=Y(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ut(e.name,t),t.slice(0,t.l)}function WC(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zC(e){var t=Y(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function VC(e,t){var r=Y(8+2*t.length);return r.write_shift(4,e),Ut(t,r),r.slice(0,r.l)}function GC(e){return e.l+=4,e.read_shift(4)!=0}function KC(e,t){var r=Y(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function XC(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Jn(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function qC(){var e=Er();return te(e,332),te(e,334,xn(1)),te(e,335,HC({name:"XLDAPR",version:12e4,flags:3496657072})),te(e,336),te(e,339,VC(1,"XLDAPR")),te(e,52),te(e,35,xn(514)),te(e,4096,xn(0)),te(e,4097,Gr(1)),te(e,36),te(e,53),te(e,340),te(e,337,KC(1,!0)),te(e,51,zC([[1,0]])),te(e,338),te(e,333),e.end()}function QC(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(ir,function(o){var l=Te(o);switch(On(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Xw(){var e=[St];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function YC(e){var t=[];if(!e)return t;var r=1;return(e.match(ir)||[]).forEach(function(n){var s=Te(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function JC(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=be(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function ZC(e,t,r){var n=[];return Jn(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function eA(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Jn(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function tA(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Qa=1024;function qw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[de("xml",null,{"xmlns:v":Cr.v,"xmlns:o":Cr.o,"xmlns:x":Cr.x,"xmlns:mv":Cr.mv}).replace(/\/>/,">"),de("o:shapelayout",de("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),de("v:shapetype",[de("v:stroke",null,{joinstyle:"miter"}),de("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Qa<e*1e3;)Qa+=1e3;return t.forEach(function(a){var i=ft(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?de("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=de("v:fill",l,o),u={on:"t",obscured:"t"};++Qa,s=s.concat(["<v:shape"+zo({id:"_x0000_s"+Qa,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,de("v:shadow",null,u),de("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Vt("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Vt("x:AutoFill","False"),Vt("x:Row",String(i.r)),Vt("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function up(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=ft(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=We(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=je(l);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}a.c.push(u)})}function rA(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Te(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ft(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&pd(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function Qw(e){var t=[St,de("comments",null,{xmlns:va[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=qe(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(qe(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(Vt("t",qe(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(Vt("t",qe(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function nA(e,t){var r=[],n=!1,s={},a=0;return e.replace(ir,function(o,l){var c=Te(o);switch(On(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function sA(e,t,r){var n=[St,de("ThreadedComments",null,{xmlns:Pt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(de("threadedComment",Vt("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function aA(e,t){var r=[],n=!1;return e.replace(ir,function(a){var i=Te(a);switch(On(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function iA(e){var t=[St,de("personList",null,{xmlns:Pt.TCMNT,"xmlns:x":va[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(de("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function oA(e){var t={};t.iauthor=e.read_shift(4);var r=ka(e);return t.rfx=r.s,t.ref=be(r.s),e.l+=16,t}function lA(e,t){return t==null&&(t=Y(36)),t.write_shift(4,e[1].iauthor),Ni(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cA=nr;function uA(e){return Ut(e.slice(0,54))}function fA(e,t){var r=[],n=[],s={},a=!1;return Jn(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function hA(e){var t=Er(),r=[];return te(t,628),te(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),te(t,632,uA(s.a)))})}),te(t,631),te(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:ft(n[0]),e:ft(n[0])};te(t,635,lA([a,s])),s.t&&s.t.length>0&&te(t,637,Ib(s)),te(t,636),delete s.iauthor})}),te(t,634),te(t,629),t.end()}var dA="application/vnd.ms-office.vbaProject";function mA(e){var t=_e.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_e.utils.cfb_add(t,s,e.FileIndex[n].content)}}),_e.write(t)}function gA(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&_e.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var Yw=["xlsb","xlsm","xlam","biff8","xla"];function pA(){return{"!type":"dialog"}}function xA(){return{"!type":"dialog"}}function vA(){return{"!type":"macro"}}function wA(){return{"!type":"macro"}}var ai=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,s+(o?"":"$")+ut(u)+(l?"":"$")+kt(c)}return function(s,a){return t=a,s.replace(e,r)}}(),yd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_d=function(){return function(t,r){return t.replace(yd,function(n,s,a,i,o,l){var c=od(i)-(a?0:r.c),u=id(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":a?c+1:"["+c+"]";return s+"R"+h+"C"+d})}}();function Jw(e,t){return e.replace(yd,function(r,n,s,a,i,o){return n+(s=="$"?s+a:ut(od(a)+t.c))+(i=="$"?i+o:kt(id(o)+t.r))})}function yA(e,t,r){var n=br(t),s=n.s,a=ft(r),i={r:a.r-s.r,c:a.c-s.c};return Jw(e,i)}function _A(e){return e.length!=1}function fp(e){return e.replace(/_xlfn\./g,"")}function Et(e){e.l+=1}function As(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function Zw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ey(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=As(e,2),o=As(e,2);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function ey(e){var t=As(e,2),r=As(e,2),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function kA(e,t,r){if(r.biff<8)return ey(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=As(e,2),i=As(e,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function ty(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SA(e);var n=e.read_shift(r&&r.biff==12?4:2),s=As(e,2);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function SA(e){var t=As(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function EA(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function bA(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return TA(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function TA(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function NA(e,t,r){var n=(e[e.l++]&96)>>5,s=Zw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function CA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=Zw(e,a,r);return[n,s,i]}function AA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FA(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function jA(e,t,r){var n=(e[e.l++]&96)>>5,s=kA(e,t-1,r);return[n,s]}function OA(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function hp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function PA(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function IA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function DA(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function LA(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function ry(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MA(e){return e.read_shift(2),ry(e)}function BA(e){return e.read_shift(2),ry(e)}function UA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=ty(e,0,r);return[n,s]}function $A(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=bA(e,0,r);return[n,s]}function HA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=ty(e,0,r);return[n,s,a]}function WA(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[G6[s],ay[s],n]}function zA(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:VA(e);return[s,(a[0]===0?ay:V6)[a[1]]]}function VA(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function GA(e,t,r){e.l+=r&&r.biff==2?3:4}function KA(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XA(e){return e.l++,Zn[e.read_shift(1)]}function qA(e){return e.l++,e.read_shift(2)}function QA(e){return e.l++,e.read_shift(1)!==0}function YA(e){return e.l++,rr(e)}function JA(e,t,r){return e.l++,fl(e,t-1,r)}function ZA(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Zn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=rr(e);break;case 2:r[1]=Sa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function e6(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?ka:S0)(e));return s}function t6(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=ZA(e,r.biff);return i}function r6(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function n6(e,t,r){if(r.biff==5)return s6(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function s6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function a6(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function i6(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function o6(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function l6(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var c6=ar,u6=ar,f6=ar;function dl(e,t,r){return e.l+=2,[EA(e)]}function kd(e){return e.l+=6,[]}var h6=dl,d6=kd,m6=kd,g6=dl;function ny(e){return e.l+=2,[Tt(e),e.read_shift(2)&1]}var p6=dl,x6=ny,v6=kd,w6=dl,y6=dl,_6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function k6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=_6[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function S6(e){return e.l+=2,[e.read_shift(4)]}function E6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function b6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function T6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function N6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function C6(e){return e.l+=4,[0,0]}var dp={1:{n:"PtgExp",f:KA},2:{n:"PtgTbl",f:f6},3:{n:"PtgAdd",f:Et},4:{n:"PtgSub",f:Et},5:{n:"PtgMul",f:Et},6:{n:"PtgDiv",f:Et},7:{n:"PtgPower",f:Et},8:{n:"PtgConcat",f:Et},9:{n:"PtgLt",f:Et},10:{n:"PtgLe",f:Et},11:{n:"PtgEq",f:Et},12:{n:"PtgGe",f:Et},13:{n:"PtgGt",f:Et},14:{n:"PtgNe",f:Et},15:{n:"PtgIsect",f:Et},16:{n:"PtgUnion",f:Et},17:{n:"PtgRange",f:Et},18:{n:"PtgUplus",f:Et},19:{n:"PtgUminus",f:Et},20:{n:"PtgPercent",f:Et},21:{n:"PtgParen",f:Et},22:{n:"PtgMissArg",f:Et},23:{n:"PtgStr",f:JA},26:{n:"PtgSheet",f:E6},27:{n:"PtgEndSheet",f:b6},28:{n:"PtgErr",f:XA},29:{n:"PtgBool",f:QA},30:{n:"PtgInt",f:qA},31:{n:"PtgNum",f:YA},32:{n:"PtgArray",f:OA},33:{n:"PtgFunc",f:WA},34:{n:"PtgFuncVar",f:zA},35:{n:"PtgName",f:r6},36:{n:"PtgRef",f:UA},37:{n:"PtgArea",f:NA},38:{n:"PtgMemArea",f:a6},39:{n:"PtgMemErr",f:c6},40:{n:"PtgMemNoMem",f:u6},41:{n:"PtgMemFunc",f:i6},42:{n:"PtgRefErr",f:o6},43:{n:"PtgAreaErr",f:AA},44:{n:"PtgRefN",f:$A},45:{n:"PtgAreaN",f:jA},46:{n:"PtgMemAreaN",f:T6},47:{n:"PtgMemNoMemN",f:N6},57:{n:"PtgNameX",f:n6},58:{n:"PtgRef3d",f:HA},59:{n:"PtgArea3d",f:CA},60:{n:"PtgRefErr3d",f:l6},61:{n:"PtgAreaErr3d",f:FA},255:{}},A6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},F6={1:{n:"PtgElfLel",f:ny},2:{n:"PtgElfRw",f:w6},3:{n:"PtgElfCol",f:h6},6:{n:"PtgElfRwV",f:y6},7:{n:"PtgElfColV",f:g6},10:{n:"PtgElfRadical",f:p6},11:{n:"PtgElfRadicalS",f:v6},13:{n:"PtgElfColS",f:d6},15:{n:"PtgElfColSV",f:m6},16:{n:"PtgElfRadicalLel",f:x6},25:{n:"PtgList",f:k6},29:{n:"PtgSxName",f:S6},255:{}},j6={0:{n:"PtgAttrNoop",f:C6},1:{n:"PtgAttrSemi",f:LA},2:{n:"PtgAttrIf",f:RA},4:{n:"PtgAttrChoose",f:PA},8:{n:"PtgAttrGoto",f:IA},16:{n:"PtgAttrSum",f:GA},32:{n:"PtgAttrBaxcel",f:hp},33:{n:"PtgAttrBaxcel",f:hp},64:{n:"PtgAttrSpace",f:MA},65:{n:"PtgAttrSpaceSemi",f:BA},128:{n:"PtgAttrIfError",f:DA},255:{}};function ml(e,t,r,n){if(n.biff<8)return ar(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=t6(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=e6(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(ar(e,t)),a}function gl(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=dp[a]||dp[A6[a]],(a===24||a===25)&&(s=(a===24?F6:j6)[e[e.l+1]]),!s||!s.f?ar(e,t):i.push([s.n,s.f(e,t,r)]);return i}function O6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var P6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function I6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function sy(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function mp(e,t,r){var n=sy(e,t,r);return n=="#REF"?n:I6(n,r)}function Zt(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,d=0,m,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,v="",w=0,y=e[0].length;w<y;++w){var p=e[0][w];switch(p[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:v=gt(" ",e[0][g][1][1]);break;case 1:v=gt("\r",e[0][g][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+v,g=-1}o.push(c+P6[p[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=mo(p[1][1],i,s),o.push(go(u,a));break;case"PtgRefN":u=r?mo(p[1][1],r,s):p[1][1],o.push(go(u,a));break;case"PtgRef3d":h=p[1][1],u=mo(p[1][2],i,s),x=mp(n,h,s),o.push(x+"!"+go(u,a));break;case"PtgFunc":case"PtgFuncVar":var _=p[1][0],S=p[1][1];_||(_=0),_&=127;var E=_==0?[]:o.slice(-_);o.length-=_,S==="User"&&(S=E.shift()),o.push(S+"("+E.join(",")+")");break;case"PtgBool":o.push(p[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(p[1]);break;case"PtgNum":o.push(String(p[1]));break;case"PtgStr":o.push('"'+p[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(p[1]);break;case"PtgAreaN":m=Wg(p[1][1],r?{s:r}:i,s),o.push(du(m,s));break;case"PtgArea":m=Wg(p[1][1],i,s),o.push(du(m,s));break;case"PtgArea3d":h=p[1][1],m=p[1][2],x=mp(n,h,s),o.push(x+"!"+du(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=p[1][2];var k=(n.names||[])[d-1]||(n[0]||[])[d],C=k?k.Name:"SH33TJSNAME"+String(d);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var T=p[1][1];d=p[1][2];var R;if(s.biff<=5)T<0&&(T=-T),n[T]&&(R=n[T][d]);else{var L="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][d]&&n[T][d].itab>0&&(L=n.SheetNames[n[T][d].itab-1]+"!"):L=n.SheetNames[d-1]+"!"),n[T]&&n[T][d])L+=n[T][d].Name;else if(n[0]&&n[0][d])L+=n[0][d].Name;else{var D=(sy(n,T,s)||"").split(";;");D[d-1]?L=D[d-1]:L+="SH33TJSERRX"}o.push(L);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var q="(",oe=")";if(g>=0){switch(v="",e[0][g][1][0]){case 2:q=gt(" ",e[0][g][1][1])+q;break;case 3:q=gt("\r",e[0][g][1][1])+q;break;case 4:oe=gt(" ",e[0][g][1][1])+oe;break;case 5:oe=gt("\r",e[0][g][1][1])+oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(q+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:p[1][1],r:p[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[be(u)]){var ee=n.sharedf[be(u)];o.push(Zt(ee,i,W,n,s))}else{var ne=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Zt(c[1],i,W,n,s)),ne=!0;break}ne||o.push(p[1])}break;case"PtgArray":o.push("{"+O6(p[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+p[1].idx+"[#"+p[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(p));default:throw new Error("Unrecognized Formula Token: "+String(p))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&Z.indexOf(e[0][w][0])==-1){p=e[0][g];var U=!0;switch(p[1][0]){case 4:U=!1;case 0:v=gt(" ",p[1][1]);break;case 5:U=!1;case 1:v=gt("\r",p[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+p[1][0])}o.push((U?v:"")+o.pop()+(U?"":v)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function R6(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],ar(e,t-2)];var o=gl(e,i,r);return t!==i+s&&(a=ml(e,t-i-s,o,r)),e.l=n,[o,a]}function D6(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],ar(e,t-2)];var o=gl(e,i,r);return t!==i+s&&(a=ml(e,t-i-s,o,r)),e.l=n,[o,a]}function L6(e,t,r,n){var s=e.l+t,a=gl(e,n,r),i;return s!==e.l&&(i=ml(e,s-e.l,a,r)),[a,i]}function M6(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=gl(e,a,r);return a==65535?[[],ar(e,t-2)]:(t!==a+2&&(s=ml(e,n-a-2,i,r)),[i,s])}function B6(e){var t;if(Un(e,e.l+6)!==65535)return[rr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function U6(e){if(e==null){var t=Y(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ua(e);return ua(0)}function vu(e,t,r){var n=e.l+t,s=Pn(e);r.biff==2&&++e.l;var a=B6(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=D6(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function $6(e,t,r,n,s){var a=ha(t,r,s),i=U6(e.v),o=Y(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Y(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Bt([a,i,o,c]);return h}function E0(e,t,r){var n=e.read_shift(4),s=gl(e,n,r),a=e.read_shift(4),i=a>0?ml(e,a,s,r):null;return[s,i]}var H6=E0,b0=E0,W6=E0,z6=E0,V6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ay={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},G6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function gp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function K6(e){var t="of:="+e.replace(yd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function wu(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function X6(e){return e.replace(/\./,"!")}var xo={},ii={},vo=typeof Map<"u";function Sd(e,t,r){var n=0,s=e.length;if(r){if(vo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=vo?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(vo?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function T0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(tr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=qo(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Kc(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ra(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ls(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Wn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function iy(e,t,r,n,s,a){try{n.cellNF&&(e.z=Se[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=nt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Se[t]==null&&Wn(GE[t]||"General",t),e.t==="e")e.w=e.w||Zn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ho(e.v);else if(e.t==="d"){var i=Rt(e.v);(i|0)===i?e.w=i.toString(10):e.w=Ho(i)}else{if(e.v===void 0)return"";e.w=la(e.v,ii)}else e.t==="d"?e.w=tn(t,Rt(e.v),ii):e.w=tn(t,e.v,ii)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Gc(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Gc(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function q6(e,t,r){if(e&&e["!ref"]){var n=We(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Q6(e,t){var r=We(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=je(r))}var Y6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,J6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Z6=/<(?:\w:)?hyperlink [^>]*>/mg,e5=/"(\w*:\w*)"/,t5=/<(?:\w:)?col\b[^>]*[\/]?>/g,r5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,n5=/<(?:\w:)?pageMargins[^>]*\/>/g,oy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,s5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,a5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function i5(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(J6);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var d=c.match(oy);d?Ed(d[0],o,s,r):(d=c.match(s5))&&l5(d[0],d[1]||"",o,s,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=c.slice(m,m+50).match(e5);x&&Q6(o,x[1])}var g=c.match(a5);g&&g[1]&&_5(g[1],s);var v=[];if(t.cellStyles){var w=c.match(t5);w&&p5(v,w)}h&&E5(h[1],o,t,l,a,i);var y=u.match(r5);y&&(o["!autofilter"]=v5(y[0]));var p=[],_=u.match(Y6);if(_)for(m=0;m!=_.length;++m)p[m]=We(_[m].slice(_[m].indexOf('"')+1));var S=u.match(Z6);S&&d5(o,S,n);var E=u.match(n5);if(E&&(o["!margins"]=m5(Te(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=je(l)),t.sheetRows>0&&o["!ref"]){var k=We(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=je(k))}return v.length>0&&(o["!cols"]=v),p.length>0&&(o["!merges"]=p),o}function o5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+je(e[r])+'"/>';return t+"</mergeCells>"}function Ed(e,t,r,n){var s=Te(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=He(Ye(s.codeName)))}function l5(e,t,r,n,s){Ed(e.slice(0,e.indexOf(">")),r,n,s)}function c5(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,i.codeName=Cn(qe(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+de("outlinePr",null,c)}!a&&!o||(s[s.length]=de("sheetPr",o,i))}var u5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],f5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function h5(e){var t={sheet:1};return u5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),f5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=xd(e.password).toString(16).toUpperCase()),de("sheetProtection",null,t)}function d5(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Te(Ye(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+He(a.location))):(a.Target="#"+He(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=We(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=be({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function m5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function g5(e){return ra(e),de("pageMargins",null,e)}function p5(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Te(t[n],!0);s.hidden&&(s.hidden=tt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,vd(s.width)),Cs(s);a<=i;)e[a++]=st(s)}}function x5(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=de("col",null,T0(s,n)));return r[r.length]="</cols>",r.join("")}function v5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function w5(e,t,r,n){var s=typeof e.ref=="string"?e.ref:je(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=br(s);i.s.r==i.e.r&&(i.e.r=br(t["!ref"]).e.r,s=je(i));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),de("autoFilter",null,{ref:s})}var y5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function _5(e,t){t.Views||(t.Views=[{}]),(e.match(y5)||[]).forEach(function(r,n){var s=Te(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),tt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function k5(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),de("sheetViews",de("sheetView",null,s),{})}function S5(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Zn[e.v];break;case"d":n&&n.cellDates?s=nt(e.v,-1).toISOString():(e=st(e),e.t="n",s=""+(e.v=Rt(nt(e.v)))),typeof e.z>"u"&&(e.z=Se[14]);break;default:s=e.v;break}var o=Vt("v",qe(s)),l={r:t},c=Ls(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Vt("v",""+Sd(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=de("f",qe(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),de("c",o,l)}var E5=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Wo("v"),i=Wo("f");return function(l,c,u,h,d,m){for(var x=0,g="",v=[],w=[],y=0,p=0,_=0,S="",E,k,C=0,T=0,R,L,D=0,q=0,oe=Array.isArray(m.CellXf),W,ee=[],ne=[],Z=Array.isArray(c),U=[],re={},ge=!1,O=!!u.sheetStubs,H=l.split(t),M=0,B=H.length;M!=B;++M){g=H[M].trim();var Q=g.length;if(Q!==0){var ie=0;e:for(x=0;x<Q;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(k=Te(g.slice(ie,x),!0),C=k.r!=null?parseInt(k.r,10):C+1,T=-1,u.sheetRows&&u.sheetRows<C)continue;re={},ge=!1,k.ht&&(ge=!0,re.hpt=parseFloat(k.ht),re.hpx=vi(re.hpt)),k.hidden=="1"&&(ge=!0,re.hidden=!0),k.outlineLevel!=null&&(ge=!0,re.level=+k.outlineLevel),ge&&(U[C-1]=re)}break;case"<":ie=x;break}if(ie>=x)break;if(k=Te(g.slice(ie,x),!0),C=k.r!=null?parseInt(k.r,10):C+1,T=-1,!(u.sheetRows&&u.sheetRows<C)){h.s.r>C-1&&(h.s.r=C-1),h.e.r<C-1&&(h.e.r=C-1),u&&u.cellStyles&&(re={},ge=!1,k.ht&&(ge=!0,re.hpt=parseFloat(k.ht),re.hpx=vi(re.hpt)),k.hidden=="1"&&(ge=!0,re.hidden=!0),k.outlineLevel!=null&&(ge=!0,re.level=+k.outlineLevel),ge&&(U[C-1]=re)),v=g.slice(x).split(e);for(var ue=0;ue!=v.length&&v[ue].trim().charAt(0)=="<";++ue);for(v=v.slice(ue),x=0;x!=v.length;++x)if(g=v[x].trim(),g.length!==0){if(w=g.match(r),y=x,p=0,_=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(y=0,S=w[1],p=0;p!=S.length&&!((_=S.charCodeAt(p)-64)<1||_>26);++p)y=26*y+_;--y,T=y}else++T;for(p=0;p!=g.length&&g.charCodeAt(p)!==62;++p);if(++p,k=Te(g.slice(0,p),!0),k.r||(k.r=be({r:C-1,c:T})),S=g.slice(p),E={t:""},(w=S.match(a))!=null&&w[1]!==""&&(E.v=He(w[1])),u.cellFormula){if((w=S.match(i))!=null&&w[1]!==""){if(E.f=He(Ye(w[1])).replace(/\r\n/g,`
`),u.xlfn||(E.f=fp(E.f)),w[0].indexOf('t="array"')>-1)E.F=(S.match(s)||[])[1],E.F.indexOf(":")>-1&&ee.push([We(E.F),E.F]);else if(w[0].indexOf('t="shared"')>-1){L=Te(w[0]);var ae=He(Ye(w[1]));u.xlfn||(ae=fp(ae)),ne[parseInt(L.si,10)]=[L,ae,k.r]}}else(w=S.match(/<f[^>]*\/>/))&&(L=Te(w[0]),ne[L.si]&&(E.f=yA(ne[L.si][1],ne[L.si][2],k.r)));var se=ft(k.r);for(p=0;p<ee.length;++p)se.r>=ee[p][0].s.r&&se.r<=ee[p][0].e.r&&se.c>=ee[p][0].s.c&&se.c<=ee[p][0].e.c&&(E.F=ee[p][1])}if(k.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(O)E.t="z";else continue;else E.t=k.t||"n";switch(h.s.c>T&&(h.s.c=T),h.e.c<T&&(h.e.c=T),E.t){case"n":if(E.v==""||E.v==null){if(!O)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!O)continue;E.t="z"}else R=xo[parseInt(E.v,10)],E.v=R.t,E.r=R.r,u.cellHTML&&(E.h=R.h);break;case"str":E.t="s",E.v=E.v!=null?Ye(E.v):"",u.cellHTML&&(E.h=rd(E.v));break;case"inlineStr":w=S.match(n),E.t="s",w!=null&&(R=pd(w[1]))?(E.v=R.t,u.cellHTML&&(E.h=R.h)):E.v="";break;case"b":E.v=tt(E.v);break;case"d":u.cellDates?E.v=nt(E.v,1):(E.v=Rt(nt(E.v,1)),E.t="n");break;case"e":(!u||u.cellText!==!1)&&(E.w=E.v),E.v=cw[E.v];break}if(D=q=0,W=null,oe&&k.s!==void 0&&(W=m.CellXf[k.s],W!=null&&(W.numFmtId!=null&&(D=W.numFmtId),u.cellStyles&&W.fillId!=null&&(q=W.fillId))),iy(E,D,q,u,d,m),u.cellDates&&oe&&E.t=="n"&&Ei(Se[D])&&(E.t="d",E.v=k0(E.v)),k.cm&&u.xlmeta){var Ne=(u.xlmeta.Cell||[])[+k.cm-1];Ne&&Ne.type=="XLDAPR"&&(E.D=!0)}if(Z){var N=ft(k.r);c[N.r]||(c[N.r]=[]),c[N.r][N.c]=E}else c[k.r]=E}}}}U.length>0&&(c["!rows"]=U)}}();function b5(e,t,r,n){var s=[],a=[],i=We(e["!ref"]),o="",l,c="",u=[],h=0,d=0,m=e["!rows"],x=Array.isArray(e),g={r:c},v,w=-1;for(d=i.s.c;d<=i.e.c;++d)u[d]=ut(d);for(h=i.s.r;h<=i.e.r;++h){for(a=[],c=kt(h),d=i.s.c;d<=i.e.c;++d){l=u[d]+c;var y=x?(e[h]||[])[d]:e[l];y!==void 0&&(o=S5(y,l,e,t))!=null&&a.push(o)}(a.length>0||m&&m[h])&&(g={r:c},m&&m[h]&&(v=m[h],v.hidden&&(g.hidden=1),w=-1,v.hpx?w=Qo(v.hpx):v.hpt&&(w=v.hpt),w>-1&&(g.ht=w,g.customHeight=1),v.level&&(g.outlineLevel=v.level)),s[s.length]=de("row",a.join(""),g))}if(m)for(;h<m.length;++h)m&&m[h]&&(g={r:h+1},v=m[h],v.hidden&&(g.hidden=1),w=-1,v.hpx?w=Qo(v.hpx):v.hpt&&(w=v.hpt),w>-1&&(g.ht=w,g.customHeight=1),v.level&&(g.outlineLevel=v.level),s[s.length]=de("row","",g));return s.join("")}function ly(e,t,r,n){var s=[St,de("worksheet",null,{xmlns:va[0],"xmlns:r":Pt.r})],a=r.SheetNames[e],i=0,o="",l=r.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",u=We(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=je(u)}n||(n={}),l["!comments"]=[];var h=[];c5(l,r,e,t,s),s[s.length]=de("dimension",null,{ref:c}),s[s.length]=k5(l,t,e,r),t.sheetFormat&&(s[s.length]=de("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=x5(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=b5(l,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=h5(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=w5(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=o5(l["!merges"]));var d=-1,m,x=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=Xe(n,-1,qe(g[1].Target).replace(/#.*$/,""),Be.HLINK),m["r:id"]="rId"+x),(d=g[1].Target.indexOf("#"))>-1&&(m.location=qe(g[1].Target.slice(d+1))),g[1].Tooltip&&(m.tooltip=qe(g[1].Tooltip)),s[s.length]=de("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=g5(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Vt("ignoredErrors",de("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(x=Xe(n,-1,"../drawings/drawing"+(e+1)+".xml",Be.DRAW),s[s.length]=de("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=h),l["!comments"].length>0&&(x=Xe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Be.VML),s[s.length]=de("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function T5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function N5(e,t,r){var n=Y(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Qo(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,m=u<<10;m<u+1<<10;++m){c.c=m;var x=Array.isArray(r)?(r[c.r]||[])[c.c]:r[be(c)];x&&(h<0&&(h=m),d=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function C5(e,t,r,n){var s=N5(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&te(e,0,s)}var A5=ka,F5=Ni;function j5(){}function O5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Rb(e),r}function P5(e,t,r){r==null&&(r=Y(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Wc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),sw(e,r),r.slice(0,r.l)}function I5(e){var t=rn(e);return[t]}function R5(e,t,r){return r==null&&(r=Y(8)),wa(t,r)}function D5(e){var t=ya(e);return[t]}function L5(e,t,r){return r==null&&(r=Y(4)),_a(t,r)}function M5(e){var t=rn(e),r=e.read_shift(1);return[t,r,"b"]}function B5(e,t,r){return r==null&&(r=Y(9)),wa(t,r),r.write_shift(1,e.v?1:0),r}function U5(e){var t=ya(e),r=e.read_shift(1);return[t,r,"b"]}function $5(e,t,r){return r==null&&(r=Y(5)),_a(t,r),r.write_shift(1,e.v?1:0),r}function H5(e){var t=rn(e),r=e.read_shift(1);return[t,r,"e"]}function W5(e,t,r){return r==null&&(r=Y(9)),wa(t,r),r.write_shift(1,e.v),r}function z5(e){var t=ya(e),r=e.read_shift(1);return[t,r,"e"]}function V5(e,t,r){return r==null&&(r=Y(8)),_a(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function G5(e){var t=rn(e),r=e.read_shift(4);return[t,r,"s"]}function K5(e,t,r){return r==null&&(r=Y(12)),wa(t,r),r.write_shift(4,t.v),r}function X5(e){var t=ya(e),r=e.read_shift(4);return[t,r,"s"]}function q5(e,t,r){return r==null&&(r=Y(8)),_a(t,r),r.write_shift(4,t.v),r}function Q5(e){var t=rn(e),r=rr(e);return[t,r,"n"]}function Y5(e,t,r){return r==null&&(r=Y(16)),wa(t,r),ua(e.v,r),r}function cy(e){var t=ya(e),r=rr(e);return[t,r,"n"]}function J5(e,t,r){return r==null&&(r=Y(12)),_a(t,r),ua(e.v,r),r}function Z5(e){var t=rn(e),r=fd(e);return[t,r,"n"]}function eF(e,t,r){return r==null&&(r=Y(12)),wa(t,r),aw(e.v,r),r}function tF(e){var t=ya(e),r=fd(e);return[t,r,"n"]}function rF(e,t,r){return r==null&&(r=Y(8)),_a(t,r),aw(e.v,r),r}function nF(e){var t=rn(e),r=ld(e);return[t,r,"is"]}function sF(e){var t=rn(e),r=nr(e);return[t,r,"str"]}function aF(e,t,r){return r==null&&(r=Y(12+4*e.v.length)),wa(t,r),Ut(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iF(e){var t=ya(e),r=nr(e);return[t,r,"str"]}function oF(e,t,r){return r==null&&(r=Y(8+4*e.v.length)),_a(t,r),Ut(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lF(e,t,r){var n=e.l+t,s=rn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=b0(e,n-e.l,r);i[3]=Zt(o,null,s,r.supbooks,r)}else e.l=n;return i}function cF(e,t,r){var n=e.l+t,s=rn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=b0(e,n-e.l,r);i[3]=Zt(o,null,s,r.supbooks,r)}else e.l=n;return i}function uF(e,t,r){var n=e.l+t,s=rn(e);s.r=r["!row"];var a=rr(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=b0(e,n-e.l,r);i[3]=Zt(o,null,s,r.supbooks,r)}else e.l=n;return i}function fF(e,t,r){var n=e.l+t,s=rn(e);s.r=r["!row"];var a=nr(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=b0(e,n-e.l,r);i[3]=Zt(o,null,s,r.supbooks,r)}else e.l=n;return i}var hF=ka,dF=Ni;function mF(e,t){return t==null&&(t=Y(4)),t.write_shift(4,e),t}function gF(e,t){var r=e.l+t,n=ka(e),s=cd(e),a=nr(e),i=nr(e),o=nr(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function pF(e,t){var r=Y(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ni({s:ft(e[0]),e:ft(e[0])},r),ud("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Ut(s||"",r),Ut(e[1].Tooltip||"",r),Ut("",r),r.slice(0,r.l)}function xF(){}function vF(e,t,r){var n=e.l+t,s=iw(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=H6(e,n-e.l,r);i[1]=o}else e.l=n;return i}function wF(e,t,r){var n=e.l+t,s=ka(e),a=[s];if(r.cellFormula){var i=z6(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function yF(e,t,r){r==null&&(r=Y(18));var n=T0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var uy=["left","right","top","bottom","header","footer"];function _F(e){var t={};return uy.forEach(function(r){t[r]=rr(e)}),t}function kF(e,t){return t==null&&(t=Y(6*8)),ra(e),uy.forEach(function(r){ua(e[r],t)}),t}function SF(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function EF(e,t,r){r==null&&(r=Y(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function bF(e){var t=Y(24);return t.write_shift(4,4),t.write_shift(4,1),Ni(e,t),t}function TF(e,t){return t==null&&(t=Y(16*4+2)),t.write_shift(2,e.password?xd(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function NF(){}function CF(){}function AF(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,x,g,v,w,y,p,_,S,E=[];o.biff=12,o["!row"]=0;var k=0,C=!1,T=[],R={},L=o.supbooks||s.supbooks||[[]];if(L.sharedf=R,L.arrayf=T,L.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=L,s.Names))for(var D=0;D<s.Names.length;++D)L[0][D+1]=s.Names[D];var q=[],oe=[],W=!1;Yo[16]={n:"BrtShortReal",f:cy};var ee;if(Jn(e,function(U,re,ge){if(!d)switch(ge){case 148:c=U;break;case 0:m=U,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),_=kt(v=m.r),o["!row"]=m.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=vi(U.hpt)),oe[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:U[2]},U[2]){case"n":x.v=U[1];break;case"s":p=xo[U[1]],x.v=p.t,x.r=p.r;break;case"b":x.v=!!U[1];break;case"e":x.v=U[1],o.cellText!==!1&&(x.w=Zn[x.v]);break;case"str":x.t="s",x.v=U[1];break;case"is":x.t="s",x.v=U[1].t;break}if((g=i.CellXf[U[0].iStyleRef])&&iy(x,g.numFmtId,null,o,a,i),w=U[0].c==-1?w+1:U[0].c,o.dense?(l[v]||(l[v]=[]),l[v][w]=x):l[ut(w)+_]=x,o.cellFormula){for(C=!1,k=0;k<T.length;++k){var O=T[k];m.r>=O[0].s.r&&m.r<=O[0].e.r&&w>=O[0].s.c&&w<=O[0].e.c&&(x.F=je(O[0]),C=!0)}!C&&U.length>3&&(x.f=U[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>w&&(u.s.c=w),u.e.r<m.r&&(u.e.r=m.r),u.e.c<w&&(u.e.c=w),o.cellDates&&g&&x.t=="n"&&Ei(Se[g.numFmtId])){var H=Qs(x.v);H&&(x.t="d",x.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}ee&&(ee.type=="XLDAPR"&&(x.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},w=U[0].c==-1?w+1:U[0].c,o.dense?(l[v]||(l[v]=[]),l[v][w]=x):l[ut(w)+_]=x,u.s.r>m.r&&(u.s.r=m.r),u.s.c>w&&(u.s.c=w),u.e.r<m.r&&(u.e.r=m.r),u.e.c<w&&(u.e.c=w),ee&&(ee.type=="XLDAPR"&&(x.D=!0),ee=void 0);break;case 176:E.push(U);break;case 49:ee=((o.xlmeta||{}).Cell||[])[U-1];break;case 494:var M=n["!id"][U.relId];for(M?(U.Target=M.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=M):U.relId==""&&(U.Target="#"+U.loc),v=U.rfx.s.r;v<=U.rfx.e.r;++v)for(w=U.rfx.s.c;w<=U.rfx.e.c;++w)o.dense?(l[v]||(l[v]=[]),l[v][w]||(l[v][w]={t:"z",v:void 0}),l[v][w].l=U):(y=be({c:w,r:v}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=U);break;case 426:if(!o.cellFormula)break;T.push(U),S=o.dense?l[v][w]:l[ut(w)+_],S.f=Zt(U[1],u,{r:m.r,c:w},L,o),S.F=je(U[0]);break;case 427:if(!o.cellFormula)break;R[be(U[0].s)]=U[1],S=o.dense?l[v][w]:l[ut(w)+_],S.f=Zt(U[1],u,{r:m.r,c:w},L,o);break;case 60:if(!o.cellStyles)break;for(;U.e>=U.s;)q[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},W||(W=!0,vd(U.w/256)),Cs(q[U.e+1]);break;case 161:l["!autofilter"]={ref:je(U)};break;case 476:l["!margins"]=U;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),U.name&&(s.Sheets[r].CodeName=U.name),(U.above||U.left)&&(l["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!re.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=je(c||u)),o.sheetRows&&l["!ref"]){var ne=We(l["!ref"]);o.sheetRows<=+ne.e.r&&(ne.e.r=o.sheetRows-1,ne.e.r>u.e.r&&(ne.e.r=u.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>u.e.c&&(ne.e.c=u.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),l["!fullref"]=l["!ref"],l["!ref"]=je(ne))}return E.length>0&&(l["!merges"]=E),q.length>0&&(l["!cols"]=q),oe.length>0&&(l["!rows"]=oe),l}function FF(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=st(t),t.z=t.z||Se[14],t.v=Rt(nt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ls(s.cellXfs,t,s),t.l&&a["!links"].push([be(l),t.l]),t.c&&a["!comments"].push([be(l),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Sd(s.Strings,t.v,s.revStrings),l.t="s",l.v=o,i?te(e,18,q5(t,l)):te(e,7,K5(t,l))):(l.t="str",i?te(e,17,oF(t,l)):te(e,6,aF(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?te(e,13,rF(t,l)):te(e,2,eF(t,l)):i?te(e,16,J5(t,l)):te(e,5,Y5(t,l)),!0;case"b":return l.t="b",i?te(e,15,$5(t,l)):te(e,4,B5(t,l)),!0;case"e":return l.t="e",i?te(e,14,V5(t,l)):te(e,3,W5(t,l)),!0}return i?te(e,12,L5(t,l)):te(e,1,R5(t,l)),!0}function jF(e,t,r,n){var s=We(t["!ref"]||"A1"),a,i="",o=[];te(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){i=kt(u),C5(e,t,s,u);var h=!1;if(u<=s.e.r)for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(o[d]=ut(d)),a=o[d]+i;var m=l?(t[u]||[])[d]:t[a];if(!m){h=!1;continue}h=FF(e,m,u,d,n,t,h)}}te(e,146)}function OF(e,t){!t||!t["!merges"]||(te(e,177,mF(t["!merges"].length)),t["!merges"].forEach(function(r){te(e,176,dF(r))}),te(e,178))}function PF(e,t){!t||!t["!cols"]||(te(e,390),t["!cols"].forEach(function(r,n){r&&te(e,60,yF(n,r))}),te(e,391))}function IF(e,t){!t||!t["!ref"]||(te(e,648),te(e,649,bF(We(t["!ref"]))),te(e,650))}function RF(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Xe(r,-1,n[1].Target.replace(/#.*$/,""),Be.HLINK);te(e,494,pF(n,s))}}),delete t["!links"]}function DF(e,t,r,n){if(t["!comments"].length>0){var s=Xe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Be.VML);te(e,551,ud("rId"+s)),t["!legacy"]=s}}function LF(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:je(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=br(a);o.s.r==o.e.r&&(o.e.r=br(t["!ref"]).e.r,a=je(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),te(e,161,Ni(We(a))),te(e,162)}}function MF(e,t,r){te(e,133),te(e,137,EF(t,r)),te(e,138),te(e,134)}function BF(e,t){t["!protect"]&&te(e,535,TF(t["!protect"]))}function UF(e,t,r,n){var s=Er(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=We(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],te(s,129),(r.vbaraw||i["!outline"])&&te(s,147,P5(o,i["!outline"])),te(s,148,F5(l)),MF(s,i,r.Workbook),PF(s,i),jF(s,i,e,t),BF(s,i),LF(s,i,r,e),OF(s,i),RF(s,i,n),i["!margins"]&&te(s,476,kF(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&IF(s,i),DF(s,i,e,n),te(s,130),s.end()}function $F(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=He((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function HF(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=$F(h);u.s.r=u.s.c=0,u.e.c=o,c=ut(o),d[0].forEach(function(m,x){i[c+kt(x)]={t:"n",v:m,z:d[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=je(u)),i}function WF(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(oy);return o&&Ed(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function zF(e,t){e.l+=10;var r=nr(e);return{name:r}}function VF(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Jn(e,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var bd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],GF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],KF=[],XF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function pp(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=tt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function xp(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=tt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function fy(e){xp(e.WBProps,bd),xp(e.CalcPr,XF),pp(e.WBView,GF),pp(e.Sheets,KF),ii.date1904=tt(e.WBProps.date1904)}function qF(e){return!e.Workbook||!e.Workbook.WBProps?"false":tt(e.Workbook.WBProps.date1904)?"true":"false"}var QF="][*?/\\".split("");function hy(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return QF.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function YF(e,t,r){e.forEach(function(n,s){hy(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function JF(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];YF(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)q6(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var ZF=/<\w+:workbook/;function e8(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(ir,function(l,c){var u=Te(l);switch(On(u[0])){case"<?xml":break;case"<workbook":l.match(ZF)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":bd.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=tt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Ye(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=He(Ye(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Ye(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),tt(u.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=He(Ye(e.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),va.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return fy(r),r}function dy(e){var t=[St];t[t.length]=de("workbook",null,{xmlns:va[0],"xmlns:r":Pt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(bd.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=de("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:qe(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=de("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=de("definedName",qe(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function t8(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=If(e),r.name=nr(e),r}function r8(e,t){return t||(t=Y(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ud(e.strRelID,t),Ut(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function n8(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?nr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function s8(e,t){t||(t=Y(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),sw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function a8(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function i8(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Db(e),i=W6(e,0,r),o=cd(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function o8(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Yo[16]={n:"BrtFRTArchID$",f:a8},Jn(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Zt(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),fy(r),r.Names=a,r.supbooks=i,r}function l8(e,t){te(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};te(e,156,r8(s))}te(e,144)}function c8(e,t){t||(t=Y(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ut("SheetJS",t),Ut(Dc.version,t),Ut(Dc.version,t),Ut("7262",t),t.length>t.l?t.slice(0,t.l):t}function u8(e,t){t||(t=Y(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function f8(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(te(e,135),te(e,158,u8(s)),te(e,136))}}function h8(e,t){var r=Er();return te(r,131),te(r,128,c8()),te(r,153,s8(e.Workbook&&e.Workbook.WBProps||null)),f8(r,e),l8(r,e),te(r,132),r.end()}function d8(e,t,r){return t.slice(-4)===".bin"?o8(e,r):e8(e,r)}function m8(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?AF(e,n,r,s,a,i,o):i5(e,n,r,s,a,i,o)}function g8(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?VF(e,n,r,s,a):WF(e,n,r,s,a)}function p8(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?vA():wA()}function x8(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?pA():xA()}function v8(e,t,r,n){return t.slice(-4)===".bin"?dC(e,r,n):tC(e,r,n)}function w8(e,t,r){return Kw(e,r)}function y8(e,t,r){return t.slice(-4)===".bin"?yN(e,r):xN(e,r)}function _8(e,t,r){return t.slice(-4)===".bin"?fA(e,r):rA(e,r)}function k8(e,t,r){return t.slice(-4)===".bin"?ZC(e):YC(e)}function S8(e,t,r,n){return r.slice(-4)===".bin"?eA(e,t,r,n):void 0}function E8(e,t,r){return t.slice(-4)===".bin"?XC(e,t,r):QC(e,t,r)}function b8(e,t,r){return(t.slice(-4)===".bin"?h8:dy)(e)}function T8(e,t,r,n,s){return(t.slice(-4)===".bin"?UF:ly)(e,r,n,s)}function N8(e,t,r){return(t.slice(-4)===".bin"?SC:Vw)(e,r)}function C8(e,t,r){return(t.slice(-4)===".bin"?SN:Lw)(e,r)}function A8(e,t,r){return(t.slice(-4)===".bin"?hA:Qw)(e)}function F8(e){return(e.slice(-4)===".bin"?qC:Xw)()}var my=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function an(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var s=e.match(my),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(gy),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function j8(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(my),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(gy),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var wo;function O8(e,t){var r=wo[e]||He(e);return r==="General"?la(t):tn(r,t)}function P8(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=tt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=nt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[He(t)]=s}function I8(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Zn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ho(e.v):e.w=la(e.v):e.w=O8(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=wo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ei(n)){var s=Qs(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function R8(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=KN[n.Pattern]||n.Pattern)}e[t.ID]=t}function D8(e,t,r,n,s,a,i,o,l,c){var u="General",h=n.StyleID,d={};c=c||{};var m=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&m.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=tt(e);break;case"String":n.t="s",n.r=Ig(He(e)),n.v=e.indexOf("<")>-1?He(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(nt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=He(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=cw[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Ig(t||e));break}if(I8(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=He(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=ai(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=ai("RC:RC",s):n.ArrayRange&&(n.F=ai(n.ArrayRange,s),l.push([We(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(m.forEach(function(v){!d.patternType&&v.patternType&&(d.patternType=v.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function L8(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function yu(e,t){var r=t||{};bi();var n=qi(nd(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ye(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=st(r);return i.type="string",xi.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(at){s.indexOf("<"+at)>=0&&(a=!0)}),a)return kj(n,r);wo={"General Number":"General","General Date":Se[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Se[15],"Short Date":Se[14],"Long Time":Se[19],"Medium Time":Se[18],"Short Time":Se[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Se[2],Standard:Se[4],Percent:Se[10],Scientific:Se[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],d=r.dense?[]:{},m="",x={},g={},v=an('<Data ss:Type="String">'),w=0,y=0,p=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},E={},k="",C=0,T=[],R={},L={},D=0,q=[],oe=[],W={},ee=[],ne,Z=!1,U=[],re=[],ge={},O=0,H=0,M={Sheets:[],WBProps:{date1904:!1}},B={};Vo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";o=Vo.exec(n);)switch(o[3]=(Q=o[3]).toLowerCase()){case"data":if(Q=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?D8(n.slice(w,o.index),k,v,l[l.length-1][0]=="comment"?W:x,{c:y,r:p},S,ee[y],g,U,r):(k="",v=an(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(x.c=oe),(!r.sheetRows||r.sheetRows>p)&&x.v!==void 0&&(r.dense?(d[p]||(d[p]=[]),d[p][y]=x):d[ut(y)+kt(p)]=x),x.HRef&&(x.l={Target:He(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(O=y+(parseInt(x.MergeAcross,10)|0),H=p+(parseInt(x.MergeDown,10)|0),T.push({s:{c:y,r:p},e:{c:O,r:H}})),!r.sheetStubs)x.MergeAcross?y=O+1:++y;else if(x.MergeAcross||x.MergeDown){for(var ie=y;ie<=O;++ie)for(var ue=p;ue<=H;++ue)(ie>y||ue>p)&&(r.dense?(d[ue]||(d[ue]=[]),d[ue][ie]={t:"z"}):d[ut(ie)+kt(ue)]={t:"z"});y=O+1}else++y;else x=j8(o[0]),x.Index&&(y=+x.Index-1),y<_.s.c&&(_.s.c=y),y>_.e.c&&(_.e.c=y),o[0].slice(-2)==="/>"&&++y,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(p<_.s.r&&(_.s.r=p),p>_.e.r&&(_.e.r=p),o[0].slice(-2)==="/>"&&(g=an(o[0]),g.Index&&(p=+g.Index-1)),y=0,++p):(g=an(o[0]),g.Index&&(p=+g.Index-1),ge={},(g.AutoFitHeight=="0"||g.Height)&&(ge.hpx=parseInt(g.Height,10),ge.hpt=Qo(ge.hpx),re[p]=ge),g.Hidden=="1"&&(ge.hidden=!0,re[p]=ge));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(d["!ref"]=je(_),r.sheetRows&&r.sheetRows<=_.e.r&&(d["!fullref"]=d["!ref"],_.e.r=r.sheetRows-1,d["!ref"]=je(_))),T.length&&(d["!merges"]=T),ee.length>0&&(d["!cols"]=ee),re.length>0&&(d["!rows"]=re),u[m]=d}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=y=0,l.push([o[3],!1]),c=an(o[0]),m=He(c.Name),d=r.dense?[]:{},T=[],U=[],re=[],B={name:m,Hidden:0},M.Sheets.push(B);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ee=[],Z=!1}break;case"style":o[1]==="/"?R8(S,E,r):E=an(o[0]);break;case"numberformat":E.nf=He(an(o[0]).Format||"General"),wo[E.nf]&&(E.nf=wo[E.nf]);for(var ae=0;ae!=392&&Se[ae]!=E.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(Se[ae]==null){Wn(E.nf,ae);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ne=an(o[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!Z&&ne.wpx>10){Z=!0,tr=Ww;for(var se=0;se<ee.length;++se)ee[se]&&Cs(ee[se])}Z&&Cs(ne),ee[ne.Index-1||ee.length]=ne;for(var Ne=0;Ne<+ne.Span;++Ne)ee[ee.length]=st(ne);break;case"namedrange":if(o[1]==="/")break;M.Names||(M.Names=[]);var N=Te(o[0]),Ee={Name:N.Name,Ref:ai(N.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(Ee.Sheet=M.Sheets.length-1),M.Names.push(Ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=an(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?oT(R,Q,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));L8(W),oe.push(W)}else l.push([o[3],!1]),c=an(o[0]),W={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var De=an(o[0]);d["!autofilter"]={ref:ai(De.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return kp(n,r);var ze=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ze=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ze=!1}break;case"excelworkbook":switch(o[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ze=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ze=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else D=o.index+o[0].length;break;case"header":d["!margins"]||ra(d["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(d["!margins"].header=+Te(o[0]).Margin);break;case"footer":d["!margins"]||ra(d["!margins"]={},"xlml"),isNaN(+Te(o[0]).Margin)||(d["!margins"].footer=+Te(o[0]).Margin);break;case"pagemargins":var Pe=Te(o[0]);d["!margins"]||ra(d["!margins"]={},"xlml"),isNaN(+Pe.Top)||(d["!margins"].top=+Pe.Top),isNaN(+Pe.Left)||(d["!margins"].left=+Pe.Left),isNaN(+Pe.Right)||(d["!margins"].right=+Pe.Right),isNaN(+Pe.Bottom)||(d["!margins"].bottom=+Pe.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ze=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ze=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ze=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ze=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ze=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ze=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ze=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ze=!1}break;case"smarttags":break;default:ze=!1;break}if(ze||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?P8(L,Q,q,n.slice(D,o.index)):(q=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=u),xe.SheetNames=h,xe.Workbook=M,xe.SSF=st(Se),xe.Props=R,xe.Custprops=L,xe}function $f(e,t){switch(Nd(t=t||{}),t.type||"base64"){case"base64":return yu(Dr(e),t);case"binary":case"buffer":case"file":return yu(e,t);case"array":return yu(Rs(e),t)}}function M8(e,t){var r=[];return e.Props&&r.push(lT(e.Props,t)),e.Custprops&&r.push(cT(e.Props,e.Custprops)),r.join("")}function B8(){return""}function U8(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(de("NumberFormat",null,{"ss:Format":qe(Se[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(de("Style",a.join(""),i))}),de("Styles",r.join(""))}function py(e){return de("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_d(e.Ref,{r:0,c:0})})}function $8(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(py(s)))}return de("Names",r.join(""))}function H8(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(py(o)))}return a.join("")}function W8(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(de("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(de("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(de("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(de("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Vt("ProtectContents","True")),e["!protect"].objects&&s.push(Vt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Vt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Vt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Vt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":de("WorksheetOptions",s.join(""),{xmlns:Cr.x})}function z8(e){return e.map(function(t){var r=fb(t.t||""),n=de("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return de("Comment",n,{"ss:Author":t.a})}).join("")}function V8(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+qe(_d(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=ft(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=qe(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=qe(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=i.c||c[u].s.r!=i.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=Zn[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Se[14]);break;case"s":h="String",d=ub(e.v||"");break}var m=Ls(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=i.c+1;var x=e.v!=null?d:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=z8(e.c)),de("Cell",g,o)}function G8(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=vi(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function K8(e,t,r,n){if(!e["!ref"])return"";var s=We(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,w){Cs(v);var y=!!v.width,p=T0(w,v),_={"ss:Index":w+1};y&&(_["ss:Width"]=Xo(p.width)),v.hidden&&(_["ss:Hidden"]="1"),o.push(de("Column",null,_))});for(var l=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var u=[G8(c,(e["!rows"]||[])[c])],h=s.s.c;h<=s.e.c;++h){var d=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>h)&&!(a[i].s.r>c)&&!(a[i].e.c<h)&&!(a[i].e.r<c)){(a[i].s.c!=h||a[i].s.r!=c)&&(d=!0);break}if(!d){var m={r:c,c:h},x=be(m),g=l?(e[c]||[])[h]:e[x];u.push(V8(g,x,e,t,r,n,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function X8(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?H8(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?K8(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(W8(a,t,e,r)),n.join("")}function q8(e,t){t||(t={}),e.SSF||(e.SSF=st(Se)),e.SSF&&(bi(),w0(e.SSF),t.revssf=_0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ls(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(M8(e,t)),r.push(B8()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(de("Worksheet",X8(n,t,e),{"ss:Name":qe(e.SheetNames[n])}));return r[2]=U8(e,t),r[3]=$8(e),St+de("Workbook",r.join(""),{xmlns:Cr.ss,"xmlns:o":Cr.o,"xmlns:x":Cr.x,"xmlns:ss":Cr.ss,"xmlns:dt":Cr.dt,"xmlns:html":Cr.html})}function Q8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=$b(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Hb(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Y8=[60,1084,2066,2165,2175];function J8(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Un(r,r.l),c=Hf[l],u=0;c!=null&&Y8.indexOf(l)>-1;)a=Un(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),i.push(o),r.l+=4+a,c=Hf[l=Un(r,r.l)];var h=Bt(i);zt(h,0);var d=0;h.lens=[];for(var m=0;m<i.length;++m)h.lens.push(d),d+=i[m].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function _n(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Se[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Zn[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ho(e.v):e.w=la(e.v):e.w=tn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Ei(Se[n]||String(n))){var s=Qs(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Kl(e,t,r){return{v:e,ixfe:t,t:r}}function Z8(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],c="",u={},h,d="",m,x,g,v,w={},y=[],p,_,S=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},T=function(Le){return Le<8?Zs[Le]:Le<64&&E[Le-8]||Zs[Le]},R=function(Le,wt,Br){var Ft=wt.XF.data;if(!(!Ft||!Ft.patternType||!Br||!Br.cellStyles)){wt.s={},wt.s.patternType=Ft.patternType;var Ms;(Ms=Ko(T(Ft.icvFore)))&&(wt.s.fgColor={rgb:Ms}),(Ms=Ko(T(Ft.icvBack)))&&(wt.s.bgColor={rgb:Ms})}},L=function(Le,wt,Br){if(!(ge>1)&&!(Br.sheetRows&&Le.r>=Br.sheetRows)){if(Br.cellStyles&&wt.XF&&wt.XF.data&&R(Le,wt,Br),delete wt.ixfe,delete wt.XF,h=Le,d=be(Le),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<i.s.r&&(i.s.r=Le.r),Le.c<i.s.c&&(i.s.c=Le.c),Le.r+1>i.e.r&&(i.e.r=Le.r+1),Le.c+1>i.e.c&&(i.e.c=Le.c+1),Br.cellFormula&&wt.f){for(var Ft=0;Ft<y.length;++Ft)if(!(y[Ft][0].s.c>Le.c||y[Ft][0].s.r>Le.r)&&!(y[Ft][0].e.c<Le.c||y[Ft][0].e.r<Le.r)){wt.F=je(y[Ft][0]),(y[Ft][0].s.c!=Le.c||y[Ft][0].s.r!=Le.r)&&delete wt.f,wt.f&&(wt.f=""+Zt(y[Ft][1],i,Le,U,D));break}}Br.dense?(s[Le.r]||(s[Le.r]=[]),s[Le.r][Le.c]=wt):s[d]=wt}},D={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var q,oe=[],W=[],ee=[],ne=[],Z=!1,U=[];U.SheetNames=D.snames,U.sharedf=D.sharedf,U.arrayf=D.arrayf,U.names=[],U.XTI=[];var re=0,ge=0,O=0,H=[],M=[],B;D.codepage=1200,fn(1200);for(var Q=!1;e.l<e.length-1;){var ie=e.l,ue=e.read_shift(2);if(ue===0&&re===10)break;var ae=e.l===e.length?0:e.read_shift(2),se=Hf[ue];if(se&&se.f){if(t.bookSheets&&re===133&&ue!==133)break;if(re=ue,se.r===2||se.r==12){var Ne=e.read_shift(2);if(ae-=2,!D.enc&&Ne!==ue&&((Ne&255)<<8|Ne>>8)!==ue)throw new Error("rt mismatch: "+Ne+"!="+ue);se.r==12&&(e.l+=10,ae-=10)}var N={};if(ue===10?N=se.f(e,ae,D):N=J8(ue,se,e,ae,D),ge==0&&[9,521,1033,2057].indexOf(re)===-1)continue;switch(ue){case 34:r.opts.Date1904=k.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=N;break;case 66:var Ee=Number(N);switch(Ee){case 21010:Ee=1200;break;case 32768:Ee=1e4;break;case 32769:Ee=1252;break}fn(D.codepage=Ee),Q=!0;break;case 317:D.rrtabid=N;break;case 25:D.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:D.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(s["!type"]="dialog"),N.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),N.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:S.push(N);break;case 430:U.push([N]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(N);break;case 24:case 536:B={Name:N.Name,Ref:Zt(N.rgce,i,null,U,D)},N.itab>0&&(B.Sheet=N.itab-1),U.names.push(B),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(M[N.itab-1]={ref:je(N.rgce[0][0][1][2])});break;case 22:D.ExternCount=N;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(N),U.XTI=U.XTI.concat(N);break;case 2196:if(D.biff<8)break;B!=null&&(B.Comment=N[1]);break;case 18:s["!protect"]=N;break;case 19:N!==0&&D.WTF&&console.error("Password verifier: "+N);break;case 133:a[N.pos]=N,D.snames.push(N.name);break;case 10:{if(--ge)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=je(i),t.sheetRows&&t.sheetRows<=i.e.r){var De=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=je(i),i.e.r=De}i.e.r++,i.e.c++}oe.length>0&&(s["!merges"]=oe),W.length>0&&(s["!objects"]=W),ee.length>0&&(s["!cols"]=ee),ne.length>0&&(s["!rows"]=ne),k.Sheets.push(C)}c===""?u=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),D.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(D.biff=5,Q=!0,fn(D.codepage=28591)),D.biff==8&&N.BIFFVer==0&&N.dt==16&&(D.biff=2),ge++)break;if(s=t.dense?[]:{},D.biff<8&&!Q&&(Q=!0,fn(D.codepage=t.codepage||1252)),D.biff<5||N.BIFFVer==0&&N.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ze={pos:e.l-ae,name:c};a[ze.pos]=ze,D.snames.push(c)}else c=(a[ie]||{name:""}).name;N.dt==32&&(s["!type"]="chart"),N.dt==64&&(s["!type"]="macro"),oe=[],W=[],D.arrayf=y=[],ee=[],ne=[],Z=!1,C={Hidden:(a[ie]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[N.r]||[])[N.c]:s[be({c:N.c,r:N.r})])&&++N.c,p={ixfe:N.ixfe,XF:S[N.ixfe]||{},v:N.val,t:"n"},O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:N.c,r:N.r},p,t);break;case 5:case 517:p={ixfe:N.ixfe,XF:S[N.ixfe],v:N.val,t:N.t},O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:N.c,r:N.r},p,t);break;case 638:p={ixfe:N.ixfe,XF:S[N.ixfe],v:N.rknum,t:"n"},O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:N.c,r:N.r},p,t);break;case 189:for(var Pe=N.c;Pe<=N.C;++Pe){var xe=N.rkrec[Pe-N.c][0];p={ixfe:xe,XF:S[xe],v:N.rkrec[Pe-N.c][1],t:"n"},O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:Pe,r:N.r},p,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){o=N;break}if(p=Kl(N.val,N.cell.ixfe,N.tt),p.XF=S[p.ixfe],t.cellFormula){var at=N.formula;if(at&&at[0]&&at[0][0]&&at[0][0][0]=="PtgExp"){var mr=at[0][0][1][0],ke=at[0][0][1][1],Ie=be({r:mr,c:ke});w[Ie]?p.f=""+Zt(N.formula,i,N.cell,U,D):p.F=((t.dense?(s[mr]||[])[ke]:s[Ie])||{}).F}else p.f=""+Zt(N.formula,i,N.cell,U,D)}O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L(N.cell,p,t),o=N}break;case 7:case 519:if(o)o.val=N,p=Kl(N,o.cell.ixfe,"s"),p.XF=S[p.ixfe],t.cellFormula&&(p.f=""+Zt(o.formula,i,o.cell,U,D)),O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L(o.cell,p,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(N);var Ve=be(N[0].s);if(m=t.dense?(s[N[0].s.r]||[])[N[0].s.c]:s[Ve],t.cellFormula&&m){if(!o||!Ve||!m)break;m.f=""+Zt(N[1],i,N[0],U,D),m.F=je(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;w[be(o.cell)]=N[0],m=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[be(o.cell)],(m||{}).f=""+Zt(N[0],i,h,U,D)}}break;case 253:p=Kl(l[N.isst].t,N.ixfe,"s"),l[N.isst].h&&(p.h=l[N.isst].h),p.XF=S[p.ixfe],O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:N.c,r:N.r},p,t);break;case 513:t.sheetStubs&&(p={ixfe:N.ixfe,XF:S[N.ixfe],t:"z"},O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:N.c,r:N.r},p,t));break;case 190:if(t.sheetStubs)for(var Dt=N.c;Dt<=N.C;++Dt){var At=N.ixfe[Dt-N.c];p={ixfe:At,XF:S[At],t:"z"},O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:Dt,r:N.r},p,t)}break;case 214:case 516:case 4:p=Kl(N.val,N.ixfe,"s"),p.XF=S[p.ixfe],O>0&&(p.z=H[p.ixfe>>8&63]),_n(p,t,r.opts.Date1904),L({c:N.c,r:N.r},p,t);break;case 0:case 512:ge===1&&(i=N);break;case 252:l=N;break;case 1054:if(D.biff==4){H[O++]=N[1];for(var nn=0;nn<O+163&&Se[nn]!=N[1];++nn);nn>=163&&Wn(N[1],O+163)}else Wn(N[1],N[0]);break;case 30:{H[O++]=N;for(var wn=0;wn<O+163&&Se[wn]!=N;++wn);wn>=163&&Wn(N,O+163)}break;case 229:oe=oe.concat(N);break;case 93:W[N.cmo[0]]=D.lastobj=N;break;case 438:D.lastobj.TxO=N;break;case 127:D.lastobj.ImData=N;break;case 440:for(v=N[0].s.r;v<=N[0].e.r;++v)for(g=N[0].s.c;g<=N[0].e.c;++g)m=t.dense?(s[v]||[])[g]:s[be({c:g,r:v})],m&&(m.l=N[1]);break;case 2048:for(v=N[0].s.r;v<=N[0].e.r;++v)for(g=N[0].s.c;g<=N[0].e.c;++g)m=t.dense?(s[v]||[])[g]:s[be({c:g,r:v})],m&&m.l&&(m.l.Tooltip=N[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;m=t.dense?(s[N[0].r]||[])[N[0].c]:s[be(N[0])];var gr=W[N[2]];m||(t.dense?(s[N[0].r]||(s[N[0].r]=[]),m=s[N[0].r][N[0].c]={t:"z"}):m=s[be(N[0])]={t:"z"},i.e.r=Math.max(i.e.r,N[0].r),i.s.r=Math.min(i.s.r,N[0].r),i.e.c=Math.max(i.e.c,N[0].c),i.s.c=Math.min(i.s.c,N[0].c)),m.c||(m.c=[]),x={a:N[1],t:gr.TxO.t},m.c.push(x)}break;case 2173:UC(S[N.ixfe],N.ext);break;case 125:{if(!D.cellStyles)break;for(;N.e>=N.s;)ee[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},Z||(Z=!0,vd(N.w/256)),Cs(ee[N.e+1])}break;case 520:{var vt={};N.level!=null&&(ne[N.r]=vt,vt.level=N.level),N.hidden&&(ne[N.r]=vt,vt.hidden=!0),N.hpt&&(ne[N.r]=vt,vt.hpt=N.hpt,vt.hpx=vi(N.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||ra(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=N;break;case 161:s["!margins"]||ra(s["!margins"]={}),s["!margins"].header=N.header,s["!margins"].footer=N.footer;break;case 574:N.RTL&&(k.Views[0].RTL=!0);break;case 146:E=N;break;case 2198:q=N;break;case 140:_=N;break;case 442:c?C.CodeName=N||C.name:k.WBProps.CodeName=N||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),e.l+=ae}return r.SheetNames=xt(a).sort(function(Tr,Le){return Number(Tr)-Number(Le)}).map(function(Tr){return a[Tr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&M.forEach(function(Tr,Le){r.Sheets[r.SheetNames[Le]]["!autofilter"]=Tr}),r.Strings=l,r.SSF=st(Se),D.enc&&(r.Encryption=D.enc),q&&(r.Themes=q),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),U.names.length>0&&(k.Names=U.names),r.Workbook=k,r}var yo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ej(e,t,r){var n=_e.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Jg(n,Rf,yo.DSI);for(var a in s)t[a]=s[a]}catch(c){if(r.WTF)throw c}var i=_e.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Jg(i,Df,yo.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(gw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function tj(e,t){var r=[],n=[],s=[],a=0,i,o=Cg(Rf,"n"),l=Cg(Df,"n");if(e.Props)for(i=xt(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=xt(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var c=[];for(a=0;a<s.length;++a)kw.indexOf(s[a][0])>-1||mw.indexOf(s[a][0])>-1||s[a][1]!=null&&c.push(s[a]);n.length&&_e.utils.cfb_add(t,"/SummaryInformation",Zg(n,yo.SI,l,Df)),(r.length||c.length)&&_e.utils.cfb_add(t,"/DocumentSummaryInformation",Zg(r,yo.DSI,o,Rf,c.length?c:null,yo.UDI))}function xy(e,t){t||(t={}),Nd(t),Xh(),t.codepage&&Kh(t.codepage);var r,n;if(e.FullPaths){if(_e.find(e,"/encryption"))throw new Error("File is password-protected");r=_e.find(e,"!CompObj"),n=_e.find(e,"/Workbook")||_e.find(e,"/Book")}else{switch(t.type){case"base64":e=jr(Dr(e));break;case"binary":e=jr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}zt(e,0),n={content:e}}var s,a;if(r&&Q8(r),t.bookProps&&!t.bookSheets)s={};else{var i=Re?"buffer":"array";if(n&&n.content)s=Z8(n.content,t);else if((a=_e.find(e,"PerfectOffice_MAIN"))&&a.content)s=ta.to_workbook(a.content,(t.type=i,t));else if((a=_e.find(e,"NativeContent_MAIN"))&&a.content)s=ta.to_workbook(a.content,(t.type=i,t));else throw(a=_e.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&_e.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=mA(e))}var o={};return e.FullPaths&&ej(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function rj(e,t){var r=t||{},n=_e.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return _e.utils.cfb_add(n,s,vy(e,r)),r.biff==8&&(e.Props||e.Custprops)&&tj(e,n),r.biff==8&&e.vbaraw&&gA(n,_e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Yo={0:{f:T5},1:{f:I5},2:{f:Z5},3:{f:H5},4:{f:M5},5:{f:Q5},6:{f:sF},7:{f:G5},8:{f:fF},9:{f:uF},10:{f:lF},11:{f:cF},12:{f:D5},13:{f:tF},14:{f:z5},15:{f:U5},16:{f:cy},17:{f:iF},18:{f:X5},19:{f:ld},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:i8},40:{},42:{},43:{f:sC},44:{f:rC},45:{f:oC},46:{f:cC},47:{f:lC},48:{},49:{f:Ab},50:{},51:{f:WC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Pw},62:{f:nF},63:{f:JC},64:{f:NF},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ar,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SF},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:O5},148:{f:A5,p:16},151:{f:xF},152:{},153:{f:n8},154:{},155:{},156:{f:t8},157:{},158:{},159:{T:1,f:wN},160:{T:-1},161:{T:1,f:ka},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:hF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$C},336:{T:-1},337:{f:GC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:If},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ow},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vF},427:{f:wF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_F},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:j5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:If},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cA},633:{T:1},634:{T:-1},635:{T:1,f:oA},636:{T:-1},637:{f:Pb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:CF},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Hf={6:{f:vu},10:{f:rs},12:{f:Tt},13:{f:Tt},14:{f:yt},15:{f:yt},16:{f:rr},17:{f:yt},18:{f:yt},19:{f:Tt},20:{f:ap},21:{f:ap},23:{f:Ow},24:{f:op},25:{f:yt},26:{},27:{},28:{f:C3},29:{},34:{f:yt},35:{f:ip},38:{f:rr},39:{f:rr},40:{f:rr},41:{f:rr},42:{f:yt},43:{f:yt},47:{f:UN},49:{f:t3},51:{f:Tt},60:{},61:{f:QT},64:{f:yt},65:{f:e3},66:{f:Tt},77:{},80:{},81:{},82:{},85:{f:Tt},89:{},90:{},91:{},92:{f:BT},93:{f:j3},94:{},95:{f:yt},96:{},97:{},99:{f:yt},125:{f:Pw},128:{f:p3},129:{f:$T},130:{f:Tt},131:{f:yt},132:{f:yt},133:{f:HT},134:{},140:{f:B3},141:{f:Tt},144:{},146:{f:H3},151:{},152:{},153:{},154:{},155:{},156:{f:Tt},157:{},158:{},160:{f:q3},161:{f:V3},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:h3},190:{f:d3},193:{f:rs},197:{},198:{},199:{},200:{},201:{},202:{f:yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Tt},220:{},221:{f:yt},222:{},224:{f:g3},225:{f:MT},226:{f:rs},227:{},229:{f:A3},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zT},253:{f:n3},255:{f:GT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Sw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yt},353:{f:rs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_3},431:{f:yt},432:{},433:{},434:{},437:{},438:{f:I3},439:{f:yt},440:{f:R3},441:{},442:{f:hl},443:{},444:{f:Tt},445:{},446:{},448:{f:rs},449:{f:qT,r:2},450:{f:rs},512:{f:rp},513:{f:X3},515:{f:w3},516:{f:a3},517:{f:sp},519:{f:Q3},520:{f:KT},523:{},545:{f:lp},549:{f:tp},566:{},574:{f:JT},638:{f:f3},659:{},1048:{},1054:{f:o3},1084:{},1212:{f:b3},2048:{f:L3},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zl},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:rs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:W3,r:12},2173:{f:BC,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:E3,r:12},2197:{},2198:{f:PC,r:12},2199:{},2200:{},2201:{},2202:{f:T3,r:12},2203:{f:rs},2204:{},2205:{},2206:{},2207:{},2211:{f:XT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Tt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:G3},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:$3},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:rp},1:{},2:{f:tN},3:{f:Z3},4:{f:J3},5:{f:sp},7:{f:nN},8:{},9:{f:zl},11:{},22:{f:Tt},30:{f:c3},31:{},32:{},33:{f:lp},36:{},37:{f:tp},50:{f:sN},62:{},52:{},67:{},68:{f:Tt},69:{},86:{},126:{},127:{f:Y3},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:aN},223:{},234:{},354:{},421:{},518:{f:vu},521:{f:zl},536:{f:op},547:{f:ip},561:{},579:{},1030:{f:vu},1033:{f:zl},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function me(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&ad(r)&&e.push(r)}}function nj(e,t,r,n){var s=n||(r||[]).length||0;if(s<=8224)return me(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<s;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function pl(e,t,r){return e||(e=Y(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function sj(e,t,r,n){var s=Y(9);return pl(s,e,t),Ew(r,n||"b",s),s}function aj(e,t,r){var n=Y(8+2*r.length);return pl(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ij(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Rt(nt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?me(e,2,rN(r,n,s)):me(e,3,eN(r,n,s));return;case"b":case"e":me(e,5,sj(r,n,t.v,t.t));return;case"s":case"str":me(e,4,aj(r,n,(t.v||"").slice(0,255)));return}me(e,1,pl(null,r,n))}function oj(e,t,r,n){var s=Array.isArray(t),a=We(t["!ref"]||"A1"),i,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=je(a)}for(var c=a.s.r;c<=a.e.r;++c){o=kt(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=ut(u)),i=l[u]+o;var h=s?(t[c]||[])[u]:t[i];h&&ij(e,h,c,u)}}}function lj(e,t){for(var r=t||{},n=Er(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return me(n,r.biff==4?1033:r.biff==3?521:9,gd(e,16,r)),oj(n,e.Sheets[e.SheetNames[s]],s,r),me(n,10),n.end()}function cj(e,t,r){me(e,49,r3({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function uj(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&me(e,1054,l3(s,t[s],r))})}function fj(e,t){var r=Y(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),me(e,2151,r),r=Y(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Aw(We(t["!ref"]||"A1"),r),r.write_shift(4,4),me(e,2152,r)}function hj(e,t){for(var r=0;r<16;++r)me(e,224,np({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){me(e,224,np(n,0,t))})}function dj(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];me(e,440,D3(n)),n[1].Tooltip&&me(e,2048,M3(n))}delete t["!links"]}function mj(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&me(e,125,z3(T0(s,n),s))})}}function gj(e,t,r,n,s){var a=16+Ls(s.cellXfs,t,s);if(t.v==null&&!t.bf){me(e,513,ha(r,n,a));return}if(t.bf)me(e,6,$6(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Rt(nt(t.v)):t.v;me(e,515,y3(r,n,i,a));break;case"b":case"e":me(e,517,v3(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Sd(s.Strings,t.v,s.revStrings);me(e,253,s3(r,n,o,a))}else me(e,516,i3(r,n,(t.v||"").slice(0,255),a,s));break;default:me(e,513,ha(r,n,a))}}function pj(e,t,r){var n=Er(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(a),c=t.biff==8,u,h="",d=[],m=We(a["!ref"]||"A1"),x=c?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}me(n,2057,gd(r,16,t)),me(n,13,Gr(1)),me(n,12,Gr(100)),me(n,15,cr(!0)),me(n,17,cr(!1)),me(n,16,ua(.001)),me(n,95,cr(!0)),me(n,42,cr(!1)),me(n,43,cr(!1)),me(n,130,Gr(1)),me(n,128,x3([0,0])),me(n,131,cr(!1)),me(n,132,cr(!1)),c&&mj(n,a["!cols"]),me(n,512,u3(m,t)),c&&(a["!links"]=[]);for(var g=m.s.r;g<=m.e.r;++g){h=kt(g);for(var v=m.s.c;v<=m.e.c;++v){g===m.s.r&&(d[v]=ut(v)),u=d[v]+h;var w=l?(a[g]||[])[v]:a[u];w&&(gj(n,w,g,v,t),c&&w.l&&a["!links"].push([u,w.l]))}}var y=o.CodeName||o.name||s;return c&&me(n,574,ZT((i.Views||[])[0])),c&&(a["!merges"]||[]).length&&me(n,229,F3(a["!merges"])),c&&dj(n,a),me(n,442,bw(y)),c&&fj(n,a),me(n,10),n.end()}function xj(e,t,r){var n=Er(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(me(n,2057,gd(e,5,r)),r.bookType=="xla"&&me(n,135),me(n,225,o?Gr(1200):null),me(n,193,vT(2)),l&&me(n,191),l&&me(n,192),me(n,226),me(n,92,UT("SheetJS",r)),me(n,66,Gr(o?1200:1252)),o&&me(n,353,Gr(0)),o&&me(n,448),me(n,317,K3(e.SheetNames.length)),o&&e.vbaraw&&me(n,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";me(n,442,bw(c))}me(n,156,Gr(17)),me(n,25,cr(!1)),me(n,18,cr(!1)),me(n,19,Gr(0)),o&&me(n,431,cr(!1)),o&&me(n,444,Gr(0)),me(n,61,YT()),me(n,64,cr(!1)),me(n,141,Gr(0)),me(n,34,cr(qF(e)=="true")),me(n,14,cr(!0)),o&&me(n,439,cr(!1)),me(n,218,Gr(0)),cj(n,e,r),uj(n,e.SSF,r),hj(n,r),o&&me(n,352,cr(!1));var u=n.end(),h=Er();o&&me(h,140,U3()),o&&r.Strings&&nj(h,252,VT(r.Strings)),me(h,10);var d=h.end(),m=Er(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var v=u.length+x+d.length;for(g=0;g<e.SheetNames.length;++g){var w=a[g]||{};me(m,133,WT({pos:v,hs:w.Hidden||0,dt:0,name:e.SheetNames[g]},r)),v+=t[g].length}var y=m.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var p=[];return u.length&&p.push(u),y.length&&p.push(y),d.length&&p.push(d),Bt(p)}function vj(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=st(Se)),e&&e.SSF&&(bi(),w0(e.SSF),r.revssf=_0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Cd(r),r.cellXfs=[],Ls(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=pj(s,r,e);return n.unshift(xj(e,n,r)),Bt(n)}function vy(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=br(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return vj(e,t);case 4:case 3:case 2:return lj(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function vp(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=nb(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var g=l[i].trim(),v=g.slice(0,3).toLowerCase();if(v=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(v!="<td"&&v!="<th")){var w=g.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var y=w[o].trim();if(y.match(/<t[dh]/i)){for(var p=y,_=0;p.charAt(0)=="<"&&(_=p.indexOf(">"))>-1;)p=p.slice(_+1);for(var S=0;S<x.length;++S){var E=x[S];E.s.c==u&&E.s.r<c&&c<=E.e.r&&(u=E.e.c+1,S=-1)}var k=Te(y.slice(0,y.indexOf(">")));d=k.colspan?+k.colspan:1,((h=+k.rowspan)>1||d>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var C=k.t||k["data-t"]||"";if(!p.length){u+=d;continue}if(p=Hv(p),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!p.length){u+=d;continue}var T={t:"s",v:p};r.raw||!p.trim().length||C=="s"||(p==="TRUE"?T={t:"b",v:!0}:p==="FALSE"?T={t:"b",v:!1}:isNaN(pn(p))?isNaN(pi(p).getDate())||(T={t:"d",v:nt(p)},r.cellDates||(T={t:"n",v:Rt(T.v)}),T.z=r.dateNF||Se[14]):T={t:"n",v:pn(p)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=T):n[be({r:c,c:u})]=T,u+=d}}}}return n["!ref"]=je(m),x.length&&(n["!merges"]=x),n}function wj(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=be({r,c:i}),h=n.dense?(e[r]||[])[i]:e[u],d=h&&h.v!=null&&(h.h||rd(h.w||(qn(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+u,a.push(de("td",d,m))}}var x="<tr>";return x+a.join("")+"</tr>"}var yj='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_j="</body></html>";function kj(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ds(vp(r[0],t),t);var n=jd();return r.forEach(function(s,a){Od(n,vp(s,t),"Sheet"+(a+1))}),n}function Sj(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function wy(e,t){var r=t||{},n=r.header!=null?r.header:yj,s=r.footer!=null?r.footer:_j,a=[n],i=br(e["!ref"]);r.dense=Array.isArray(e),a.push(Sj(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(wj(e,i,o,r));return a.push("</table>"+s),a.join("")}function yy(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?ft(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=br(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],d=0,m=e["!rows"]||(e["!rows"]=[]),x=0,g=0,v=0,w=0,y=0,p=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<l;++x){var _=o[x];if(wp(_)){if(n.display)continue;m[g]={hidden:!0}}var S=_.children;for(v=w=0;v<S.length;++v){var E=S[v];if(!(n.display&&wp(E))){var k=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):Hv(E.innerHTML),C=E.getAttribute("data-z")||E.getAttribute("z");for(d=0;d<h.length;++d){var T=h[d];T.s.c==w+a&&T.s.r<g+s&&g+s<=T.e.r&&(w=T.e.c+1-a,d=-1)}p=+E.getAttribute("colspan")||1,((y=+E.getAttribute("rowspan")||1)>1||p>1)&&h.push({s:{r:g+s,c:w+a},e:{r:g+s+(y||1)-1,c:w+a+(p||1)-1}});var R={t:"s",v:k},L=E.getAttribute("data-t")||E.getAttribute("t")||"";k!=null&&(k.length==0?R.t=L||"z":n.raw||k.trim().length==0||L=="s"||(k==="TRUE"?R={t:"b",v:!0}:k==="FALSE"?R={t:"b",v:!1}:isNaN(pn(k))?isNaN(pi(k).getDate())||(R={t:"d",v:nt(k)},n.cellDates||(R={t:"n",v:Rt(R.v)}),R.z=n.dateNF||Se[14]):R={t:"n",v:pn(k)})),R.z===void 0&&C!=null&&(R.z=C);var D="",q=E.getElementsByTagName("A");if(q&&q.length)for(var oe=0;oe<q.length&&!(q[oe].hasAttribute("href")&&(D=q[oe].getAttribute("href"),D.charAt(0)!="#"));++oe);D&&D.charAt(0)!="#"&&(R.l={Target:D}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][w+a]=R):e[be({c:w+a,r:g+s})]=R,c.e.c<w+a&&(c.e.c=w+a),w+=p}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+s),e["!ref"]=je(c),g>=l&&(e["!fullref"]=je((c.e.r=o.length-x+g-1+s,c))),e}function _y(e,t){var r=t||{},n=r.dense?[]:{};return yy(n,e,t)}function Ej(e,t){return Ds(_y(e,t),t)}function wp(e){var t="",r=bj(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function bj(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Tj(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=He(t.replace(/<[^>]*>/g,""));return[r]}var yp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ky(e,t){var r=t||{},n=nd(e),s=[],a,i,o={name:""},l="",c=0,u,h,d={},m=[],x=r.dense?[]:{},g,v,w={value:""},y="",p=0,_=[],S=-1,E=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,T={},R=[],L={},D=0,q=0,oe=[],W=1,ee=1,ne=[],Z={Names:[]},U={},re=["",""],ge=[],O={},H="",M=0,B=!1,Q=!1,ie=0;for(Vo.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Vo.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"工作表":g[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=je(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=je(k)),R.length&&(x["!merges"]=R),oe.length&&(x["!rows"]=oe),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),d[u.name]=x,Q=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Te(g[0],!1),S=E=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},R=[],oe=[],Q=!0);break;case"table-row-group":g[1]==="/"?--C:++C;break;case"table-row":case"行":if(g[1]==="/"){S+=W,W=1;break}if(h=Te(g[0],!1),h.行号?S=h.行号-1:S==-1&&(S=0),W=+h["number-rows-repeated"]||1,W<10)for(ie=0;ie<W;++ie)C>0&&(oe[S+ie]={level:C});E=-1;break;case"covered-table-cell":g[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(x[S]||(x[S]=[]),x[S][E]={t:"z"}):x[be({r:S,c:E})]={t:"z"}),y="",_=[];break;case"table-cell":case"数据":if(g[0].charAt(g[0].length-2)==="/")++E,w=Te(g[0],!1),ee=parseInt(w["number-columns-repeated"]||"1",10),v={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(v.f=gp(He(w.formula))),(w.数据类型||w["value-type"])=="string"&&(v.t="s",v.v=He(w["string-value"]||""),r.dense?(x[S]||(x[S]=[]),x[S][E]=v):x[be({r:S,c:E})]=v),E+=ee-1;else if(g[1]!=="/"){++E,y="",p=0,_=[],ee=1;var ue=W?S+W-1:S;if(E>k.e.c&&(k.e.c=E),E<k.s.c&&(k.s.c=E),S<k.s.r&&(k.s.r=S),ue>k.e.r&&(k.e.r=ue),w=Te(g[0],!1),ge=[],O={},v={t:w.数据类型||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=He(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(D=parseInt(w["number-matrix-rows-spanned"],10)||0,q=parseInt(w["number-matrix-columns-spanned"],10)||0,L={s:{r:S,c:E},e:{r:S+D-1,c:E+q-1}},v.F=je(L),ne.push([L,v.F])),w.formula)v.f=gp(w.formula);else for(ie=0;ie<ne.length;++ie)S>=ne[ie][0].s.r&&S<=ne[ie][0].e.r&&E>=ne[ie][0].s.c&&E<=ne[ie][0].e.c&&(v.F=ne[ie][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(D=parseInt(w["number-rows-spanned"],10)||0,q=parseInt(w["number-columns-spanned"],10)||0,L={s:{r:S,c:E},e:{r:S+D-1,c:E+q-1}},R.push(L)),w["number-columns-repeated"]&&(ee=parseInt(w["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=tt(w["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(w.value);break;case"percentage":v.t="n",v.v=parseFloat(w.value);break;case"currency":v.t="n",v.v=parseFloat(w.value);break;case"date":v.t="d",v.v=nt(w["date-value"]),r.cellDates||(v.t="n",v.v=Rt(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=eb(w["time-value"])/86400,r.cellDates&&(v.t="d",v.v=k0(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(w.数据数值);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",w["string-value"]!=null&&(y=He(w["string-value"]),_=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(B=!1,v.t==="s"&&(v.v=y||"",_.length&&(v.R=_),B=p==0),U.Target&&(v.l=U),ge.length>0&&(v.c=ge,ge=[]),y&&r.cellText!==!1&&(v.w=y),B&&(v.t="z",delete v.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var ae=0;ae<W;++ae){if(ee=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(x[S+ae]||(x[S+ae]=[]),x[S+ae][E]=ae==0?v:st(v);--ee>0;)x[S+ae][E+ee]=st(v);else for(x[be({r:S+ae,c:E})]=v;--ee>0;)x[be({r:S+ae,c:E+ee})]=st(v);k.e.c<=E&&(k.e.c=E)}ee=parseInt(w["number-columns-repeated"]||"1",10),E+=ee-1,ee=0,v={},y="",_=[]}U={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;O.t=y,_.length&&(O.R=_),O.a=H,ge.push(O)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);H="",M=0,y="",p=0,_=[];break;case"creator":g[1]==="/"?H=n.slice(M,g.index):M=g.index+g[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);y="",p=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(T[o.name]=l,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Te(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Te(g[0],!1),l+=yp[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Te(g[0],!1),l+=yp[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":i=Te(g[0],!1),re=wu(i["cell-range-address"]);var se={Name:i.name,Ref:re[0]+"!"+re[1]};Q&&(se.Sheet=m.length),Z.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var Ne=Tj(n.slice(p,g.index));y=(y.length>0?y+`
`:"")+Ne[0]}else Te(g[0],!1),p=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{re=wu(Te(g[0])["target-range-address"]),d[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(U=Te(g[0],!1),!U.href)break;U.Target=He(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(re=wu(U.Target.slice(1)),U.Target="#"+re[0]+"!"+re[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(g)}}var N={Sheets:d,SheetNames:m,Workbook:Z};return r.bookSheets&&delete N.Sheets,N}function _p(e,t){t=t||{},Vr(e,"META-INF/manifest.xml")&&Zb(bt(e,"META-INF/manifest.xml"),t);var r=Or(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ky(Ye(r),t);return Vr(e,"meta.xml")&&(n.Props=hw(bt(e,"meta.xml"))),n}function kp(e,t){return ky(e,t)}var Nj=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+zo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return St+t}}(),Sp=function(){var e=function(a){return qe(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var l=[];l.push('      <table:table table:name="'+qe(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=br(a["!ref"]||"A1"),d=a["!merges"]||[],m=0,x=Array.isArray(a);if(a["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",v=a["!rows"]||[];for(c=0;c<h.s.r;++c)g=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var w=!1,y={},p="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>u)&&!(d[m].s.r>c)&&!(d[m].e.c<u)&&!(d[m].e.r<c)){(d[m].s.c!=u||d[m].s.r!=c)&&(w=!0),y["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,y["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(w){l.push(r);continue}var _=be({r:c,c:u}),S=x?(a[c]||[])[u]:a[_];if(S&&S.f&&(y["table:formula"]=qe(K6(S.f)),S.F&&S.F.slice(0,_.length)==_)){var E=br(S.F);y["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,y["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!S){l.push(t);continue}switch(S.t){case"b":p=S.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=S.v?"true":"false";break;case"n":p=S.w||String(S.v||0),y["office:value-type"]="float",y["office:value"]=S.v||0;break;case"s":case"str":p=S.v==null?"":S.v,y["office:value-type"]="string";break;case"d":p=S.w||nt(S.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=nt(S.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var k=e(p);if(S.l&&S.l.Target){var C=S.l.Target;C=C.charAt(0)=="#"?"#"+X6(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),k=de("text:a",k,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+de("table:table-cell",de("text:p",k,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Cs(h),h.ods=o;var d=c["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var l=[St],c=zo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=zo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(fw().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=i.SheetNames.length;++h)l.push(n(i.Sheets[i.SheetNames[h]],i,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Sy(e,t){if(t.bookType=="fods")return Sp(e,t);var r=Zh(),n="",s=[],a=[];return n="mimetype",Oe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Oe(r,n,Sp(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Oe(r,n,Nj(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Oe(r,n,St+fw()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Oe(r,n,rT(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Oe(r,n,eT(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function da(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Wf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ye(Rs(e))}function Cj(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):jr(Cn(e))}function Aj(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Fs(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Ep(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Fj(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function jj(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function Jo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ke(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function pt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ge(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Jo(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Jo(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function Ht(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Ke(n*8+s.type)),s.type==2&&t.push(Ke(s.data.length)),t.push(s.data))})}),Fs(t)}function Td(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Wr(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Jo(e,n),a=Ge(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:pt(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Ge(o.data),c=pt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(i.merge=pt(a[3][0].data)>>>0>0),r.push(i)}return r}function ja(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ke(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ke(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Ke(i.data.length)}],n[2].push({data:Ht(i.meta),type:2})});var a=Ht(n);t.push(Ke(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Fs(t)}function Oj(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Jo(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Fs(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Fs(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function zr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Oj(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Fs(t)}function Oa(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Ke(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Fs(t)}function Pj(e,t,r,n){var s=da(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Ep(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Ep(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Ij(e,t,r){var n=da(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=Fj(e,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function _u(e,t){var r=new Uint8Array(32),n=da(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,jj(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function ku(e,t){var r=new Uint8Array(32),n=da(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Rj(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Pj(e,t,r,e[0]);case 5:return Ij(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Jt(e){var t=Ge(e);return Jo(t[1][0].data)}function bp(e,t){var r=Ge(t.data),n=pt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Ge(i.data),l=pt(o[1][0].data)>>>0;switch(n){case 1:a[l]=Wf(o[3][0].data);break;case 8:{var c=e[Jt(o[9][0].data)][0],u=Ge(c.data),h=e[Jt(u[1][0].data)][0],d=pt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=Ge(h.data);a[l]=m[3].map(function(x){return Wf(x.data)}).join("")}break}}),a}function Dj(e,t){var r,n,s,a,i,o,l,c,u,h,d,m,x,g,v=Ge(e),w=pt(v[1][0].data)>>>0,y=pt(v[2][0].data)>>>0,p=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&pt(v[8][0].data)>0||!1,_,S;if((a=(s=v[7])==null?void 0:s[0])!=null&&a.data&&t!=0)_=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,S=(c=(l=v[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=v[4])==null?void 0:u[0])!=null&&h.data&&t!=1)_=(m=(d=v[4])==null?void 0:d[0])==null?void 0:m.data,S=(g=(x=v[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=p?4:1,k=da(_),C=[],T=0;T<_.length/2;++T){var R=k.getUint16(T*2,!0);R<65535&&C.push([T,R])}if(C.length!=y)throw"Expected ".concat(y," cells, found ").concat(C.length);var L=[];for(T=0;T<C.length-1;++T)L[C[T][0]]=S.subarray(C[T][1]*E,C[T+1][1]*E);return C.length>=1&&(L[C[C.length-1][0]]=S.subarray(C[C.length-1][1]*E)),{R:w,cells:L}}function Lj(e,t){var r,n=Ge(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?pt(n[7][0].data)>>>0>0?1:0:-1,a=Td(n[5],function(i){return Dj(i,s)});return{nrows:pt(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function Mj(e,t,r){var n,s=Ge(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(pt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(pt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=je(a);var i=Ge(s[4][0].data),o=bp(e,e[Jt(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?bp(e,e[Jt(i[17][0].data)][0]):[],c=Ge(i[3][0].data),u=0;c[1].forEach(function(h){var d=Ge(h.data),m=e[Jt(d[2][0].data)][0],x=pt(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=Lj(e,m);g.data.forEach(function(v,w){v.forEach(function(y,p){var _=be({r:u+w,c:p}),S=Rj(y,o,l);S&&(r[_]=S)})}),u+=g.nrows})}function Bj(e,t){var r=Ge(t.data),n={"!ref":"A1"},s=e[Jt(r[2][0].data)],a=pt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Mj(e,s[0],n),n}function Uj(e,t){var r,n=Ge(t.data),s={name:(r=n[1])!=null&&r[0]?Wf(n[1][0].data):"",sheets:[]},a=Td(n[2],Jt);return a.forEach(function(i){e[i].forEach(function(o){var l=pt(o.meta[1][0].data);l==6e3&&s.sheets.push(Bj(e,o))})}),s}function $j(e,t){var r=jd(),n=Ge(t.data),s=Td(n[1],Jt);if(s.forEach(function(a){e[a].forEach(function(i){var o=pt(i.meta[1][0].data);if(o==2){var l=Uj(e,i);l.sheets.forEach(function(c,u){Od(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Su(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=zr(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=Wr(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&pt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var u=pt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return $j(a,o)}function Hj(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&pt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=da(e[7][0].data),u=0,h=[],d=da(e[4][0].data),m=0,x=[],g=0;g<t.length;++g){if(t[g]==null){c.setUint16(g*2,65535,!0),d.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),d.setUint16(g*2,m,!0);var v,w;switch(typeof t[g]){case"string":v=_u({t:"s",v:t[g]},r),w=ku({t:"s",v:t[g]},r);break;case"number":v=_u({t:"n",v:t[g]},r),w=ku({t:"n",v:t[g]},r);break;case"boolean":v=_u({t:"b",v:t[g]},r),w=ku({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(v),u+=v.length,x.push(w),m+=w.length,++l}for(e[2][0].data=Ke(l);g<e[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),d.setUint16(g*2,65535,!0);return e[6][0].data=Fs(h),e[3][0].data=Fs(x),l}function Wj(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=br(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(je(n)));var a=Xc(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(H){return H.forEach(function(M){typeof M=="string"&&i.push(M)})});var o={},l=[],c=_e.read(t.numbers,{type:"base64"});c.FileIndex.map(function(H,M){return[H,c.FullPaths[M]]}).forEach(function(H){var M=H[0],B=H[1];if(M.type==2&&M.name.match(/\.iwa/)){var Q=M.content,ie=zr(Q),ue=Wr(ie);ue.forEach(function(ae){l.push(ae.id),o[ae.id]={deps:[],location:B,type:pt(ae.messages[0].meta[1][0].data)}})}}),l.sort(function(H,M){return H-M});var u=l.filter(function(H){return H>1}).map(function(H){return[H,Ke(H)]});c.FileIndex.map(function(H,M){return[H,c.FullPaths[M]]}).forEach(function(H){var M=H[0];if(H[1],!!M.name.match(/\.iwa/)){var B=Wr(zr(M.content));B.forEach(function(Q){Q.messages.forEach(function(ie){u.forEach(function(ue){Q.messages.some(function(ae){return pt(ae.meta[1][0].data)!=11006&&Aj(ae.data,ue[1])})&&o[ue[0]].deps.push(Q.id)})})})}});for(var h=_e.find(c,o[1].location),d=Wr(zr(h.content)),m,x=0;x<d.length;++x){var g=d[x];g.id==1&&(m=g)}var v=Jt(Ge(m.messages[0].data)[1][0].data);for(h=_e.find(c,o[v].location),d=Wr(zr(h.content)),x=0;x<d.length;++x)g=d[x],g.id==v&&(m=g);for(v=Jt(Ge(m.messages[0].data)[2][0].data),h=_e.find(c,o[v].location),d=Wr(zr(h.content)),x=0;x<d.length;++x)g=d[x],g.id==v&&(m=g);for(v=Jt(Ge(m.messages[0].data)[2][0].data),h=_e.find(c,o[v].location),d=Wr(zr(h.content)),x=0;x<d.length;++x)g=d[x],g.id==v&&(m=g);var w=Ge(m.messages[0].data);{w[6][0].data=Ke(n.e.r+1),w[7][0].data=Ke(n.e.c+1);var y=Jt(w[46][0].data),p=_e.find(c,o[y].location),_=Wr(zr(p.content));{for(var S=0;S<_.length&&_[S].id!=y;++S);if(_[S].id!=y)throw"Bad ColumnRowUIDMapArchive";var E=Ge(_[S].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var k=0;k<=n.e.c;++k){var C=[];C[1]=C[2]=[{type:0,data:Ke(k+420690)}],E[1].push({type:2,data:Ht(C)}),E[2].push({type:0,data:Ke(k)}),E[3].push({type:0,data:Ke(k)})}E[4]=[],E[5]=[],E[6]=[];for(var T=0;T<=n.e.r;++T)C=[],C[1]=C[2]=[{type:0,data:Ke(T+726270)}],E[4].push({type:2,data:Ht(C)}),E[5].push({type:0,data:Ke(T)}),E[6].push({type:0,data:Ke(T)});_[S].messages[0].data=Ht(E)}p.content=Oa(ja(_)),p.size=p.content.length,delete w[46];var R=Ge(w[4][0].data);{R[7][0].data=Ke(n.e.r+1);var L=Ge(R[1][0].data),D=Jt(L[2][0].data);p=_e.find(c,o[D].location),_=Wr(zr(p.content));{if(_[0].id!=D)throw"Bad HeaderStorageBucket";var q=Ge(_[0].messages[0].data);for(T=0;T<a.length;++T){var oe=Ge(q[2][0].data);oe[1][0].data=Ke(T),oe[4][0].data=Ke(a[T].length),q[2][T]={type:q[2][0].type,data:Ht(oe)}}_[0].messages[0].data=Ht(q)}p.content=Oa(ja(_)),p.size=p.content.length;var W=Jt(R[2][0].data);p=_e.find(c,o[W].location),_=Wr(zr(p.content));{if(_[0].id!=W)throw"Bad HeaderStorageBucket";for(q=Ge(_[0].messages[0].data),k=0;k<=n.e.c;++k)oe=Ge(q[2][0].data),oe[1][0].data=Ke(k),oe[4][0].data=Ke(n.e.r+1),q[2][k]={type:q[2][0].type,data:Ht(oe)};_[0].messages[0].data=Ht(q)}p.content=Oa(ja(_)),p.size=p.content.length;var ee=Jt(R[4][0].data);(function(){for(var H=_e.find(c,o[ee].location),M=Wr(zr(H.content)),B,Q=0;Q<M.length;++Q){var ie=M[Q];ie.id==ee&&(B=ie)}var ue=Ge(B.messages[0].data);{ue[3]=[];var ae=[];i.forEach(function(N,Ee){ae[1]=[{type:0,data:Ke(Ee)}],ae[2]=[{type:0,data:Ke(1)}],ae[3]=[{type:2,data:Cj(N)}],ue[3].push({type:2,data:Ht(ae)})})}B.messages[0].data=Ht(ue);var se=ja(M),Ne=Oa(se);H.content=Ne,H.size=H.content.length})();var ne=Ge(R[3][0].data);{var Z=ne[1][0];delete ne[2];var U=Ge(Z.data);{var re=Jt(U[2][0].data);(function(){for(var H=_e.find(c,o[re].location),M=Wr(zr(H.content)),B,Q=0;Q<M.length;++Q){var ie=M[Q];ie.id==re&&(B=ie)}var ue=Ge(B.messages[0].data);{delete ue[6],delete ne[7];var ae=new Uint8Array(ue[5][0].data);ue[5]=[];for(var se=0,Ne=0;Ne<=n.e.r;++Ne){var N=Ge(ae);se+=Hj(N,a[Ne],i),N[1][0].data=Ke(Ne),ue[5].push({data:Ht(N),type:2})}ue[1]=[{type:0,data:Ke(n.e.c+1)}],ue[2]=[{type:0,data:Ke(n.e.r+1)}],ue[3]=[{type:0,data:Ke(se)}],ue[4]=[{type:0,data:Ke(n.e.r+1)}]}B.messages[0].data=Ht(ue);var Ee=ja(M),De=Oa(Ee);H.content=De,H.size=H.content.length})()}Z.data=Ht(U)}R[3][0].data=Ht(ne)}w[4][0].data=Ht(R)}m.messages[0].data=Ht(w);var ge=ja(d),O=Oa(ge);return h.content=O,h.size=h.content.length,c}function Ey(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Nd(e){Ey([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Cd(e){Ey([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zj(e){return Be.WS.indexOf(e)>-1?"sheet":e==Be.CS?"chart":e==Be.DS?"dialog":e==Be.MS?"macro":e&&e.length?e:"sheet"}function Vj(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zj(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Gj(e,t,r,n,s,a,i,o,l,c,u,h){try{a[n]=po(Or(e,r,!0),t);var d=bt(e,t),m;switch(o){case"sheet":m=m8(d,t,s,l,a[n],c,u,h);break;case"chart":if(m=g8(d,t,s,l,a[n],c,u,h),!m||!m["!drawel"])break;var x=Yi(m["!drawel"].Target,t),g=Go(x),v=tA(Or(e,x,!0),po(Or(e,g,!0),x)),w=Yi(v,x),y=Go(w);m=HF(Or(e,w,!0),w,l,po(Or(e,y,!0),w),c,m);break;case"macro":m=p8(d,t,s,l,a[n],c,u,h);break;case"dialog":m=x8(d,t,s,l,a[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=m;var p=[];a&&a[n]&&xt(a[n]).forEach(function(_){var S="";if(a[n][_].Type==Be.CMNT){S=Yi(a[n][_].Target,t);var E=_8(bt(e,S,!0),S,l);if(!E||!E.length)return;up(m,E,!1)}a[n][_].Type==Be.TCMNT&&(S=Yi(a[n][_].Target,t),p=p.concat(nA(bt(e,S,!0),l)))}),p&&p.length&&up(m,p,!0,l.people||[])}catch(_){if(l.WTF)throw _}}function Ur(e){return e.charAt(0)=="/"?e.slice(1):e}function Kj(e,t){if(bi(),t=t||{},Nd(t),Vr(e,"META-INF/manifest.xml")||Vr(e,"objectdata.xml"))return _p(e,t);if(Vr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Su<"u"){if(e.FileIndex)return Su(e);var r=_e.utils.cfb_new();return jg(e).forEach(function(oe){Oe(r,oe,Mv(e,oe))}),Su(r)}throw new Error("Unsupported NUMBERS file")}if(!Vr(e,"[Content_Types].xml"))throw Vr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=jg(e),s=Yb(Or(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",bt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!bt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(xo=[],s.sst)try{xo=y8(bt(e,Ur(s.sst)),s.sst,t)}catch(oe){if(t.WTF)throw oe}t.cellStyles&&s.themes.length&&(l=w8(Or(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=v8(bt(e,Ur(s.style)),s.style,l,t))}s.links.map(function(oe){try{var W=po(Or(e,Go(Ur(oe))),oe);return S8(bt(e,Ur(oe)),W,oe,t)}catch{}});var u=d8(bt(e,Ur(s.workbooks[0])),s.workbooks[0],t),h={},d="";s.coreprops.length&&(d=bt(e,Ur(s.coreprops[0]),!0),d&&(h=hw(d)),s.extprops.length!==0&&(d=bt(e,Ur(s.extprops[0]),!0),d&&sT(d,h,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(d=Or(e,Ur(s.custprops[0]),!0),d&&(m=iT(d,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(W){return W.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(x.Props=h,x.Custprops=m),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var g={};t.bookDeps&&s.calcchain&&(g=k8(bt(e,Ur(s.calcchain)),s.calcchain));var v=0,w={},y,p;{var _=u.Sheets;h.Worksheets=_.length,h.SheetNames=[];for(var S=0;S!=_.length;++S)h.SheetNames[S]=_[S].name}var E=a?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Vr(e,C)||(C="xl/_rels/workbook."+E+".rels");var T=po(Or(e,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=E8(bt(e,Ur(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=aA(bt(e,Ur(s.people[0])),t)),T&&(T=Vj(T,u.Sheets));var R=bt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=h.Worksheets;++v){var L="sheet";if(T&&T[v]?(y="xl/"+T[v][1].replace(/[\/]?xl\//,""),Vr(e,y)||(y=T[v][1]),Vr(e,y)||(y=C.replace(/_rels\/.*$/,"")+T[v][1]),L=T[v][2]):(y="xl/worksheets/sheet"+(v+1-R)+"."+E,y=y.replace(/sheet0\./,"sheet.")),p=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(h.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==v&&(D=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==h.SheetNames[v].toLowerCase()&&(D=1);if(!D)continue e}}Gj(e,y,p,h.SheetNames[v],v,w,i,L,t,u,l,c)}return x={Directory:s,Workbook:u,Props:h,Custprops:m,Deps:g,Sheets:i,SheetNames:h.SheetNames,Strings:xo,Styles:c,Themes:l,SSF:st(Se)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(oe,W){oe=oe.replace(/^Root Entry[\/]/,""),x.keys.push(oe),x.files[oe]=e.FileIndex[W]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=bt(e,Ur(s.vba[0]),!0):s.defaults&&s.defaults.bin===dA&&(x.vbaraw=bt(e,"xl/vbaProject.bin",!0))),x}function Xj(e,t){var r=t||{},n="Workbook",s=_e.find(e,n);try{if(n="/!DataSpaces/Version",s=_e.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(EN(s.content),n="/!DataSpaces/DataSpaceMap",s=_e.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=TN(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=_e.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=NN(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=_e.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);AN(s.content)}catch{}if(n="/EncryptionInfo",s=_e.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=FN(s.content);if(n="/EncryptedPackage",s=_e.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function qj(e,t){return t.bookType=="ods"?Sy(e,t):t.bookType=="numbers"?Wj(e,t):t.bookType=="xlsb"?Qj(e,t):Yj(e,t)}function Qj(e,t){Qa=1024,e&&!e.SSF&&(e.SSF=st(Se)),e&&e.SSF&&(bi(),w0(e.SSF),t.revssf=_0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,vo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Yw.indexOf(t.bookType)>-1,s=dd();Cd(t=t||{});var a=Zh(),i="",o=0;if(t.cellXfs=[],Ls(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Oe(a,i,dw(e.Props,t)),s.coreprops.push(i),Xe(t.rels,2,i,Be.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Oe(a,i,pw(e.Props)),s.extprops.push(i),Xe(t.rels,3,i,Be.EXT_PROPS),e.Custprops!==e.Props&&xt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Oe(a,i,xw(e.Custprops)),s.custprops.push(i),Xe(t.rels,4,i,Be.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Oe(a,i,T8(o-1,i,t,e,u)),s.sheets.push(i),Xe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Be.WS[0])}if(h){var m=h["!comments"],x=!1,g="";m&&m.length>0&&(g="xl/comments"+o+"."+r,Oe(a,g,A8(m,g)),s.comments.push(g),Xe(u,-1,"../comments"+o+"."+r,Be.CMNT),x=!0),h["!legacy"]&&x&&Oe(a,"xl/drawings/vmlDrawing"+o+".vml",qw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Oe(a,Go(i),si(u))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Oe(a,i,C8(t.Strings,i,t)),s.strs.push(i),Xe(t.wbrels,-1,"sharedStrings."+r,Be.SST)),i="xl/workbook."+r,Oe(a,i,b8(e,i)),s.workbooks.push(i),Xe(t.rels,1,i,Be.WB),i="xl/theme/theme1.xml",Oe(a,i,wd(e.Themes,t)),s.themes.push(i),Xe(t.wbrels,-1,"theme/theme1.xml",Be.THEME),i="xl/styles."+r,Oe(a,i,N8(e,i,t)),s.styles.push(i),Xe(t.wbrels,-1,"styles."+r,Be.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Oe(a,i,e.vbaraw),s.vba.push(i),Xe(t.wbrels,-1,"vbaProject.bin",Be.VBA)),i="xl/metadata."+r,Oe(a,i,F8(i)),s.metadata.push(i),Xe(t.wbrels,-1,"metadata."+r,Be.XLMETA),Oe(a,"[Content_Types].xml",uw(s,t)),Oe(a,"_rels/.rels",si(t.rels)),Oe(a,"xl/_rels/workbook."+r+".rels",si(t.wbrels)),delete t.revssf,delete t.ssf,a}function Yj(e,t){Qa=1024,e&&!e.SSF&&(e.SSF=st(Se)),e&&e.SSF&&(bi(),w0(e.SSF),t.revssf=_0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,vo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Yw.indexOf(t.bookType)>-1,s=dd();Cd(t=t||{});var a=Zh(),i="",o=0;if(t.cellXfs=[],Ls(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Oe(a,i,dw(e.Props,t)),s.coreprops.push(i),Xe(t.rels,2,i,Be.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Oe(a,i,pw(e.Props)),s.extprops.push(i),Xe(t.rels,3,i,Be.EXT_PROPS),e.Custprops!==e.Props&&xt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Oe(a,i,xw(e.Custprops)),s.custprops.push(i),Xe(t.rels,4,i,Be.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Oe(a,i,ly(o-1,t,e,h)),s.sheets.push(i),Xe(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Be.WS[0])}if(d){var x=d["!comments"],g=!1,v="";if(x&&x.length>0){var w=!1;x.forEach(function(y){y[1].forEach(function(p){p.T==!0&&(w=!0)})}),w&&(v="xl/threadedComments/threadedComment"+o+"."+r,Oe(a,v,sA(x,u,t)),s.threadedcomments.push(v),Xe(h,-1,"../threadedComments/threadedComment"+o+"."+r,Be.TCMNT)),v="xl/comments"+o+"."+r,Oe(a,v,Qw(x)),s.comments.push(v),Xe(h,-1,"../comments"+o+"."+r,Be.CMNT),g=!0}d["!legacy"]&&g&&Oe(a,"xl/drawings/vmlDrawing"+o+".vml",qw(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&Oe(a,Go(i),si(h))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Oe(a,i,Lw(t.Strings,t)),s.strs.push(i),Xe(t.wbrels,-1,"sharedStrings."+r,Be.SST)),i="xl/workbook."+r,Oe(a,i,dy(e)),s.workbooks.push(i),Xe(t.rels,1,i,Be.WB),i="xl/theme/theme1.xml",Oe(a,i,wd(e.Themes,t)),s.themes.push(i),Xe(t.wbrels,-1,"theme/theme1.xml",Be.THEME),i="xl/styles."+r,Oe(a,i,Vw(e,t)),s.styles.push(i),Xe(t.wbrels,-1,"styles."+r,Be.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Oe(a,i,e.vbaraw),s.vba.push(i),Xe(t.wbrels,-1,"vbaProject.bin",Be.VBA)),i="xl/metadata."+r,Oe(a,i,Xw()),s.metadata.push(i),Xe(t.wbrels,-1,"metadata."+r,Be.XLMETA),u.length>1&&(i="xl/persons/person.xml",Oe(a,i,iA(u)),s.people.push(i),Xe(t.wbrels,-1,"persons/person.xml",Be.PEOPLE)),Oe(a,"[Content_Types].xml",uw(s,t)),Oe(a,"_rels/.rels",si(t.rels)),Oe(a,"xl/_rels/workbook."+r+".rels",si(t.wbrels)),delete t.revssf,delete t.ssf,a}function Ad(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Dr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Jj(e,t){return _e.find(e,"EncryptedPackage")?Xj(e,t):xy(e,t)}function Zj(e,t){var r,n=e,s=t||{};return s.type||(s.type=Re&&Buffer.isBuffer(e)?"buffer":"base64"),r=Bv(n,s),Kj(r,s)}function by(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $f(e.slice(r),t);default:break e}return xi.to_workbook(e,t)}function eO(e,t){var r="",n=Ad(e,t);switch(t.type){case"base64":r=Dr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ca(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ye(r)),t.type="binary",by(r,t)}function tO(e,t){var r=e;return t.type=="base64"&&(r=Dr(r)),r=us.utils.decode(1200,r.slice(2),"str"),t.type="binary",by(r,t)}function rO(e){return e.match(/[^\x00-\x7F]/)?Cn(e):e}function Eu(e,t,r,n){return n?(r.type="string",xi.to_workbook(e,r)):xi.to_workbook(t,r)}function zf(e,t){Xh();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return zf(new Uint8Array(e),(r=st(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ii={},r.dateNF&&(ii.dateNF=r.dateNF),r.type||(r.type=Re&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Re?"buffer":"binary",n=YE(e),typeof Uint8Array<"u"&&!Re&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=rO(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=st(r),r.type="array",zf(qh(n),r)}switch((s=Ad(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Jj(_e.read(n,r),r);break;case 9:if(s[1]<=8)return xy(n,r);break;case 60:return $f(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return oN(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Rw.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Zj(n,r):Eu(e,n,r,a);case 239:return s[3]===60?$f(n,r):Eu(e,n,r,a);case 255:if(s[1]===254)return tO(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ta.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ta.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Uf.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Hw.to_workbook(n,r);break;case 10:case 13:case 32:return eO(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return iN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Uf.to_workbook(n,r):Eu(e,n,r,a)}function Ty(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return cl(t.file,_e.write(e,{type:Re?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return _e.write(e,t)}function nO(e,t){var r=st(t||{}),n=qj(e,r);return sO(n,r)}function sO(e,t){var r={},n=Re?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?_e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(v0(s))}return t.password&&typeof encrypt_agile<"u"?Ty(encrypt_agile(s,t.password),t):t.type==="file"?cl(t.file,s):t.type=="string"?Ye(s):s}function aO(e,t){var r=t||{},n=rj(e,r);return Ty(n,r)}function En(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return $o(Cn(n));case"binary":return Cn(n);case"string":return e;case"file":return cl(t.file,n,"utf8");case"buffer":return Re?Yn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):En(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iO(e,t){switch(t.type){case"base64":return $o(e);case"binary":return e;case"string":return e;case"file":return cl(t.file,e,"binary");case"buffer":return Re?Yn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Xl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?$o(r):t.type=="string"?Ye(r):r;case"file":return cl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Ny(e,t){Xh(),JF(e);var r=st(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Ny(e,r);return r.type="array",v0(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return En(q8(e,r),r);case"slk":case"sylk":return En(Iw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return En(wy(e.Sheets[e.SheetNames[s]],r),r);case"txt":return iO(Ay(e.Sheets[e.SheetNames[s]],r),r);case"csv":return En(Fd(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return En(Rw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Xl(Uf.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return En(xi.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return En(Hw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return En(Dw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return En(Sy(e,r),r);case"wk1":return Xl(ta.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Xl(ta.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Xl(vy(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),aO(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nO(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function oO(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Cy(e,t,r){var n=r||{};return n.type="file",n.file=t,oO(n),Ny(e,n)}function lO(e,t,r,n,s,a,i,o){var l=kt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=i?e[r][m]:e[n[m]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;a[m]!=null&&(d[a[m]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[m]!=null){if(g==null)if(x.t=="e"&&g===null)d[a[m]]=null;else if(c!==void 0)d[a[m]]=c;else if(u&&g===null)d[a[m]]=null;else continue;else d[a[m]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:qn(x,g,o);g!=null&&(h=!1)}}return{row:d,isempty:h}}function Xc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=We(u);break;case"number":l=We(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=kt(l.s.r),d=[],m=[],x=0,g=0,v=Array.isArray(e),w=l.s.r,y=0,p={};v&&!e[w]&&(e[w]=[]);var _=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(_[y]||{}).hidden)switch(d[y]=ut(y),r=v?e[w][y]:e[d[y]+h],n){case 1:a[y]=y-l.s.c;break;case 2:a[y]=d[y];break;case 3:a[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=qn(r,null,c),g=p[i]||0,!g)p[i]=1;else{do o=i+"_"+g++;while(p[o]);p[i]=g,p[o]=1}a[y]=o}for(w=l.s.r+s;w<=l.e.r;++w)if(!(S[w]||{}).hidden){var E=lO(e,l,w,d,n,a,v,c);(E.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[x++]=E.row)}return m.length=x,m}var Tp=/"/g;function cO(e,t,r,n,s,a,i,o){for(var l=!0,c=[],u="",h=kt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var m=o.dense?(e[r]||[])[d]:e[n[d]+h];if(m==null)u="";else if(m.v!=null){l=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:qn(m,null,o));for(var x=0,g=0;x!==u.length;++x)if((g=u.charCodeAt(x))===s||g===a||g===34||o.forceQuotes){u='"'+u.replace(Tp,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(l=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Tp,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function Fd(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=We(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(d[x]||{}).hidden||(h[x]=ut(x));for(var g=0,v=s.s.r;v<=s.e.r;++v)(m[v]||{}).hidden||(u=cO(e,s,v,h,i,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function Ay(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Fd(e,t);return r}function uO(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=We(e["!ref"]),a="",i=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=ut(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=kt(u),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Fy(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?ft(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var h=We(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),i==-1&&(i=h.e.r+1,u.e.r=i+t.length-1+s)}else i==-1&&(i=0,u.e.r=t.length-1+s);var d=n.header||[],m=0;t.forEach(function(g,v){xt(g).forEach(function(w){(m=d.indexOf(w))==-1&&(d[m=d.length]=w);var y=g[w],p="z",_="",S=be({c:o+m,r:i+v+s});c=Zo(a,S),y&&typeof y=="object"&&!(y instanceof Date)?a[S]=y:(typeof y=="number"?p="n":typeof y=="boolean"?p="b":typeof y=="string"?p="s":y instanceof Date?(p="d",n.cellDates||(p="n",y=Rt(y)),_=n.dateNF||Se[14]):y===null&&n.nullError&&(p="e",y=0),c?(c.t=p,c.v=y,delete c.w,delete c.R,_&&(c.z=_)):a[S]=c={t:p,v:y},_&&(c.z=_))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var x=kt(i);if(s)for(m=0;m<d.length;++m)a[ut(m+o)+x]={t:"s",v:d[m]};return a["!ref"]=je(u),a}function fO(e,t){return Fy(null,e,t)}function Zo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ft(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zo(e,be(t)):Zo(e,be({r:t,c:r||0}))}function hO(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function jd(){return{SheetNames:[],Sheets:{}}}function Od(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(hy(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function dO(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=hO(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function mO(e,t){return e.z=t,e}function jy(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function gO(e,t,r){return jy(e,"#"+t,r)}function pO(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function xO(e,t,r,n){for(var s=typeof t!="string"?t:We(t),a=typeof t=="string"?t:je(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=Zo(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Es={encode_col:ut,encode_row:kt,encode_cell:be,encode_range:je,decode_col:od,decode_row:id,split_cell:Cb,decode_cell:ft,decode_range:br,format_cell:qn,sheet_add_aoa:nw,sheet_add_json:Fy,sheet_add_dom:yy,aoa_to_sheet:Ti,json_to_sheet:fO,table_to_sheet:_y,table_to_book:Ej,sheet_to_csv:Fd,sheet_to_txt:Ay,sheet_to_json:Xc,sheet_to_html:wy,sheet_to_formulae:uO,sheet_to_row_object_array:Xc,sheet_get_cell:Zo,book_new:jd,book_append_sheet:Od,book_set_sheet_visibility:dO,cell_set_number_format:mO,cell_set_hyperlink:jy,cell_set_internal_link:gO,cell_add_comment:pO,sheet_set_array_formula:xO,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function vO(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=s=>{var a;try{const i=(a=s.target)==null?void 0:a.result,o=zf(i,{type:"binary",cellDates:!1,cellNF:!0,cellStyles:!0}),l=o.Sheets[o.SheetNames[0]],c=Es.decode_range(l["!ref"]||"A1"),u=[];for(let g=c.s.r;g<=c.e.r;++g){const v=[];for(let w=c.s.c;w<=c.e.c;++w){const y=Es.encode_cell({r:g,c:w}),p=l[y];if(!p){v.push("");continue}g<=3&&w<=5&&console.log(`Cell ${y}:`,{type:p.t,value:p.v,formatted:p.w,numberFormat:p.z}),p.t==="n"?p.z&&(p.z.includes("m/d")||p.z.includes("d/m")||p.z.includes("yy")||p.z.includes("M/D"))&&p.w?v.push(p.w):v.push(p.v.toString()):p.w?v.push(p.w):p.v!=null?v.push(p.v.toString()):v.push("")}u.push(v)}const h=u,d=[],m=[];if(h.length===0){r(new Error("File Excel rỗng"));return}const x=h[0];console.log("📋 Excel Header:",x);for(let g=1;g<h.length;g++){const v=h[g];if(!v||v.length===0||!v.some(D=>D!=null&&D!==""))continue;if(v.length<6){m.push({row:g+1,message:`Không đủ cột (cần 6, có ${v.length})`});continue}let[w,y,p,_,S,E,k,C]=v;const T=D=>D==null?"":D.toString().trim();if(w=T(w),y=T(y),p=T(p),_=T(_),S=T(S),k=T(k),C=T(C),!w||w===""){m.push({row:g+1,message:"Thiếu câu hỏi"});continue}const R=[y,p,_,S].filter(D=>D!=="");if(R.length<2){m.push({row:g+1,message:`Không đủ đáp án (cần ít nhất 2, có ${R.length})`});continue}const L=parseInt(E==null?void 0:E.toString());if(isNaN(L)||L<1||L>R.length){m.push({row:g+1,message:`Đáp án đúng không hợp lệ ("${E}")`});continue}d.push({id:`q-${Date.now()}-${g}`,question:w,options:R,correctAnswer:L-1,category:C||"Uncategorized",explanation:k||void 0})}m.length>0&&(console.warn(`⚠️ Bỏ qua ${m.length} dòng không hợp lệ`),m.slice(0,10).forEach(g=>{console.warn(`  - Dòng ${g.row}: ${g.message}`)})),console.log(`✅ Import thành công ${d.length} câu hỏi${m.length>0?`, bỏ qua ${m.length} dòng lỗi`:""}`),t({questions:d,errors:m})}catch(i){r(i)}},n.onerror=()=>r(new Error("Failed to read file")),n.readAsBinaryString(e)})}function wO(e){const t=[["question","option_a","option_b","option_c","option_d","correct_answer","explanation","category"]];e.forEach(s=>{t.push([s.question,s.options[0]||"",s.options[1]||"",s.options[2]||"",s.options[3]||"",(s.correctAnswer+1).toString(),s.explanation||"",s.category])});const r=Es.aoa_to_sheet(t),n=Es.book_new();Es.book_append_sheet(n,r,"Questions"),Cy(n,"questions.xlsx")}function yO(){const e=[["question","option_a","option_b","option_c","option_d","correct_answer","explanation","category"],["Thủ đô của Việt Nam là thành phố nào?","Thành phố Hồ Chí Minh","Hà Nội","Đà Nẵng","Cần Thơ","2","Hà Nội là thủ đô của Việt Nam","Địa lý"],["Kết quả của 15 + 25 × 2 là bao nhiêu?","80","65","55","70","2","Theo thứ tự ưu tiên: 25 × 2 = 50, 15 + 50 = 65","Toán học"]],t=Es.aoa_to_sheet(e),r=Es.book_new();Es.book_append_sheet(r,t,"Questions"),Cy(r,"sample-questions.xlsx")}const _O=({questions:e,loading:t,error:r,onQuestionsImport:n,onClearQuestions:s,onStartQuiz:a,isSupabaseConfigured:i=!1})=>{K.useState("practice"),K.useState(60),K.useState(20);const[o,l]=K.useState({}),[c,u]=K.useState("add"),h=[...new Set(e.map(p=>p.category))],d=p=>{var S;const _=(S=p.target.files)==null?void 0:S[0];if(_)if(console.log(`📁 File được chọn: ${_.name}, Size: ${(_.size/1024/1024).toFixed(2)}MB`),_.name.endsWith(".xlsx"))vO(_).then(E=>{const{questions:k,errors:C}=E;if(console.log(`✅ Excel parsed: ${k.length} câu hỏi hợp lệ, ${C.length} lỗi`),C.length>0){const R=C.slice(0,20).map(D=>`  • Dòng ${D.row}: ${D.message}`).join(`
`),L=C.length>20?`
  ... và ${C.length-20} lỗi khác`:"";alert(`⚠️ Tìm thấy ${C.length} dòng lỗi (đã bỏ qua):

${R}${L}

✅ Import thành công ${k.length} câu hỏi hợp lệ.`)}if(k.length>=1e3){const T=`⚠️ File có ${k.length} câu hỏi.

⏱️ Quá trình import có thể mất vài phút.

✅ Vui lòng KHÔNG đóng trình duyệt trong khi đang import.

Bạn có muốn tiếp tục không?`;if(!confirm(T))return;alert(`⏳ Đang import ${k.length} câu hỏi...

✓ Vui lòng chờ và theo dõi Console log để xem tiến trình.
✓ KHÔNG đóng trình duyệt cho đến khi hoàn tất.`)}n(k,c==="replace")}).catch(E=>{console.error("❌ Chi tiết lỗi:",E),alert(`❌ Lỗi đọc file Excel: ${E.message}

💡 Kiểm tra:
- File có đúng định dạng không?
- Các cột bắt buộc: question, option_a, option_b, option_c, option_d, correct_answer, category
- Đáp án đúng phải là số 1-4`)});else{const E=new FileReader;E.onload=k=>{var C;try{const T=(C=k.target)==null?void 0:C.result;console.log(`📄 File content length: ${T.length} characters`);let R;if(_.name.endsWith(".json"))R=JSON.parse(T),console.log(`✅ JSON parsed: ${R.length} câu hỏi`);else if(_.name.endsWith(".csv")){const L=vE(T);if(R=L.questions,console.log(`✅ CSV parsed: ${R.length} câu hỏi`),L.errors.length>0){const q=L.errors.slice(0,20).map(W=>`  • Dòng ${W.row}: ${W.message}`).join(`
`),oe=L.errors.length>20?`
  ... và ${L.errors.length-20} lỗi khác`:"";alert(`⚠️ Tìm thấy ${L.errors.length} dòng lỗi (đã bỏ qua):

${q}${oe}

✅ Import thành công ${R.length} câu hỏi hợp lệ.`)}}else throw new Error("Định dạng file không được hỗ trợ");if(R.length>=1e3){const L=`⚠️ File có ${R.length} câu hỏi.

⏱️ Quá trình import có thể mất vài phút.

✅ Vui lòng KHÔNG đóng trình duyệt trong khi đang import.

Bạn có muốn tiếp tục không?`;if(!confirm(L))return;alert(`⏳ Đang import ${R.length} câu hỏi...

✓ Vui lòng chờ và theo dõi Console log để xem tiến trình.
✓ KHÔNG đóng trình duyệt cho đến khi hoàn tất.`)}n(R,c==="replace")}catch{alert("Lỗi khi đọc file. Vui lòng kiểm tra định dạng file.")}},E.readAsText(_)}},m=async()=>{window.confirm(`⚠️ Bạn có chắc chắn muốn xóa TẤT CẢ câu hỏi trong cơ sở dữ liệu?

Hành động này KHÔNG THỂ hoàn tác!`)&&(await s(),alert("✅ Đã xóa tất cả câu hỏi khỏi cơ sở dữ liệu!"))},x=()=>{if(e.length===0){alert("Không có câu hỏi nào để xuất!");return}try{wO(e),alert(`Đã xuất thành công ${e.length} câu hỏi ra file Excel!`)}catch{alert("Lỗi khi xuất file Excel!")}},g=()=>{try{yO(),alert("Đã tải xuống file Excel mẫu thành công!")}catch{alert("Lỗi khi tạo file Excel mẫu!")}},v=()=>{if(e.length===0){alert("Không có câu hỏi nào để xuất!");return}try{const p=JSON.stringify(e,null,2),_=new Blob([p],{type:"application/json"}),S=URL.createObjectURL(_),E=document.createElement("a");E.href=S,E.download=`questions_${new Date().toISOString().split("T")[0]}.json`,E.click(),URL.revokeObjectURL(S),alert(`Đã xuất thành công ${e.length} câu hỏi ra file JSON!`)}catch{alert("Lỗi khi xuất file JSON!")}},w=()=>{const p=[{id:"geo_001",question:"Thủ đô của Việt Nam là gì?",options:["Hồ Chí Minh","Hà Nội","Đà Nẵng","Cần Thơ"],correctAnswer:2,explanation:"Hà Nội là thủ đô của nước Cộng hòa Xã hội chủ nghĩa Việt Nam từ năm 1976.",category:"Địa lý"},{id:"math_001",question:"Kết quả của 15 + 25 × 2 là bao nhiêu?",options:["80","65","55","70"],correctAnswer:2,explanation:"Theo thứ tự ưu tiên phép tính: 25 × 2 = 50, sau đó 15 + 50 = 65.",category:"Toán học"},{id:"chem_001",question:"Nguyên tố hóa học nào có ký hiệu là 'O'?",options:["Oxi","Vàng","Bạc","Sắt"],correctAnswer:1,explanation:"Oxi (Oxygen) có ký hiệu hóa học là O, là nguyên tố thiết yếu cho sự sống.",category:"Hóa học"},{id:"hist_001",question:"Việt Nam giành độc lập vào năm nào?",options:["1945","1954","1975","1976"],correctAnswer:1,explanation:"Việt Nam tuyên bố độc lập vào ngày 2/9/1945 với bản Tuyên ngôn độc lập do Chủ tịch Hồ Chí Minh đọc.",category:"Lịch sử"},{id:"lit_001",question:"Ai là tác giả của tác phẩm 'Truyện Kiều'?",options:["Nguyễn Du","Hồ Xuân Hương","Nguyễn Trãi","Lý Thái Tổ"],correctAnswer:1,explanation:"Nguyễn Du (1765-1820) là tác giả của kiệt tác 'Truyện Kiều', được coi là đỉnh cao của văn học Việt Nam.",category:"Văn học"}];try{const _=JSON.stringify(p,null,2),S=new Blob([_],{type:"application/json"}),E=URL.createObjectURL(S),k=document.createElement("a");k.href=E,k.download="sample-questions.json",k.click(),URL.revokeObjectURL(E)}catch{alert("Lỗi khi tạo file JSON mẫu!")}},y=()=>{try{const p=`question,option_a,option_b,option_c,option_d,correct_answer,explanation,category
"Thủ đô của Việt Nam là thành phố nào?","Thành phố Hồ Chí Minh","Hà Nội","Đà Nẵng","Cần Thơ",2,"Hà Nội là thủ đô của nước Cộng hòa Xã hội chủ nghĩa Việt Nam từ năm 1976, là trung tâm chính trị - hành chính của cả nước.","Địa lý Việt Nam"
"Kết quả của phép tính 15 + 25 × 2 là bao nhiêu?","80","65","55","70",2,"Theo thứ tự ưu tiên của các phép tính:
Bước 1: 25 × 2 = 50
Bước 2: 15 + 50 = 65","Toán học cơ bản"
"Nguyên tố hóa học nào có ký hiệu là ""O""?","Oxi (Oxygen)","Vàng (Gold)","Bạc (Silver)","Sắt (Iron)",1,"Oxi (Oxygen) có ký hiệu hóa học là O, là nguyên tố thiết yếu cho sự sống và quá trình hô hấp của con người.","Hóa học"
"Việt Nam tuyên bố độc lập vào ngày nào?","2 tháng 9 năm 1945","30 tháng 4 năm 1975","19 tháng 8 năm 1945","2 tháng 7 năm 1976",1,"Ngày 2 tháng 9 năm 1945, Chủ tịch Hồ Chí Minh đọc bản Tuyên ngôn độc lập tại Quảng trường Ba Đình, Hà Nội, tuyên bố nước Việt Nam Dân chủ Cộng hòa ra đời.","Lịch sử Việt Nam"
"Tác giả của tác phẩm ""Truyện Kiều"" là ai?","Nguyễn Du","Hồ Xuân Hương","Nguyễn Trãi","Nguyễn Bỉnh Khiêm",1,"Nguyễn Du (1765-1820) là tác giả của kiệt tác ""Truyện Kiều"" (tên đầy đủ là ""Đoạn trường tân thanh""), được coi là đỉnh cao của văn học cổ điển Việt Nam.","Văn học Việt Nam"`,_="\uFEFF",S=new Blob([_+p],{type:"text/csv;charset=utf-8;"}),E=URL.createObjectURL(S),k=document.createElement("a");k.href=E,k.download="sample-questions.csv",k.click(),URL.revokeObjectURL(E)}catch{alert("Lỗi khi tạo file CSV mẫu!")}};return Object.values(o).reduce((p,_)=>p+_,0),f.jsxs("div",{className:"min-h-screen bg-gray-100",children:[f.jsx("div",{className:"bg-[#A50034] text-white px-4 md:px-6 py-3 md:py-4 border-b border-gray-300",children:f.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[f.jsx(z1,{className:"w-5 h-5 md:w-6 md:h-6"}),f.jsx("h1",{className:"text-base md:text-xl font-semibold",children:"Cấu hình bài thi"})]})}),f.jsx("div",{className:"max-w-4xl mx-auto p-2 md:p-4",children:f.jsx("div",{className:"grid grid-cols-1 gap-3 md:gap-4",children:f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 md:p-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(Xm,{className:"w-5 h-5"}),"Quản lý ngân hàng câu hỏi"]}),r&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:f.jsxs("div",{className:"flex items-start gap-2",children:[f.jsx("span",{children:"❌"}),f.jsx("div",{children:f.jsx("div",{className:"font-medium whitespace-pre-line",children:r})})]})}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chế độ nhập"}),f.jsxs("select",{value:c,onChange:p=>u(p.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"add",children:"Thêm vào câu hỏi hiện có"}),f.jsx("option",{value:"replace",children:"Thay thế tất cả câu hỏi"})]}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:c==="add"?"📝 Câu hỏi mới sẽ được thêm vào danh sách hiện có":"🔄 Tất cả câu hỏi cũ sẽ bị xóa và thay thế bằng câu hỏi mới"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nhập câu hỏi (JSON/CSV/Excel)"}),f.jsx("input",{type:"file",disabled:t,accept:".json,.csv,.xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:d,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50"})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsxs("button",{onClick:v,disabled:e.length===0||t,className:"flex items-center justify-center gap-1 px-2 md:px-3 py-1.5 md:py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-xs md:text-sm",children:[f.jsx(Pa,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Xuất"})," JSON"]}),f.jsxs("button",{onClick:x,disabled:e.length===0||t,className:"flex items-center justify-center gap-1 px-2 md:px-3 py-1.5 md:py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-xs md:text-sm",children:[f.jsx(Pa,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Xuất"})," Excel"]}),f.jsxs("button",{onClick:m,disabled:e.length===0||t,className:"flex items-center justify-center gap-1 px-2 md:px-3 py-1.5 md:py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-xs md:text-sm",children:[f.jsx(h0,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Xóa tất cả"}),f.jsx("span",{className:"sm:hidden",children:"Xóa"})]}),f.jsxs("button",{onClick:w,className:"flex items-center justify-center gap-1 px-2 md:px-3 py-1.5 md:py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs md:text-sm",children:[f.jsx(Pa,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"JSON mẫu"}),f.jsx("span",{className:"sm:hidden",children:"JSON"})]}),f.jsxs("button",{onClick:y,className:"flex items-center justify-center gap-1 px-2 md:px-3 py-1.5 md:py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs md:text-sm",children:[f.jsx(Pa,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"CSV mẫu"}),f.jsx("span",{className:"sm:hidden",children:"CSV"})]}),f.jsxs("button",{onClick:g,className:"flex items-center justify-center gap-1 px-2 md:px-3 py-1.5 md:py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs md:text-sm",children:[f.jsx(Pa,{className:"w-3 h-3 md:w-4 md:h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Excel mẫu"}),f.jsx("span",{className:"sm:hidden",children:"Excel"})]})]}),f.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:f.jsx("div",{className:"space-y-2",children:f.jsxs("div",{className:"text-xs text-gray-500",children:[f.jsx("p",{children:"• JSON: Định dạng khuyến nghị, dễ chỉnh sửa"}),f.jsx("p",{children:"• CSV: Có thể mở bằng Excel, hỗ trợ UTF-8 với BOM"}),f.jsx("p",{children:"• Excel: Định dạng .xlsx, dễ chỉnh sửa, hỗ trợ đầy đủ tiếng Việt"}),f.jsx("p",{children:"• Tất cả file đều chứa câu hỏi mẫu đa chuyên đề"})]})})}),f.jsxs("div",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx(Xm,{className:"w-4 h-4"}),f.jsx("span",{className:"font-medium",children:"Cơ sở dữ liệu:"})]}),f.jsxs("p",{children:["📊 Tổng câu hỏi: ",f.jsx("strong",{children:t?"Đang tải...":e.length.toLocaleString()})]}),f.jsxs("p",{children:["Danh mục: ",f.jsx("strong",{children:h.length})," chuyên đề"]}),t&&f.jsx("p",{className:"text-blue-600",children:"🔄 Đang xử lý..."}),e.length>0&&f.jsxs("details",{className:"mt-2",children:[f.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-700",children:"📋 Xem chi tiết chuyên đề"}),f.jsx("div",{className:"mt-1 text-xs text-gray-600 max-h-32 overflow-y-auto",children:h.map(p=>{const _=e.filter(S=>S.category===p).length;return f.jsxs("div",{className:"flex justify-between py-1",children:[f.jsx("span",{className:"truncate mr-2",title:p,children:p}),f.jsx("span",{className:"font-mono",children:_})]},p)})})]})]})]})]})})})]})},kO=({templates:e,questions:t,loading:r,error:n,onSaveTemplate:s,onUpdateTemplate:a,onDeleteTemplate:i})=>{const{user:o}=xa(),[l,c]=K.useState(!1),[u,h]=K.useState(null),[d,m]=K.useState({name:"",description:"",mode:"practice",timeLimit:60,totalQuestions:20,categories:{}}),x=[...new Set(t.map(S=>S.category))],g=()=>{m({name:"",description:"",mode:"practice",timeLimit:60,totalQuestions:20,categories:{}}),c(!1),h(null)},v=async S=>{var oe;if(S.preventDefault(),!o)return;const E=Object.keys(d.categories).filter(W=>t.filter(ne=>ne.category===W).length===0);if(E.length>0){alert(`⚠️ Các chuyên đề sau không tồn tại hoặc không có câu hỏi:
${E.join(`
`)}

Vui lòng kiểm tra lại tên chuyên đề.`);return}if(Object.values(d.categories).reduce((W,ee)=>W+ee,0)>d.totalQuestions){alert("Tổng số câu hỏi theo chuyên đề không được vượt quá tổng số câu hỏi!");return}const C=Object.entries(d.categories).filter(([W,ee])=>{const ne=t.filter(Z=>Z.category===W);return ee>ne.length});if(C.length>0){const W=C.map(([ee,ne])=>{const Z=t.filter(U=>U.category===ee).length;return`• ${ee}: Yêu cầu ${ne} câu, chỉ có ${Z} câu`}).join(`
`);alert(`⚠️ Một số chuyên đề không đủ câu hỏi:

${W}

Vui lòng giảm số câu hỏi hoặc thêm câu hỏi cho các chuyên đề này.`);return}const T=(oe=S.currentTarget.querySelector('button[type="submit"]'))==null?void 0:oe.textContent,R=S.currentTarget.querySelector('button[type="submit"]');R&&(R.disabled=!0,R.textContent=u?"Đang cập nhật...":"Đang tạo...");const L=typeof d.timeLimit=="string"?parseInt(d.timeLimit)||60:d.timeLimit,D=typeof d.totalQuestions=="string"?parseInt(d.totalQuestions)||20:d.totalQuestions,q={name:d.name,description:d.description,mode:d.mode,timeLimit:L,totalQuestions:D,categories:d.categories,isActive:!0,createdBy:o.id};try{console.log("🔄 Submitting template data:",{...q,timeLimit:`${q.timeLimit} (${typeof q.timeLimit})`,totalQuestions:`${q.totalQuestions} (${typeof q.totalQuestions})`});let W=!1;u?(console.log("🔄 Updating existing template:",u.id),W=await a(u.id,q)):(console.log("🔄 Creating new template"),W=await s(q)),W?(alert(u?"✅ Cập nhật bộ đề thi thành công!":"✅ Tạo bộ đề thi thành công!"),g()):alert("❌ Có lỗi xảy ra. Vui lòng thử lại.")}catch(W){console.error("❌ Template submission error:",W),alert(`❌ Lỗi: ${W instanceof Error?W.message:"Không xác định"}`)}finally{R&&T&&(R.disabled=!1,R.textContent=T)}},w=S=>{m({name:S.name,description:S.description,mode:S.mode,timeLimit:S.timeLimit,totalQuestions:S.totalQuestions,categories:S.categories}),h(S),c(!0)},y=async S=>{const E=`⚠️ Bạn có chắc chắn muốn xóa bộ đề thi "${S.name}"?

📋 Thông tin:
• Tên: ${S.name}
• Chế độ: ${S.mode==="practice"?"Ôn thi":"Thi thử"}
• Thời gian: ${S.timeLimit} phút
• Số câu: ${S.totalQuestions}

❗ Hành động này không thể hoàn tác!`;if(window.confirm(E)){const k=document.querySelectorAll('button[title="Xóa"]');let C=null;k.forEach(T=>{var L;const R=T.closest(".border");(L=R==null?void 0:R.textContent)!=null&&L.includes(S.name)&&(C=T)}),C&&(C.disabled=!0,C.innerHTML='<div class="w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"></div>');try{console.log("🔄 Đang xóa template:",S.id,S.name);const T=await i(S.id);alert(T?"✅ Xóa bộ đề thi thành công!":"❌ Không thể xóa bộ đề thi. Vui lòng thử lại.")}catch(T){console.error("❌ Lỗi khi xóa template:",T),alert(`❌ Lỗi khi xóa bộ đề thi:

${T instanceof Error?T.message:"Lỗi không xác định"}

Vui lòng thử lại hoặc liên hệ admin.`)}finally{C&&(C.disabled=!1,C.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>')}}},p=(S,E)=>{m(k=>({...k,categories:{...k.categories,[S]:E}}))},_=Object.values(d.categories).reduce((S,E)=>S+E,0);return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[f.jsx(gn,{className:"w-5 h-5"}),"Quản lý Bộ đề thi"]}),f.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(Dk,{className:"w-4 h-4"}),"Tạo bộ đề mới"]})]}),n&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:n}),l&&f.jsxs("div",{className:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"font-semibold",children:u?"Chỉnh sửa bộ đề thi":"Tạo bộ đề thi mới"}),f.jsx("button",{onClick:g,className:"p-2 text-gray-500 hover:text-gray-700",children:f.jsx(Ss,{className:"w-4 h-4"})})]}),f.jsxs("form",{onSubmit:v,className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên bộ đề thi *"}),f.jsx("input",{type:"text",required:!0,value:d.name,onChange:S=>m(E=>({...E,name:S.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"VD: Đề thi Toán - Lý cơ bản"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chế độ"}),f.jsxs("select",{value:d.mode,onChange:S=>m(E=>({...E,mode:S.target.value})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"practice",children:"🎯 Ôn thi (hiện đáp án ngay)"}),f.jsx("option",{value:"exam",children:"📝 Thi thử (ẩn đáp án)"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Thời gian (phút)"}),f.jsx("input",{type:"number",min:"5",value:d.timeLimit,onChange:S=>m(E=>({...E,timeLimit:parseInt(S.target.value)||60})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ví dụ: 60"}),f.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Thời gian tối thiểu 5 phút"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tổng số câu hỏi"}),f.jsx("input",{type:"number",min:"1",max:t.length,value:d.totalQuestions,onChange:S=>m(E=>({...E,totalQuestions:parseInt(S.target.value)||20})),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ví dụ: 200"}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Số câu hỏi từ 1 đến ",t.length," câu"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mô tả"}),f.jsx("textarea",{value:d.description,onChange:S=>m(E=>({...E,description:S.target.value})),rows:2,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Mô tả ngắn về bộ đề thi này..."})]}),x.length>0&&f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phân bổ câu hỏi theo chuyên đề"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:x.map(S=>{const E=t.filter(k=>k.category===S);return f.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[f.jsx("h4",{className:"font-medium text-gray-900 text-sm mb-1 break-words leading-tight",title:S,children:S}),f.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["Có sẵn: ",E.length," câu"]}),f.jsx("input",{type:"number",placeholder:"Số câu",min:"0",max:E.length,value:d.categories[S]||"",onChange:k=>p(S,parseInt(k.target.value)||0),className:"w-full p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]},S)})}),f.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[f.jsxs("p",{className:"text-sm text-blue-800",children:["Đã chọn: ",f.jsx("strong",{children:_})," câu từ các chuyên đề",_>0&&_!==d.totalQuestions&&f.jsxs("span",{className:"text-blue-600",children:[" ","(Sẽ lấy thêm ",d.totalQuestions-_," câu ngẫu nhiên)"]})]}),_>d.totalQuestions&&f.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["⚠️ Tổng câu hỏi theo chuyên đề (",_,") vượt quá tổng số câu hỏi (",d.totalQuestions,")"]})]})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsxs("button",{type:"submit",disabled:r||!d.name.trim(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[f.jsx(Mk,{className:"w-4 h-4"}),u?"Cập nhật":"Tạo bộ đề"]}),f.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"})]})]})]}),f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"text-center py-4",children:[f.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),f.jsx("p",{className:"text-gray-600",children:"Đang tải bộ đề thi..."})]}),!r&&e.length===0&&f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(gn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),f.jsx("p",{children:"Chưa có bộ đề thi nào. Hãy tạo bộ đề đầu tiên!"})]}),e.map(S=>f.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h3",{className:"font-semibold text-gray-900",children:S.name}),f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S.mode==="practice"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:S.mode==="practice"?"🎯 Ôn thi":"📝 Thi thử"})]}),S.description&&f.jsx("p",{className:"text-gray-600 text-sm mb-3",children:S.description}),f.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(mi,{className:"w-4 h-4"}),f.jsxs("span",{children:[S.timeLimit," phút"]})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(jn,{className:"w-4 h-4"}),f.jsxs("span",{children:[S.totalQuestions," câu"]})]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(gn,{className:"w-4 h-4"}),f.jsxs("span",{children:[Object.keys(S.categories).length," chuyên đề"]})]})]}),Object.keys(S.categories).length>0&&f.jsxs("div",{className:"mt-3",children:[f.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Phân bổ theo chuyên đề:"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(S.categories).map(([E,k])=>f.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:[E,": ",k," câu"]},E))})]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>w(S),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Chỉnh sửa",children:f.jsx(Ik,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>y(S),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xóa",children:f.jsx(h0,{className:"w-4 h-4"})})]})]})},S.id))]})]})},SO=()=>{const[e,t]=K.useState([]),[r,n]=K.useState(!0),[s,a]=K.useState(null);K.useEffect(()=>{i()},[]);const i=async()=>{if(!he){a("Chưa cấu hình Supabase"),n(!1);return}try{n(!0);const{data:u,error:h}=await he.from("quiz_rankings").select("*").limit(10);if(h)throw h;t(u||[]),a(null)}catch(u){console.error("Lỗi khi lấy bảng xếp hạng:",u),a("Không thể tải bảng xếp hạng")}finally{n(!1)}},o=async()=>{if(window.confirm(`⚠️ Bạn có chắc chắn muốn xóa TẤT CẢ dữ liệu xếp hạng?

Hành động này sẽ:
- Xóa tất cả kết quả thi
- Xóa tất cả xếp hạng
- KHÔNG THỂ hoàn tác!

Bạn có muốn tiếp tục?`)&&window.confirm("🚨 LẦN CUỐI: Bạn THỰC SỰ chắc chắn muốn xóa toàn bộ dữ liệu xếp hạng?"))try{n(!0),a(null);const{count:u,error:h}=await he.from("quiz_results").select("*",{count:"exact",head:!0});if(h)throw console.error("Lỗi đếm records:",h),h;if(!u||u===0){alert("✅ Không có dữ liệu nào để xóa!"),n(!1);return}const d=100;let m=0,x=!0;for(;x;){const{data:g,error:v}=await he.from("quiz_results").select("id").limit(d);if(v)throw console.error("Lỗi lấy batch:",v),v;if(!g||g.length===0){x=!1;break}const{error:w}=await he.from("quiz_results").delete().in("id",g.map(y=>y.id));if(w)throw console.error("Lỗi xóa batch:",w),w;m+=g.length,g.length<d&&(x=!1)}alert(`✅ Đã xóa thành công ${m} kết quả thi!`),await i()}catch(u){console.error("Lỗi khi xóa xếp hạng:",u);const h=u instanceof Error?u.message:"Unknown error";a(`Lỗi khi xóa dữ liệu: ${h}`),alert("❌ Lỗi khi xóa dữ liệu: "+h)}finally{n(!1)}},l=u=>u?new Date(u).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"Chưa có",c=u=>{const h=Math.floor(u/60),d=u%60;return`${h}:${d.toString().padStart(2,"0")}`};return r?f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-6",children:[f.jsx("div",{className:"flex items-center justify-between mb-4",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Fr,{className:"w-6 h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Thống kê xếp hạng"})]})}),f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Đang tải..."})]}):f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 md:p-6",children:[f.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Fr,{className:"w-6 h-6 text-[#A50034]"}),f.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-800",children:"Thống kê xếp hạng (Top 10)"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:i,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors text-sm",children:[f.jsx(Lk,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Làm mới"]}),f.jsxs("button",{onClick:o,disabled:r||e.length===0,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 transition-colors text-sm",children:[f.jsx(h0,{className:"w-4 h-4"}),"Xóa tất cả"]})]})]}),s&&f.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:s}),e.length===0?f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Chưa có dữ liệu xếp hạng"}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-700",children:"Hạng"}),f.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-700",children:"Họ và tên"}),f.jsx("th",{className:"px-3 py-3 text-center font-semibold text-gray-700",children:"Số lần thi"}),f.jsx("th",{className:"px-3 py-3 text-center font-semibold text-gray-700",children:"Điểm TB"}),f.jsx("th",{className:"px-3 py-3 text-center font-semibold text-gray-700",children:"Điểm cao nhất"}),f.jsx("th",{className:"px-3 py-3 text-center font-semibold text-gray-700",children:"Thời gian tốt nhất"}),f.jsx("th",{className:"px-3 py-3 text-left font-semibold text-gray-700",children:"Lần thi gần nhất"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(u=>f.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[f.jsx("td",{className:"px-3 py-3",children:f.jsxs("div",{className:"flex items-center gap-2",children:[u.rank===1&&f.jsx(Fr,{className:"w-5 h-5 text-yellow-500"}),u.rank===2&&f.jsx(Fr,{className:"w-5 h-5 text-gray-400"}),u.rank===3&&f.jsx(Fr,{className:"w-5 h-5 text-amber-600"}),f.jsxs("span",{className:"font-semibold text-gray-900",children:["#",u.rank]})]})}),f.jsx("td",{className:"px-3 py-3",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(al,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),f.jsxs("div",{className:"min-w-0",children:[f.jsx("div",{className:"font-medium text-gray-900 truncate",children:u.user_name||"Chưa có tên"}),f.jsx("div",{className:"text-xs text-gray-500 truncate",children:u.email})]})]})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[u.total_attempts," lần"]})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsxs("span",{className:"font-semibold text-[#A50034]",children:[u.average_score.toFixed(1),"%"]})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsxs("span",{className:"font-semibold text-green-600",children:[u.best_score.toFixed(1),"%"]})}),f.jsx("td",{className:"px-3 py-3 text-center",children:f.jsxs("div",{className:"flex items-center justify-center gap-1",children:[f.jsx(mi,{className:"w-3 h-3 text-gray-400"}),f.jsx("span",{className:"text-gray-700",children:c(u.best_time)})]})}),f.jsx("td",{className:"px-3 py-3",children:f.jsx("span",{className:"text-xs text-gray-600",children:l(u.last_attempt_at)})})]},u.user_id))})]})}),f.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:f.jsxs("p",{className:"text-sm text-yellow-800",children:[f.jsx("strong",{children:"⚠️ Lưu ý:"}),' Nút "Xóa tất cả" sẽ xóa toàn bộ dữ liệu kết quả thi và xếp hạng. Chỉ sử dụng khi test xong và chuẩn bị đưa vào hoạt động chính thức.']})})]})]})};function EO(){const[e,t]=K.useState([]),[r,n]=K.useState(!0),[s,a]=K.useState(null),i=async()=>{try{n(!0),a(null);const{data:h,error:d}=await he.from("user_profiles").select("*").order("created_at",{ascending:!1});if(d)throw d;t(h||[])}catch(h){a(h.message),console.error("Error fetching users:",h)}finally{n(!1)}},o=async h=>{try{const{data:d,error:m}=await he.auth.signUp({email:h.email,password:h.password,options:{data:{full_name:h.full_name}}});if(m)throw m;if(!d.user)throw new Error("User creation failed");const{error:x}=await he.from("user_profiles").insert({id:d.user.id,email:h.email,full_name:h.full_name,role:h.role,status:"active"});if(x)throw x;return await i(),{success:!0,message:"Tạo người dùng thành công"}}catch(d){return console.error("Error creating user:",d),{success:!1,message:d.message||"Lỗi khi tạo người dùng"}}},l=async(h,d)=>{try{const{error:m}=await he.from("user_profiles").update(d).eq("id",h);if(m)throw m;return await i(),{success:!0,message:"Cập nhật người dùng thành công"}}catch(m){return console.error("Error updating user:",m),{success:!1,message:m.message||"Lỗi khi cập nhật người dùng"}}},c=async h=>{try{const{error:d}=await he.from("user_profiles").delete().eq("id",h);if(d)throw d;return await i(),{success:!0,message:"Xóa người dùng thành công"}}catch(d){return console.error("Error deleting user:",d),{success:!1,message:d.message||"Lỗi khi xóa người dùng"}}},u=async(h,d)=>{try{const{data:m,error:x}=await he.rpc("admin_reset_user_password",{target_user_id:h,new_password:d});if(x)throw x;if(m&&!m.success)throw new Error(m.message||"Failed to reset password");return{success:!0,message:"Đặt lại mật khẩu thành công"}}catch(m){return console.error("Error resetting password:",m),{success:!1,message:m.message||"Lỗi khi đặt lại mật khẩu"}}};return K.useEffect(()=>{i()},[]),{users:e,loading:r,error:s,fetchUsers:i,createUser:o,updateUser:l,deleteUser:c,resetPassword:u}}const Hi=10;function bO(){const{users:e,loading:t,error:r,createUser:n,updateUser:s,deleteUser:a,resetPassword:i}=EO(),[o,l]=K.useState(""),[c,u]=K.useState("all"),[h,d]=K.useState(1),[m,x]=K.useState(!1),[g,v]=K.useState(!1),[w,y]=K.useState(!1),[p,_]=K.useState(!1),[S,E]=K.useState(null),[k,C]=K.useState(!1),[T,R]=K.useState(null),[L,D]=K.useState({email:"",password:"",full_name:"",role:"user"}),[q,oe]=K.useState({}),[W,ee]=K.useState(""),ne=K.useMemo(()=>e.filter(N=>{var ze;const Ee=N.email.toLowerCase().includes(o.toLowerCase())||(((ze=N.full_name)==null?void 0:ze.toLowerCase())||"").includes(o.toLowerCase()),De=c==="all"||N.status===c;return Ee&&De}),[e,o,c]),Z=K.useMemo(()=>e.filter(N=>N.status==="pending").length,[e]),U=K.useMemo(()=>{const N=(h-1)*Hi;return ne.slice(N,N+Hi)},[ne,h]),re=Math.ceil(ne.length/Hi),ge=(N,Ee)=>{R({type:N,text:Ee}),setTimeout(()=>R(null),5e3)},O=async N=>{N.preventDefault(),C(!0);const Ee=await n(L);C(!1),ge(Ee.success?"success":"error",Ee.message),Ee.success&&(x(!1),D({email:"",password:"",full_name:"",role:"user"}))},H=async N=>{if(N.preventDefault(),!S)return;C(!0);const Ee=await s(S.id,q);C(!1),ge(Ee.success?"success":"error",Ee.message),Ee.success&&(v(!1),E(null),oe({}))},M=async()=>{if(!S)return;C(!0);const N=await a(S.id);C(!1),ge(N.success?"success":"error",N.message),N.success&&(y(!1),E(null))},B=async N=>{if(N.preventDefault(),!S||!W)return;C(!0);const Ee=await i(S.id,W);C(!1),ge(Ee.success?"success":"error",Ee.message),Ee.success&&(_(!1),E(null),ee(""))},Q=async N=>{C(!0);const Ee=await s(N.id,{status:"active"});C(!1),ge(Ee.success?"success":"error",Ee.message)},ie=async N=>{if(!window.confirm(`Bạn có chắc muốn từ chối tài khoản ${N.email}?`))return;C(!0);const Ee=await a(N.id);C(!1),ge(Ee.success?"success":"error",Ee.message)},ue=N=>{E(N),oe({full_name:N.full_name||"",role:N.role,status:N.status}),v(!0)},ae=N=>{E(N),y(!0)},se=N=>{E(N),ee(""),_(!0)},Ne=N=>new Date(N).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"});return f.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[f.jsx("div",{className:"p-6 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(_f,{className:"w-6 h-6 text-blue-600"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Quản lý người dùng"})]}),f.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(K1,{className:"w-4 h-4"}),"Thêm người dùng"]})]})}),T&&f.jsxs("div",{className:`mx-6 mt-6 p-4 rounded-lg flex items-center gap-2 ${T.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[T.type==="success"?f.jsx(Ki,{className:"w-5 h-5"}):f.jsx(oo,{className:"w-5 h-5"}),f.jsx("span",{children:T.text})]}),f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"mb-6 flex gap-4 items-center flex-wrap",children:[f.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[f.jsx(W1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Tìm kiếm theo email hoặc tên...",value:o,onChange:N=>{l(N.target.value),d(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>{u("all"),d(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tất cả"}),f.jsxs("button",{onClick:()=>{u("pending"),d(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors relative ${c==="pending"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Chờ duyệt",Z>0&&f.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:Z})]}),f.jsx("button",{onClick:()=>{u("active"),d(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c==="active"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Hoạt động"}),f.jsx("button",{onClick:()=>{u("inactive"),d(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c==="inactive"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Vô hiệu hóa"})]})]}),t?f.jsxs("div",{className:"text-center py-12",children:[f.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),f.jsx("p",{className:"mt-2 text-gray-600",children:"Đang tải..."})]}):r?f.jsxs("div",{className:"text-center py-12 text-red-600",children:[f.jsx(oo,{className:"w-12 h-12 mx-auto mb-2"}),f.jsxs("p",{children:["Lỗi: ",r]})]}):ne.length===0?f.jsxs("div",{className:"text-center py-12 text-gray-500",children:[f.jsx(_f,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),f.jsx("p",{children:"Không tìm thấy người dùng nào"})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"border-b border-gray-200",children:[f.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Họ tên"}),f.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Email"}),f.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Vai trò"}),f.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Trạng thái"}),f.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-900",children:"Ngày tạo"}),f.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-900",children:"Thao tác"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:U.map(N=>f.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:N.full_name||f.jsx("span",{className:"text-gray-400",children:"Chưa cập nhật"})}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:N.email}),f.jsx("td",{className:"px-4 py-3",children:f.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${N.role==="admin"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:N.role==="admin"?"Quản trị viên":"Người dùng"})}),f.jsx("td",{className:"px-4 py-3",children:f.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${N.status==="active"?"bg-green-100 text-green-800":N.status==="pending"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:N.status==="active"?"Hoạt động":N.status==="pending"?"Chờ duyệt":"Vô hiệu hóa"})}),f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:Ne(N.created_at)}),f.jsx("td",{className:"px-4 py-3",children:f.jsx("div",{className:"flex items-center justify-end gap-2",children:N.status==="pending"?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>Q(N),disabled:k,className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors disabled:opacity-50",title:"Duyệt tài khoản",children:f.jsx(Uh,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>ie(N),disabled:k,className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors disabled:opacity-50",title:"Từ chối",children:f.jsx(Bk,{className:"w-4 h-4"})})]}):f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>ue(N),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Chỉnh sửa",children:f.jsx(Rk,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>se(N),className:"p-1 text-orange-600 hover:bg-orange-50 rounded transition-colors",title:"Reset mật khẩu",children:f.jsx(f0,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>ae(N),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Xóa",children:f.jsx(h0,{className:"w-4 h-4"})})]})})})]},N.id))})]})}),re>1&&f.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[f.jsxs("p",{className:"text-sm text-gray-600",children:["Hiển thị ",(h-1)*Hi+1," - ",Math.min(h*Hi,ne.length)," trong tổng số ",ne.length," người dùng"]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>d(N=>Math.max(1,N-1)),disabled:h===1,className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Trước"}),f.jsxs("span",{className:"px-3 py-1 text-gray-700",children:["Trang ",h," / ",re]}),f.jsx("button",{onClick:()=>d(N=>Math.min(re,N+1)),disabled:h===re,className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sau"})]})]})]})]})]}),m&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[f.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Thêm người dùng mới"}),f.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:f.jsx(Ss,{className:"w-5 h-5"})})]}),f.jsxs("form",{onSubmit:O,className:"p-6 space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"email",required:!0,value:L.email,onChange:N=>D({...L,email:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"user@example.com"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mật khẩu ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"password",required:!0,minLength:6,value:L.password,onChange:N=>D({...L,password:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tối thiểu 6 ký tự"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Họ tên"}),f.jsx("input",{type:"text",value:L.full_name,onChange:N=>D({...L,full_name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nguyễn Văn A"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai trò"}),f.jsxs("select",{value:L.role,onChange:N=>D({...L,role:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"user",children:"Người dùng"}),f.jsx("option",{value:"admin",children:"Quản trị viên"})]})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"}),f.jsx("button",{type:"submit",disabled:k,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:k?"Đang tạo...":"Tạo người dùng"})]})]})]})}),g&&S&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[f.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Chỉnh sửa người dùng"}),f.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:f.jsx(Ss,{className:"w-5 h-5"})})]}),f.jsxs("form",{onSubmit:H,className:"p-6 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{type:"text",disabled:!0,value:S.email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Họ tên"}),f.jsx("input",{type:"text",value:q.full_name||"",onChange:N=>oe({...q,full_name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nguyễn Văn A"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai trò"}),f.jsxs("select",{value:q.role,onChange:N=>oe({...q,role:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"user",children:"Người dùng"}),f.jsx("option",{value:"admin",children:"Quản trị viên"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trạng thái"}),f.jsxs("select",{value:q.status,onChange:N=>oe({...q,status:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"active",children:"Hoạt động"}),f.jsx("option",{value:"pending",children:"Chờ duyệt"}),f.jsx("option",{value:"inactive",children:"Vô hiệu hóa"})]})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"}),f.jsx("button",{type:"submit",disabled:k,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:k?"Đang lưu...":"Lưu thay đổi"})]})]})]})}),w&&S&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:f.jsx(oo,{className:"w-6 h-6 text-red-600"})}),f.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Xác nhận xóa"})]}),f.jsxs("p",{className:"text-gray-600 mb-6",children:["Bạn có chắc chắn muốn xóa người dùng ",f.jsx("strong",{children:S.email}),"? Hành động này không thể hoàn tác."]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"}),f.jsx("button",{onClick:M,disabled:k,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:k?"Đang xóa...":"Xóa người dùng"})]})]})})}),p&&S&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[f.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[f.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Đặt lại mật khẩu"}),f.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600",children:f.jsx(Ss,{className:"w-5 h-5"})})]}),f.jsxs("form",{onSubmit:B,className:"p-6 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{type:"text",disabled:!0,value:S.email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mật khẩu mới ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"password",required:!0,minLength:6,value:W,onChange:N=>ee(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tối thiểu 6 ký tự"})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>_(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Hủy"}),f.jsx("button",{type:"submit",disabled:k,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50",children:k?"Đang đặt lại...":"Đặt lại mật khẩu"})]})]})]})})]})}const TO=({onStartQuiz:e,questions:t,loading:r,error:n,onQuestionsImport:s,onClearQuestions:a})=>{const{user:i,logout:o}=xa(),[l,c]=K.useState(!1),[u,h]=K.useState("overview"),{templates:d,loading:m,error:x,loadTemplates:g,saveTemplate:v,updateTemplate:w,deleteTemplate:y}=wv(),p=async()=>{window.confirm("Bạn có chắc chắn muốn đăng xuất?")&&await o()};qf.useEffect(()=>{console.log("🔄 AdminDashboard mounted, reloading templates"),g()},[g]);const S=[...new Set(t.map(T=>T.category))].sort((T,R)=>{var q,oe;const L=parseInt(((q=T.match(/^\d+/))==null?void 0:q[0])||"999999"),D=parseInt(((oe=R.match(/^\d+/))==null?void 0:oe[0])||"999999");return L-D}),E=T=>({total:t.filter(L=>L.category===T).length,category:T}),k=S.map(E),C=T=>{if(t.length===0){alert("Không có câu hỏi nào để bắt đầu bài thi.");return}const R={mode:"practice",timeLimit:60*60,totalQuestions:t.filter(L=>L.category===T).length,categories:{[T]:t.filter(L=>L.category===T).length}};console.log("🎯 Admin starting quiz from category:",T,R),e(R)};return f.jsxs("div",{className:"min-h-screen bg-gray-100",children:[f.jsx("div",{className:"bg-agribank-primary text-white",children:f.jsx("div",{className:"max-w-4xl mx-auto px-4 md:px-6 py-3 md:py-4",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-1 min-w-0",children:[f.jsx(V1,{className:"w-6 h-6 md:w-8 md:h-8 text-yellow-400 flex-shrink-0"}),f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsx("h1",{className:"text-sm md:text-xl font-semibold truncate",children:"Quản trị Agribank"}),f.jsx("p",{className:"text-xs md:text-sm text-gray-300 hidden sm:block",children:"Quản lý hệ thống luyện thi"})]})]}),f.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 bg-yellow-400 rounded-full flex items-center justify-center",children:f.jsx(al,{className:"w-3 h-3 md:w-4 md:h-4 text-black"})}),f.jsxs("div",{className:"hidden md:block",children:[f.jsx("p",{className:"font-medium text-sm",children:(i==null?void 0:i.full_name)||(i==null?void 0:i.email)}),f.jsx("p",{className:"text-xs text-yellow-400",children:"Quản trị viên"})]})]}),f.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-1 md:gap-2 px-2 md:px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",title:"Đổi mật khẩu",children:[f.jsx(f0,{className:"w-4 h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Đổi MK"})]}),f.jsxs("button",{onClick:p,className:"flex items-center gap-1 md:gap-2 px-2 md:px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:[f.jsx(H1,{className:"w-4 h-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Đăng xuất"})]})]})]})})}),f.jsx("div",{className:"bg-yellow-50 border-b border-yellow-200",children:f.jsx("div",{className:"max-w-4xl mx-auto px-6 py-3",children:f.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[f.jsx(z1,{className:"w-5 h-5"}),f.jsx("span",{className:"font-medium",children:"Chế độ Quản trị:"}),f.jsx("span",{children:"Bạn có thể quản lý câu hỏi, cấu hình bài thi và test hệ thống"})]})})}),f.jsx("div",{className:"bg-white border-b border-gray-200",children:f.jsx("div",{className:"max-w-7xl mx-auto px-6",children:f.jsxs("div",{className:"flex gap-8",children:[f.jsxs("button",{onClick:()=>h("overview"),className:`py-4 px-2 border-b-2 font-medium transition-colors flex items-center gap-2 ${u==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[f.jsx(jn,{className:"w-4 h-4"}),"Tổng quan & Câu hỏi"]}),f.jsxs("button",{onClick:()=>h("users"),className:`py-4 px-2 border-b-2 font-medium transition-colors flex items-center gap-2 ${u==="users"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[f.jsx(_f,{className:"w-4 h-4"}),"Quản lý người dùng"]})]})})}),u==="overview"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[f.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mb-2",children:f.jsx(gn,{className:"w-5 h-5 text-blue-600"})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900",children:r?"...":t.length}),f.jsx("p",{className:"text-xs text-gray-600",children:"Tổng câu hỏi"})]})}),f.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mb-2",children:f.jsx(jn,{className:"w-5 h-5 text-green-600"})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900",children:S.length}),f.jsx("p",{className:"text-xs text-gray-600",children:"Chuyên đề"})]})})]}),k.length>0&&f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[f.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[f.jsx(jn,{className:"w-5 h-5"}),"Ôn tập theo chuyên đề"]}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:k.map(T=>f.jsx("div",{className:"border rounded-lg p-3 cursor-pointer transition-all hover:border-blue-400 hover:shadow-md border-gray-200 bg-gradient-to-br from-white to-gray-50",onClick:()=>C(T.category),children:f.jsxs("div",{className:"flex flex-col items-center text-center",children:[f.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mb-2",children:f.jsx(gn,{className:"w-5 h-5 text-[#A50034]"})}),f.jsx("h3",{className:"font-semibold text-gray-900 text-xs mb-1 line-clamp-3 min-h-[2.5rem] leading-tight",children:T.category}),f.jsxs("p",{className:"text-xs text-gray-500",children:[T.total," câu"]})]})},T.category))})]})]}),f.jsxs("div",{className:"max-w-4xl mx-auto px-6 pb-6 space-y-6",children:[f.jsx(SO,{}),f.jsx(kO,{templates:d,questions:t,loading:m,error:x,onSaveTemplate:async T=>{try{return console.log("🔄 AdminDashboard: Saving template:",T),await v(T),console.log("✅ AdminDashboard: Template saved successfully"),!0}catch(R){throw console.error("❌ AdminDashboard: Error in saveTemplate:",R),R}},onUpdateTemplate:async(T,R)=>{try{return console.log("🔄 AdminDashboard: Updating template:",T,R),await w(T,R),console.log("✅ AdminDashboard: Template updated successfully"),!0}catch(L){throw console.error("❌ AdminDashboard: Error in updateTemplate:",L),L}},onDeleteTemplate:async T=>{try{return console.log("🔄 AdminDashboard: Deleting template:",T),await y(T),console.log("✅ AdminDashboard: Template deleted successfully"),!0}catch(R){throw console.error("❌ AdminDashboard: Error in deleteTemplate:",R),R}}}),f.jsx(_O,{questions:t,loading:r,error:n,onQuestionsImport:s,onClearQuestions:a,onStartQuiz:e})]})]}):f.jsx(bO,{}),l&&f.jsx(yv,{onClose:()=>c(!1)})]})},NO=({mode:e,timeRemaining:t,currentQuestion:r,totalQuestions:n,reviewMode:s=!1})=>{const a=i=>{if(typeof i!="number"||isNaN(i)||i<0)return console.warn("⚠️ Invalid time value in formatTime:",i),"0:00";const o=Math.max(0,Math.floor(i)),l=Math.floor(o/3600),c=Math.floor(o%3600/60),u=o%60;return o%60===0&&console.log("⏰ Time display:",{input:i,formatted:l>0?`${l}:${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`:`${c}:${u.toString().padStart(2,"0")}`,timestamp:new Date().toLocaleTimeString()}),l>0?`${l}:${c.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`:`${c}:${u.toString().padStart(2,"0")}`};return f.jsx("header",{className:"bg-agribank-primary text-white px-3 py-2 md:px-4 md:py-3 border-b border-gray-300",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-2 md:hidden flex-1 min-w-0",children:[f.jsx(gn,{className:"w-5 h-5"}),f.jsx("h1",{className:"text-sm font-medium truncate flex-1",children:"Ứng Dụng Luyện Thi Trắc Nghiệm"})]}),f.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[f.jsx(gn,{className:"w-6 h-6"}),f.jsx("h1",{className:"text-xl font-semibold",children:s?"Ôn Luyện Câu Sai":"Ứng Dụng Luyện Thi Trắc Nghiệm"}),s?f.jsx("span",{className:"px-2 py-1 bg-orange-600 rounded-full text-sm",children:"🔄 Ôn luyện câu sai"}):f.jsx("span",{className:"px-2 py-1 bg-gray-700 rounded-full text-sm",children:e==="practice"?"Chế độ Ôn thi":"Chế độ Thi thật"})]}),f.jsxs("div",{className:"flex items-center gap-2 md:gap-6 flex-shrink-0",children:[s?f.jsx("span",{className:"md:hidden px-2 py-1 bg-orange-600 rounded-full text-xs",children:"🔄 Ôn câu sai"}):f.jsx("span",{className:"md:hidden px-2 py-1 bg-gray-700 rounded-full text-xs",children:e==="practice"?"Ôn thi":"Thi thật"}),f.jsx("div",{className:"flex items-center gap-1 md:gap-2 whitespace-nowrap",children:f.jsxs("span",{className:"text-xs md:text-base font-medium",children:["Câu ",r,"/",n]})}),f.jsxs("div",{className:"flex items-center gap-1 md:gap-2 whitespace-nowrap",children:[f.jsx(mi,{className:"w-4 h-4 md:w-5 md:h-5"}),f.jsx("span",{className:`font-mono text-sm md:text-lg font-bold ${t<300?"text-red-400":"text-green-400"}`,children:a(t)})]})]})]})})},CO=({onSubmit:e,onShowQuestionList:t,currentQuestion:r,totalQuestions:n,onNavigate:s,canNavigatePrev:a,canNavigateNext:i})=>f.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-300 px-2 py-2 shadow-lg z-40",children:[f.jsxs("div",{className:"block md:hidden",children:[f.jsxs("div",{className:"flex justify-between items-center gap-1 mb-1.5",children:[f.jsxs("button",{onClick:()=>s("prev"),disabled:!a,className:"flex items-center justify-center gap-1 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm min-h-[40px] flex-1",children:[f.jsx(Gm,{className:"w-4 h-4"}),f.jsx("span",{children:"Trước"})]}),f.jsx("button",{onClick:t,className:"flex items-center justify-center gap-1 px-2 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm min-h-[40px]",children:f.jsx(qm,{className:"w-4 h-4"})}),f.jsxs("button",{onClick:()=>s("next"),disabled:!i,className:"flex items-center justify-center gap-1 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm min-h-[40px] flex-1",children:[f.jsx("span",{children:"Tiếp"}),f.jsx(Km,{className:"w-4 h-4"})]})]}),f.jsx("div",{className:"flex justify-center",children:f.jsxs("button",{onClick:e,className:"flex items-center justify-center gap-2 px-6 py-2 bg-agribank-primary text-white rounded-lg hover:bg-agribank-dark transition-colors text-sm min-h-[40px] w-full",children:[f.jsx(Ym,{className:"w-4 h-4"}),"Nộp bài"]})})]}),f.jsxs("div",{className:"hidden md:flex justify-between items-center",children:[f.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-6 py-3 bg-agribank-primary text-white rounded-lg hover:bg-agribank-dark transition-colors font-medium",children:[f.jsx(Ym,{className:"w-5 h-5"}),"Nộp bài"]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("button",{onClick:()=>s("prev"),disabled:!a,className:"flex items-center gap-2 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[f.jsx(Gm,{className:"w-4 h-4"}),"Trước"]}),f.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(qm,{className:"w-5 h-5"}),"Danh sách câu hỏi"]}),f.jsxs("button",{onClick:()=>s("next"),disabled:!i,className:"flex items-center gap-2 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Tiếp",f.jsx(Km,{className:"w-4 h-4"})]})]})]})]}),AO=({question:e,questionNumber:t,userAnswer:r,mode:n,showResult:s,onAnswerSelect:a,onToggleMark:i,reviewMode:o=!1})=>{const l=u=>{const h="w-full text-left p-3 md:p-5 border-2 border-gray-300 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors";return s?u===e.correctAnswer?`${h.replace("hover:bg-blue-50 hover:border-blue-300","hover:bg-green-200 hover:border-green-600")} bg-green-100 border-green-500 text-green-800`:r.selectedAnswer===u&&u!==e.correctAnswer?`${h.replace("hover:bg-blue-50 hover:border-blue-300","hover:bg-red-200 hover:border-red-600")} bg-red-100 border-red-500 text-red-800`:h:`${h} ${r.selectedAnswer===u?"bg-blue-100 border-blue-500":""}`},c=u=>String.fromCharCode(65+u);return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-4 md:p-8",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("div",{className:"flex justify-between items-start mb-2",children:f.jsxs("div",{className:"flex-1",children:[o&&f.jsx("div",{className:"mb-2",children:f.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full",children:"🔄 Câu đã trả lời sai - Ôn luyện lại"})}),f.jsxs("h2",{className:"text-base md:text-lg lg:text-2xl font-medium text-gray-900 leading-snug",children:["Câu ",t,": ",e.question]})]})}),f.jsx("div",{className:"flex justify-end",children:f.jsxs("button",{onClick:i,className:`flex items-center gap-1.5 px-3 py-1.5 md:px-4 md:py-2.5 rounded-lg text-sm md:text-base transition-colors ${r.isMarked?"bg-red-100 text-red-700 border border-red-300 hover:bg-red-200":"bg-gray-100 text-gray-600 border border-gray-300 hover:bg-gray-200"}`,children:[f.jsx(qa,{className:`w-4 h-4 md:w-5 md:h-5 ${r.isMarked?"text-red-600":"text-gray-500"}`}),f.jsx("span",{className:"hidden sm:inline",children:r.isMarked?"Đã đánh dấu":"Đánh dấu"})]})})]}),f.jsx("div",{className:"space-y-2.5 md:space-y-4",children:e.options.map((u,h)=>!u||u.trim()===""?null:f.jsx("button",{onClick:()=>a(h),disabled:s,className:`${l(h)} min-h-[48px] md:min-h-[64px]`,children:f.jsxs("div",{className:"flex items-start gap-2.5 md:gap-4",children:[f.jsxs("span",{className:"font-semibold text-gray-700 min-w-[24px] md:min-w-[28px] text-base md:text-lg lg:text-xl",children:[c(h),"."]}),f.jsx("span",{className:"flex-1 text-left text-sm md:text-base lg:text-lg leading-snug md:leading-relaxed",children:u})]})},h)).filter(Boolean)}),s&&n==="practice"&&e.explanation&&f.jsxs("div",{className:"mt-4 md:mt-6 p-3 md:p-5 bg-blue-50 border border-blue-200 rounded-lg",children:[f.jsx("h4",{className:"font-medium text-blue-900 mb-1.5 md:mb-2 text-sm md:text-base",children:"Giải thích:"}),f.jsx("p",{className:"text-blue-800 text-sm md:text-base leading-snug md:leading-relaxed",children:e.explanation})]})]})},FO=({questions:e,userAnswers:t,currentQuestion:r,onQuestionSelect:n,onClose:s})=>{const a=c=>{const u=t[c];return u.selectedAnswer!==null?u.isMarked?"answered-marked":"answered":u.isMarked?"marked":"unanswered"},i=c=>{switch(c){case"answered":return f.jsx(Ki,{className:"w-4 h-4 text-green-600"});case"answered-marked":return f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Ki,{className:"w-3 h-3 text-green-600"}),f.jsx(qa,{className:"w-3 h-3 text-yellow-600"})]});case"marked":return f.jsx(qa,{className:"w-4 h-4 text-yellow-600"});case"unanswered":return f.jsx(oo,{className:"w-4 h-4 text-gray-400"});default:return null}},o=(c,u)=>{const h="flex items-center justify-between p-3 border rounded-lg cursor-pointer transition-colors";if(c===r)return`${h} border-blue-500 bg-blue-50`;switch(u){case"answered":return`${h} border-green-300 bg-green-50 hover:bg-green-100`;case"answered-marked":return`${h} border-yellow-300 bg-yellow-50 hover:bg-yellow-100`;case"marked":return`${h} border-yellow-300 bg-yellow-50 hover:bg-yellow-100`;case"unanswered":return`${h} border-gray-300 bg-white hover:bg-gray-50`;default:return`${h} border-gray-300 bg-white hover:bg-gray-50`}},l={answered:t.filter(c=>c.selectedAnswer!==null&&!c.isMarked).length,answeredMarked:t.filter(c=>c.selectedAnswer!==null&&c.isMarked).length,marked:t.filter(c=>c.selectedAnswer===null&&c.isMarked).length,unanswered:t.filter(c=>c.selectedAnswer===null&&!c.isMarked).length};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[f.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[f.jsx("h2",{className:"text-xl font-semibold",children:"Danh sách câu hỏi"}),f.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:f.jsx(Ss,{className:"w-5 h-5"})})]}),f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6 text-sm",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ki,{className:"w-4 h-4 text-green-600"}),f.jsxs("span",{children:["Đã trả lời: ",l.answered]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Ki,{className:"w-3 h-3 text-green-600"}),f.jsx(qa,{className:"w-3 h-3 text-yellow-600"})]}),f.jsxs("span",{children:["Đã trả lời + Đánh dấu: ",l.answeredMarked]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(qa,{className:"w-4 h-4 text-yellow-600"}),f.jsxs("span",{children:["Chỉ đánh dấu: ",l.marked]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(oo,{className:"w-4 h-4 text-gray-400"}),f.jsxs("span",{children:["Chưa trả lời: ",l.unanswered]})]})]}),f.jsx("div",{className:"grid grid-cols-5 gap-3 max-h-96 overflow-y-auto",children:e.map((c,u)=>{const h=a(u);return f.jsxs("button",{onClick:()=>{n(u),s()},className:o(u,h),children:[f.jsxs("span",{className:"font-medium",children:["Câu ",u+1]}),i(h)]},u)})})]})]})})},jO=({result:e,questions:t,onRestart:r,mode:n,onReviewWrongAnswers:s})=>{const{user:a}=xa(),[i,o]=K.useState(!1);K.useEffect(()=>{(async()=>{if(!(!a||!he||i)){if(n!=="exam"){console.log("Không lưu kết quả cho chế độ:",n);return}try{const d={user_id:a.id,score:e.score,total_questions:e.correctAnswers+e.wrongAnswers+e.unanswered,correct_answers:e.correctAnswers,percentage:e.score,time_spent:e.timeSpent,quiz_type:n},{error:m}=await he.from("quiz_results").insert([d]);m?console.error("Lỗi lưu kết quả:",m):(console.log("Đã lưu kết quả thi thử thành công"),o(!0),window.dispatchEvent(new CustomEvent("quizCompleted")))}catch(d){console.error("Lỗi khi lưu kết quả:",d)}}})()},[a,e,n,i]);const l=h=>{const d=Math.floor(h/3600),m=Math.floor(h%3600/60),x=h%60;return d>0?`${d}:${m.toString().padStart(2,"0")}:${x.toString().padStart(2,"0")}`:`${m}:${x.toString().padStart(2,"0")}`},c=()=>e.score>=80?"text-green-600":e.score>=60?"text-yellow-600":"text-red-600",u=()=>e.score>=80?"Xuất sắc!":e.score>=60?"Khá tốt!":"Cần cố gắng thêm!";return f.jsxs("div",{className:"min-h-screen bg-gray-100",children:[f.jsx("div",{className:"bg-agribank-primary text-white px-6 py-4 border-b border-gray-300",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(Fr,{className:"w-6 h-6"}),f.jsx("h1",{className:"text-xl font-semibold",children:"Kết quả bài thi"})]})}),f.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-6 mb-6",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsxs("div",{className:`text-4xl md:text-6xl font-bold ${c()} mb-2`,children:[e.score.toFixed(1),"%"]}),f.jsx("div",{className:"text-xl text-gray-600 mb-4",children:u()}),e.wrongQuestions&&e.wrongQuestions.length>0&&f.jsxs("div",{className:"mt-4 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[f.jsxs("p",{className:"text-orange-800 font-medium",children:["📚 Bạn có ",e.wrongQuestions.length," câu trả lời sai cần ôn luyện lại"]}),f.jsx("p",{className:"text-orange-700 text-sm mt-1",children:'Click nút "Ôn luyện câu sai" để làm lại những câu này'})]})]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.correctAnswers}),f.jsx("div",{className:"text-sm text-green-800",children:"Câu đúng"})]}),f.jsxs("div",{className:"text-center p-4 bg-red-50 border border-red-200 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.wrongAnswers}),f.jsx("div",{className:"text-sm text-red-800",children:"Câu sai"})]}),f.jsxs("div",{className:"text-center p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-gray-600",children:e.unanswered}),f.jsx("div",{className:"text-sm text-gray-800",children:"Chưa trả lời"})]}),f.jsxs("div",{className:"text-center p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l(e.timeSpent)}),f.jsx("div",{className:"text-sm text-blue-800",children:"Thời gian"})]})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mb-6",children:[e.wrongQuestions&&e.wrongQuestions.length>0&&s&&f.jsxs("button",{onClick:()=>s(e.wrongQuestions),className:"flex items-center justify-center gap-2 px-4 py-2.5 text-sm bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[f.jsx(gn,{className:"w-4 h-4"}),"Ôn luyện câu sai (",e.wrongQuestions.length,")"]}),f.jsxs("button",{onClick:r,className:"flex items-center justify-center gap-2 px-4 py-2.5 text-sm bg-agribank-primary text-white rounded-lg hover:bg-agribank-dark transition-colors",children:[f.jsx(Fk,{className:"w-4 h-4"}),"Làm bài mới"]})]}),f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Chi tiết từng câu"}),f.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Chi tiết từng câu"}),f.jsx("div",{className:"space-y-4",children:e.answers.map((h,d)=>{const m=t[d],x=h.selectedAnswer===m.correctAnswer,g=v=>String.fromCharCode(65+v);return f.jsxs("div",{className:`p-3 md:p-4 border rounded-lg ${x?"border-green-300 bg-green-50":h.selectedAnswer!==null?"border-red-300 bg-red-50":"border-gray-300 bg-gray-50"}`,children:[f.jsx("div",{className:"mb-2",children:f.jsxs("h3",{className:"text-sm md:text-base font-medium",children:[d+1,". ",m.question]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Đáp án đúng: "}),f.jsxs("span",{className:"text-green-600",children:[g(m.correctAnswer),". ",m.options[m.correctAnswer]]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Bạn chọn: "}),h.selectedAnswer!==null?f.jsxs("span",{className:x?"text-green-600":"text-red-600",children:[g(h.selectedAnswer),". ",m.options[h.selectedAnswer]]}):f.jsx("span",{className:"text-gray-500",children:"Không trả lời"})]})]}),m.explanation&&f.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded",children:[f.jsx("span",{className:"font-medium text-blue-900 text-xs",children:"Giải thích: "}),f.jsx("span",{className:"text-blue-800 text-xs",children:m.explanation})]})]},d)})})]})]})]})]})},OO=({isOpen:e,onClose:t,onConfirm:r,reviewMode:n=!1,stats:s})=>{if(!e)return null;const a=()=>{r(),t()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsx("div",{className:"bg-white rounded-lg max-w-md w-full mx-4 shadow-xl",children:f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${n?"bg-orange-100":"bg-red-100"}`,children:f.jsx($1,{className:`w-6 h-6 ${n?"text-orange-600":"text-red-600"}`})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n?"Kết thúc ôn luyện?":"Nộp bài thi?"}),f.jsx("p",{className:"text-sm text-gray-600",children:n?"Bạn có chắc chắn muốn kết thúc phần ôn luyện câu sai không?":"Bạn có chắc chắn muốn nộp bài không?"})]})]}),!n&&s&&f.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[f.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[f.jsx(Uh,{className:"w-4 h-4 text-blue-600"}),"Thống kê hiện tại:"]}),f.jsxs("div",{className:"space-y-2 text-sm",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Đã trả lời:"]}),f.jsxs("span",{className:"font-medium",children:[s.answered,"/",s.total," câu"]})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 bg-gray-400 rounded-full"}),"Chưa trả lời:"]}),f.jsxs("span",{className:"font-medium",children:[s.unanswered," câu"]})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx(qa,{className:"w-3 h-3 text-yellow-600"}),"Đã đánh dấu:"]}),f.jsxs("span",{className:"font-medium",children:[s.marked," câu"]})]})]})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Hủy"}),f.jsx("button",{onClick:a,className:`flex-1 px-4 py-3 text-white rounded-lg transition-colors font-medium ${n?"bg-orange-600 hover:bg-orange-700":"bg-red-600 hover:bg-red-700"}`,children:n?"Kết thúc":"Nộp bài"})]})]})})})},Np=({onClose:e})=>f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[f.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:f.jsx($1,{className:"w-6 h-6 text-red-600"})}),f.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Phiên đăng nhập đã kết thúc"})]}),f.jsxs("div",{className:"mb-6",children:[f.jsx("p",{className:"text-gray-700 mb-3",children:"Tài khoản của bạn đã được đăng nhập từ thiết bị khác."}),f.jsx("p",{className:"text-gray-600 text-sm",children:"Để bảo mật tài khoản, bạn đã bị đăng xuất khỏi thiết bị này. Vui lòng đăng nhập lại để tiếp tục."})]}),f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:f.jsxs("p",{className:"text-sm text-yellow-800",children:[f.jsx("strong",{children:"Lưu ý:"})," Mỗi tài khoản chỉ được đăng nhập trên một thiết bị tại một thời điểm."]})}),f.jsx("button",{onClick:e,className:"w-full px-4 py-3 bg-[#A50034] text-white rounded-lg hover:bg-[#8a0029] transition-colors font-medium",children:"Đăng nhập lại"})]})}),PO=()=>{const[e,t]=K.useState(null),[r,n]=K.useState(!1),[s,a]=K.useState(!1);K.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){a(!0);return}const c=u=>{u.preventDefault(),t(u),n(!0)};return window.addEventListener("beforeinstallprompt",c),window.addEventListener("appinstalled",()=>{a(!0),n(!1),t(null)}),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const i=async()=>{if(!e)return;e.prompt();const{outcome:c}=await e.userChoice;console.log(c==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),t(null)},o=()=>{n(!1),localStorage.setItem("installPromptDismissed",Date.now().toString())};if(s||!r)return null;const l=localStorage.getItem("installPromptDismissed");return l&&(Date.now()-parseInt(l))/864e5<7?null:f.jsx("div",{className:"fixed bottom-20 md:bottom-6 left-4 right-4 md:left-auto md:right-6 z-50 animate-slide-up",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-2xl border-2 border-[#A50034] overflow-hidden max-w-md mx-auto md:mx-0",children:[f.jsxs("div",{className:"bg-gradient-to-r from-[#A50034] to-[#8B0028] p-4 relative",children:[f.jsx("button",{onClick:o,className:"absolute top-2 right-2 text-white/80 hover:text-white transition-colors","aria-label":"Đóng",children:f.jsx(Ss,{className:"w-5 h-5"})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center flex-shrink-0 shadow-lg",children:f.jsx("img",{src:"/logo-agribank-300x295.png",alt:"Agribank Logo",className:"w-10 h-10 object-contain"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-white font-bold text-base",children:"Cài đặt ứng dụng"}),f.jsx("p",{className:"text-white/90 text-xs",children:"Truy cập nhanh từ màn hình chính"})]})]})]}),f.jsxs("div",{className:"p-4 bg-gray-50",children:[f.jsxs("div",{className:"space-y-2 mb-4",children:[f.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-700",children:[f.jsx("span",{className:"text-[#A50034] font-bold flex-shrink-0",children:"✓"}),f.jsx("span",{children:"Truy cập nhanh không cần mở trình duyệt"})]}),f.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-700",children:[f.jsx("span",{className:"text-[#A50034] font-bold flex-shrink-0",children:"✓"}),f.jsx("span",{children:"Hoạt động offline, luyện thi mọi lúc"})]}),f.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-700",children:[f.jsx("span",{className:"text-[#A50034] font-bold flex-shrink-0",children:"✓"}),f.jsx("span",{children:"Tiết kiệm bộ nhớ so với app thông thường"})]})]}),f.jsxs("button",{onClick:i,className:"w-full bg-gradient-to-r from-[#A50034] to-[#8B0028] text-white py-3 px-4 rounded-lg font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2 group",children:[f.jsx(Pa,{className:"w-5 h-5 group-hover:animate-bounce"}),"Cài đặt ngay"]}),f.jsx("button",{onClick:o,className:"w-full mt-2 text-gray-600 py-2 text-sm hover:text-gray-800 transition-colors",children:"Để sau"})]})]})})},IO=(e,t)=>{const r=g=>typeof g!="number"||isNaN(g)||g<0?(console.warn("⚠️ Invalid timer initialTime:",g,"using default 3600"),3600):Math.floor(g),[n,s]=K.useState(()=>r(e)),[a,i]=K.useState(!1),o=K.useRef(null),l=K.useRef(0),c=K.useRef(0),u=K.useRef(0),h=()=>Date.now();K.useEffect(()=>{const g=r(e);console.log("🔄 Timer initialTime changed:",e,"→",g),a||(s(g),c.current=0,u.current=0)},[e,a]),K.useEffect(()=>{if(a&&n>0){const g=()=>{const v=h(),w=v-l.current-c.current,y=Math.floor(w/1e3),p=r(e),_=Math.max(0,p-y);if(console.log("⏰ Timer update:",{now:new Date(v).toLocaleTimeString(),elapsed:y,remaining:_,initial:p}),s(_),_<=0){console.log("⏰ Timer finished!"),i(!1),t();return}o.current=setTimeout(g,1e3)};g()}else o.current&&(clearTimeout(o.current),o.current=null);return()=>{o.current&&(clearTimeout(o.current),o.current=null)}},[a,e,t]);const d=()=>{if(!a){const g=h();if(console.log("▶️ Timer started at:",new Date(g).toLocaleTimeString()),l.current===0)l.current=g,c.current=0;else{const v=g-u.current;c.current+=v,console.log("⏸️ Resume after pause duration:",Math.floor(v/1e3),"seconds")}i(!0)}},m=()=>{if(a){const g=h();u.current=g,i(!1),console.log("⏸️ Timer paused at:",new Date(g).toLocaleTimeString())}},x=g=>{const v=r(g||e);console.log("🔄 Timer reset to:",v,"seconds"),i(!1),s(v),l.current=0,c.current=0,u.current=0,o.current&&(clearTimeout(o.current),o.current=null)};return K.useEffect(()=>{if(!a)return;const g=setInterval(()=>{console.log("🔄 Syncing timer with system time...")},3e4);return()=>clearInterval(g)},[a]),{timeRemaining:Math.max(0,n),isRunning:a,start:d,pause:m,reset:x}};function RO(e,t){if(Object.keys(t.categories).length===0)return[...e].sort(()=>Math.random()-.5).slice(0,t.totalQuestions);const r=[];for(const[n,s]of Object.entries(t.categories)){if(s<=0)continue;const o=[...e.filter(l=>l.category===n)].sort(()=>Math.random()-.5).slice(0,s);r.push(...o)}return r.sort(()=>Math.random()-.5)}function DO(e,t){let r=0;return t.forEach((n,s)=>{n.selectedAnswer===e[s].correctAnswer&&r++}),r/e.length*100}function Oy(e){if(!e)return e;const t=e.trim(),r=parseFloat(t);if(!isNaN(r)&&r>=1e4&&r<6e4&&t===r.toString())try{const n=new Date(1900,0,1),s=r-1,a=r>60?s-1:s,i=new Date(n.getTime()+a*24*60*60*1e3),o=i.getDate().toString().padStart(2,"0"),l=(i.getMonth()+1).toString().padStart(2,"0"),c=i.getFullYear();return`${o}/${l}/${c}`}catch(n){return console.error("Error converting Excel date:",n),e}return e}function Cp(e){return e&&e.replace(/\b([1-5]\d{4})\b/g,t=>{if(parseInt(t)>=1e4){const n=Oy(t);return n!==t?n:t}return t})}function LO(e){return e.map(t=>Oy(t))}const Py=async()=>{if(!he)return!1;try{return console.warn("⚠️ Bảng questions chưa tồn tại. Vui lòng tạo bảng thủ công trong Supabase SQL Editor."),!1}catch(e){return console.warn("⚠️ Không thể kiểm tra bảng questions:",e),!1}},lc=async()=>{var e,t;if(!he)return!1;try{const r=he.from("questions").select("count",{count:"exact",head:!0}),n=new Promise((a,i)=>{setTimeout(()=>i(new Error("Table check timeout")),5e3)}),{error:s}=await Promise.race([r,n]);return s?s.code==="PGRST116"||(e=s.message)!=null&&e.includes("Could not find the table")?!1:(t=s.message)!=null&&t.includes("timeout")?(console.warn("⚠️ Timeout khi kiểm tra bảng"),!1):!0:!0}catch(r){return console.warn("⚠️ Lỗi khi kiểm tra bảng:",r),!1}},MO=async()=>{if(!await lc()){const t=await Py();return t&&await new Promise(r=>setTimeout(r,1e3)),t}return!0},BO=()=>{const[e,t]=K.useState([]),[r,n]=K.useState(!1),[s,a]=K.useState(null),[i,o]=K.useState(null);K.useEffect(()=>()=>{i&&clearTimeout(i)},[i]);const l=K.useCallback(async()=>{if(console.log("🔄 loadQuestions: Bắt đầu tải câu hỏi..."),console.log("🔍 Categories found:",[...new Set(e.map(d=>d.category))]),!cs()||!he){console.log("⚠️ loadQuestions: Chưa cấu hình Supabase"),t([]),n(!1),a("⚠️ Chưa cấu hình Supabase. Vui lòng cấu hình để sử dụng.");return}n(!0),a(null);try{if(console.log("🔄 loadQuestions: Đang kiểm tra bảng questions..."),!await Promise.race([lc(),new Promise((k,C)=>setTimeout(()=>C(new Error("timeout")),8e3))]).catch(k=>(console.warn("⚠️ Timeout hoặc lỗi khi kiểm tra bảng:",k),!1))){console.warn("❌ loadQuestions: Bảng questions chưa tồn tại"),a(`❌ Bảng "questions" chưa tồn tại trong database.

🔧 Cách khắc phục:
1. Vào Supabase Dashboard → SQL Editor
2. Copy script tạo bảng từ hướng dẫn
3. Paste và click Run
4. Refresh lại trang này`),t([]),n(!1);return}console.log("🔄 loadQuestions: Đang truy vấn dữ liệu từ Supabase...");const m=he.from("questions").select("*",{count:"exact",head:!0}),{count:x,error:g}=await Promise.race([m,new Promise((k,C)=>setTimeout(()=>C(new Error("Count timeout")),5e3))]);g?console.warn("⚠️ Không thể đếm tổng số câu hỏi:",g):console.log("📊 Tổng số câu hỏi trong DB:",x);let v=[];const w=1e3;let y=0,p=!0;for(;p;){const k=y*w,C=k+w-1;console.log(`🔄 Đang tải trang ${y+1} (từ ${k} đến ${C})...`);const T=he.from("questions").select("*").range(k,C).order("created_at",{ascending:!1}),R=new Promise((q,oe)=>{setTimeout(()=>oe(new Error("Query timeout")),3e4)}),{data:L,error:D}=await Promise.race([T,R]);if(D)throw console.error(`❌ Lỗi khi tải trang ${y+1}:`,D),D;L&&L.length>0?(v=[...v,...L],console.log(`✅ Đã tải ${v.length} câu hỏi`),L.length<w?p=!1:y++):p=!1}const _=v,S=null;console.log("🔄 loadQuestions: Kết quả truy vấn:",{dataLength:_==null?void 0:_.length,totalCount:x||"unknown",pagesLoaded:y+1,status:"Loaded all questions successfully"});const E=_.map(k=>({id:k.id,question:Cp(k.question),options:LO(k.options),correctAnswer:k.correct_answer,explanation:Cp(k.explanation||""),category:k.category}));console.log("✅ loadQuestions: Đã format thành công",E.length,"câu hỏi"),t(E)}catch(d){console.error("❌ loadQuestions: Lỗi không mong muốn:",d);let m="Lỗi tải câu hỏi";d instanceof Error&&(d.message.includes("timeout")?m="⏱️ Kết nối chậm. Sử dụng câu hỏi mẫu.":d.message.includes("network")||d.message.includes("fetch")?m="🌐 Lỗi mạng. Sử dụng câu hỏi mẫu.":m=d.message),a(m),t([])}finally{n(!1),console.log("✅ loadQuestions: Hoàn thành")}},[]),c=K.useCallback(async d=>{var m;if(console.log("🔄 saveQuestions: Bắt đầu lưu",d.length,"câu hỏi"),!cs()||!he)return console.log("⚠️ saveQuestions: Chưa cấu hình Supabase, lưu local"),t(d),a("⚠️ Chưa cấu hình Supabase. Câu hỏi chỉ lưu tạm thời trong phiên làm việc này."),!0;n(!0),a(null);try{if(console.log("🔄 saveQuestions: Đang kiểm tra bảng..."),!await Promise.race([lc(),new Promise((S,E)=>setTimeout(()=>E(new Error("timeout")),5e3))]).catch(()=>!1))return a(`❌ Không thể lưu: Database chưa sẵn sàng.

🛠️ Cần làm:
1. Cấu hình Supabase database
2. Tạo bảng "questions"
3. Thử lại`),!1;const g=d.map(S=>({id:S.id,question:S.question,options:S.options,correct_answer:S.correctAnswer,explanation:S.explanation||null,category:S.category}));console.log("🔄 saveQuestions: Đang xóa câu hỏi cũ...");const v=he.from("questions").delete().neq("id",""),{error:w}=await Promise.race([v,new Promise((S,E)=>setTimeout(()=>E(new Error("Delete timeout")),15e3))]);if(w)throw w;console.log("🔄 saveQuestions: Đang thêm câu hỏi mới...");const y=100;let p=0;const _=Math.ceil(g.length/y);for(let S=0;S<g.length;S+=y){const E=g.slice(S,S+y),k=Math.floor(S/y)+1,C=Math.round(p/g.length*100);console.log(`🔄 saveQuestions: Batch ${k}/${_} (${E.length} câu) - ${C}%`);const T=he.from("questions").insert(E),{error:R}=await Promise.race([T,new Promise((L,D)=>setTimeout(()=>D(new Error("Insert timeout")),12e4))]);if(R){if(R.code==="PGRST116"||(m=R.message)!=null&&m.includes("Could not find the table"))return a('❌ Bảng "questions" chưa tồn tại. Vui lòng tạo bảng theo hướng dẫn.'),!1;throw console.error(`❌ Lỗi batch ${k}:`,R),R}p+=E.length,console.log(`✅ Đã lưu ${p}/${g.length} câu (${C}%)`),await new Promise(L=>setTimeout(L,100))}return console.log("✅ saveQuestions: Lưu thành công tất cả",p,"câu hỏi"),t(d),!0}catch(x){console.error("❌ saveQuestions: Lỗi:",x);let g="Lỗi lưu câu hỏi";return x instanceof Error&&(x.message.includes("timeout")?g="⏱️ Timeout khi lưu. Thử lại sau.":g=x.message),a(g),!1}finally{n(!1)}},[]),u=K.useCallback(async d=>{if(console.log("🔄 addQuestions: Bắt đầu thêm",d.length,"câu hỏi"),!cs()||!he)return console.log("⚠️ addQuestions: Chưa cấu hình Supabase, thêm local"),t(x=>[...x,...d]),a("⚠️ Chưa cấu hình Supabase. Câu hỏi chỉ lưu tạm thời trong phiên làm việc này."),!0;n(!0),a(null);const m=setTimeout(()=>{console.warn("⚠️ addQuestions: Timeout sau 15 phút"),n(!1),a("Timeout khi thêm câu hỏi. Có thể do số lượng câu hỏi quá lớn. Vui lòng thử lại hoặc chia nhỏ file.")},9e5);try{if(console.log("🔄 addQuestions: Đang kiểm tra bảng..."),!await MO())return a(`❌ Không thể thêm câu hỏi: Bảng "questions" chưa tồn tại.

📋 Hướng dẫn tạo bảng:
1. Truy cập Supabase Dashboard
2. Mở SQL Editor
3. Chạy script tạo bảng questions
4. Thử upload lại`),!1;const g=d.map(_=>({id:_.id,question:_.question,options:_.options,correct_answer:_.correctAnswer,explanation:_.explanation||null,category:_.category}));console.log("🔄 addQuestions: Đang thêm vào database...");const v=50;let w=0;const y=Math.ceil(g.length/v);let p=0;for(let _=0;_<g.length;_+=v){const S=g.slice(_,_+v),E=Math.floor(_/v)+1,k=Math.round(w/g.length*100);console.log(`🔄 addQuestions: Batch ${E}/${y} (${S.length} câu) - ${k}%`);const C=he.from("questions").insert(S),{error:T}=await Promise.race([C,new Promise((R,L)=>setTimeout(()=>L(new Error("Insert timeout")),6e4))]);if(T){if(T.code==="PGRST116"||T.message.includes("Could not find the table"))return a(`❌ Upload thất bại: Bảng "questions" chưa được tạo.

⚡ Giải pháp nhanh:
1. Click nút "Hướng dẫn" để xem chi tiết
2. Tạo bảng trong Supabase SQL Editor
3. Upload lại file Excel`),!1;throw console.error(`❌ Lỗi batch ${E}:`,T),T}w+=S.length,console.log(`✅ Đã thêm ${w}/${g.length} câu (${k}%)`),p++,p%100===0&&(console.log("🔄 Refreshing session..."),await he.auth.refreshSession().catch(R=>{console.warn("⚠️ Session refresh failed:",R)}))}return console.log("✅ addQuestions: Thêm thành công tất cả",w,"câu hỏi"),t(_=>[..._,...d]),clearTimeout(m),!0}catch(x){return console.error("❌ addQuestions: Lỗi:",x),a(x instanceof Error?x.message:"Lỗi thêm câu hỏi"),clearTimeout(m),!1}finally{n(!1)}},[]),h=K.useCallback(async()=>{if(console.log("🔄 clearQuestions: Bắt đầu xóa tất cả câu hỏi"),!cs()||!he)return console.log("⚠️ clearQuestions: Chưa cấu hình Supabase, xóa local"),t([]),!0;n(!0),a(null);const d=setTimeout(()=>{console.warn("⚠️ clearQuestions: Timeout sau 10 giây"),n(!1),a("Timeout khi xóa câu hỏi. Vui lòng thử lại.")},1e4);try{if(console.log("🔄 clearQuestions: Đang kiểm tra bảng..."),!await lc()){if(!await Py())return a('❌ Bảng "questions" chưa tồn tại và không thể tự động tạo. Vui lòng tạo bảng thủ công trong Supabase SQL Editor.'),clearTimeout(d),!1;await new Promise(v=>setTimeout(v,1e3))}console.log("🔄 clearQuestions: Đang xóa dữ liệu...");const{error:x}=await he.from("questions").delete().neq("id","");if(x){if(x.code==="PGRST116"||x.message.includes("Could not find the table"))return a('❌ Bảng "questions" chưa tồn tại. Vui lòng tạo bảng trong Supabase SQL Editor theo hướng dẫn.'),clearTimeout(d),!1;throw x}return console.log("✅ clearQuestions: Xóa thành công"),t([]),clearTimeout(d),!0}catch(m){return console.error("❌ clearQuestions: Lỗi:",m),a(m instanceof Error?m.message:"Lỗi xóa câu hỏi"),clearTimeout(d),!1}finally{n(!1)}},[]);return K.useEffect(()=>{console.log("🔄 useQuestions: Component mounted, bắt đầu load questions"),l()},[]),{questions:e,loading:r,error:s,isSupabaseConfigured:cs(),loadQuestions:l,saveQuestions:c,addQuestions:u,clearQuestions:h}};function UO(){const[e,t]=K.useState("auth"),[r,n]=K.useState({isOpen:!1,title:"",message:""}),[s,a]=K.useState([]),[i,o]=K.useState(0),[l,c]=K.useState([]),[u,h]=K.useState(null),[d,m]=K.useState(!1),[x,g]=K.useState(null),[v,w]=K.useState(0),[y,p]=K.useState(!0),[_,S]=K.useState(!1),[E,k]=K.useState([]),[C,T]=K.useState(!1),[R,L]=K.useState(!1),{user:D,loading:q,isAuthenticated:oe,isAdmin:W,error:ee,logout:ne,isSupabaseConfigured:Z}=vv(),{questions:U,loading:re,error:ge,loadQuestions:O,saveQuestions:H,addQuestions:M,clearQuestions:B}=BO();K.useEffect(()=>{const ke=()=>{L(!0)};return window.addEventListener("sessionTerminated",ke),()=>window.removeEventListener("sessionTerminated",ke)},[]);const Q=async()=>{L(!1),await ne(),t("auth"),p(!0)};K.useEffect(()=>{const ke=Ie=>{const{title:Ve,message:Dt}=Ie.detail;n({isOpen:!0,title:Ve,message:Dt})};return window.addEventListener("showCustomAlert",ke),()=>{window.removeEventListener("showCustomAlert",ke)}},[]);const ie=()=>{n({isOpen:!1,title:"",message:""}),uE()};K.useEffect(()=>{console.log("🔄 App: Kiểm tra auth state:",{isAuthenticated:oe,authLoading:q}),q||(oe?(console.log("✅ App: User đã đăng nhập, chuyển sang dashboard"),t("dashboard"),p(!1),console.log("🔄 App: Reload questions sau khi đăng nhập..."),O()):(console.log("ℹ️ App: User chưa đăng nhập, hiển thị auth screen"),t("auth"),p(!0)))},[oe,q,O]);const ue=()=>{Pe()},{timeRemaining:ae,start:se,reset:Ne}=IO((u==null?void 0:u.timeLimit)||3600,ue),N=ke=>{if(U.length===0){alert("Không có câu hỏi nào để bắt đầu bài thi. Vui lòng thêm câu hỏi trước.");return}const Ie=RO(U,ke);if(Ie.length===0){alert("Không thể chọn được câu hỏi phù hợp với cấu hình. Vui lòng kiểm tra lại.");return}const Ve=typeof ke.timeLimit=="number"&&!isNaN(ke.timeLimit)&&ke.timeLimit>0?ke.timeLimit:3600;console.log("🔄 Starting quiz with timeLimit:",Ve,"seconds"),a(Ie),h(ke),o(0),c(Ie.map(Dt=>({questionId:Dt.id,selectedAnswer:null,isMarked:!1,timeSpent:0}))),w(Date.now()),Ne(Ve),setTimeout(()=>{se()},100),t("quiz")},Ee=ke=>{c(Ie=>{const Ve=[...Ie];return Ve[i]={...Ve[i],selectedAnswer:ke},Ve})},De=()=>{c(ke=>{const Ie=[...ke];return Ie[i]={...Ie[i],isMarked:!Ie[i].isMarked},Ie})},ze=ke=>{ke==="prev"&&i>0?o(Ie=>Ie-1):ke==="next"&&i<s.length-1&&o(Ie=>Ie+1)},Pe=()=>{T(!0)},xe=()=>{const ke=Math.floor((Date.now()-v)/1e3),Ie=DO(s,l),Ve=l.filter((gr,vt)=>gr.selectedAnswer===s[vt].correctAnswer).length,Dt=l.filter((gr,vt)=>gr.selectedAnswer!==null&&gr.selectedAnswer!==s[vt].correctAnswer).length,At=l.filter(gr=>gr.selectedAnswer===null).length,nn=s.filter((gr,vt)=>{const Tr=l[vt];return Tr.selectedAnswer!==null&&Tr.selectedAnswer!==gr.correctAnswer}),wn={totalQuestions:s.length,correctAnswers:Ve,wrongAnswers:Dt,unanswered:At,score:Ie,timeSpent:ke,answers:l,wrongQuestions:nn};g(wn),t("result")},at=()=>{console.log("🔄 Restarting quiz..."),t("dashboard"),g(null),o(0),c([]),a([]),h(null),S(!1),k([])},mr=ke=>{console.log("🔄 Bắt đầu ôn luyện câu sai:",ke.length,"câu");const Ie={mode:"practice",timeLimit:3600,totalQuestions:ke.length,categories:{}};a(ke),h(Ie),o(0),c(ke.map(Ve=>({questionId:Ve.id,selectedAnswer:null,isMarked:!1,timeSpent:0}))),w(Date.now()),S(!0),Ne(Ie.timeLimit),se(),t("quiz")};if(K.useEffect(()=>{if(e==="quiz"&&u){const ke=setInterval(()=>{c(Ie=>{const Ve=[...Ie];return Ve[i]&&(Ve[i]={...Ve[i],timeSpent:Ve[i].timeSpent+1}),Ve})},1e3);return()=>clearInterval(ke)}},[e,i,u]),q||re)return console.log("🔄 App: Hiển thị loading screen:",{authLoading:q,questionsLoading:re}),f.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600",children:q?"Đang kiểm tra đăng nhập...":"Đang tải câu hỏi..."}),f.jsxs("details",{className:"mt-4 max-w-md mx-auto",children:[f.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-700",children:"🔧 Debug Info (click để xem)"}),f.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg text-left text-xs",children:[f.jsx("p",{children:f.jsx("strong",{children:"Debug Loading:"})}),f.jsxs("p",{children:["Auth Loading: ",q?"true":"false"]}),f.jsxs("p",{children:["Questions Loading: ",re?"true":"false"]}),f.jsxs("p",{children:["Questions Count: ",U.length]}),f.jsxs("p",{children:["Questions Error: ",ge||"none"]}),f.jsxs("p",{children:["Auth Error: ",ee||"none"]}),f.jsxs("p",{children:["Supabase Configured: ",Z?"true":"false"]}),f.jsx("div",{className:"mt-2 space-x-2",children:f.jsx("button",{onClick:()=>window.location.reload(),className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Refresh"})})]})]})]})});if(!q&&!oe&&ee)return f.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:f.jsx("div",{className:"max-w-md w-full mx-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[f.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:f.jsx(gn,{className:"w-10 h-10 text-red-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Lỗi kết nối"}),f.jsx("p",{className:"text-red-600 mb-4",children:ee}),f.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Thử lại"})]})})});if(e==="auth"||!oe)return f.jsx(hE,{isOpen:!0,onClose:()=>{}});if(e==="dashboard")return f.jsxs(f.Fragment,{children:[f.jsx(PO,{}),W?f.jsx(TO,{onStartQuiz:N,questions:U,loading:re,error:ge,onQuestionsImport:async(ke,Ie)=>{if(console.log(`🚀 Bắt đầu import ${ke.length} câu hỏi...`),Ie)if(await H(ke)){console.log(`✅ Import hoàn tất: ${ke.length} câu hỏi`),console.log("🔄 Đang reload dữ liệu..."),await O();const Dt=[...new Set(ke.map(At=>At.category))];setTimeout(()=>{alert(`✅ Import thành công!

📊 Tổng: ${ke.length.toLocaleString()} câu hỏi
📚 Chuyên đề: ${Dt.length}

💡 Dữ liệu đã được cập nhật.`)},500)}else alert("❌ Import thất bại. Vui lòng kiểm tra console log.");else if(await M(ke)){console.log(`✅ Import hoàn tất: ${ke.length} câu hỏi`),console.log("🔄 Đang reload dữ liệu để cập nhật chuyên đề..."),await O();const Dt=[...new Set(ke.map(At=>At.category))];setTimeout(()=>{alert(`✅ Import thành công!

📊 Đã thêm: ${ke.length.toLocaleString()} câu hỏi
📚 Chuyên đề: ${Dt.length}

💡 Dữ liệu và chuyên đề đã được cập nhật.

🔄 Nếu không thấy thay đổi, vui lòng refresh trang (F5).`)},500)}else alert("❌ Import thất bại. Vui lòng kiểm tra console log.")},onClearQuestions:B}):f.jsx(xE,{onStartQuiz:N,questions:U,loading:re})]});if(e==="result"&&x)return f.jsx(jO,{result:x,questions:s,onRestart:at,mode:(u==null?void 0:u.mode)||"practice",onReviewWrongAnswers:mr});if(e==="quiz"&&u){const ke=s[i],Ie=l[i];return!ke||!Ie?f.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-red-600 mb-4",children:"Lỗi: Không thể tải câu hỏi"}),f.jsx("button",{onClick:at,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Quay lại trang chủ"})]})}):f.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col",children:[f.jsx(NO,{mode:u.mode,timeRemaining:ae,currentQuestion:i+1,totalQuestions:s.length,reviewMode:_}),f.jsx("main",{className:"flex-1 p-6 pb-40",children:f.jsx("div",{className:"max-w-4xl mx-auto",children:f.jsx(AO,{question:ke,questionNumber:i+1,userAnswer:Ie,mode:u.mode,showResult:u.mode==="practice"&&Ie.selectedAnswer!==null,onAnswerSelect:Ee,onToggleMark:De,reviewMode:_})})}),f.jsx(CO,{onSubmit:Pe,onShowQuestionList:()=>m(!0),currentQuestion:i+1,totalQuestions:s.length,onNavigate:ze,canNavigatePrev:i>0,canNavigateNext:i<s.length-1}),d&&f.jsx(FO,{questions:s,userAnswers:l,currentQuestion:i,onQuestionSelect:o,onClose:()=>m(!1)}),f.jsx(OO,{isOpen:C,onClose:()=>T(!1),onConfirm:xe,reviewMode:_,stats:{answered:l.filter(Ve=>Ve.selectedAnswer!==null).length,total:s.length,unanswered:l.filter(Ve=>Ve.selectedAnswer===null).length,marked:l.filter(Ve=>Ve.isMarked).length}}),R&&f.jsx(Np,{onClose:Q})]})}return f.jsxs(f.Fragment,{children:[R&&f.jsx(Np,{onClose:Q}),f.jsx(lE,{title:r.title,message:r.message,isOpen:r.isOpen,onClose:ie})]})}bu.createRoot(document.getElementById("root")).render(f.jsx(qf.StrictMode,{children:f.jsx(UO,{})}));
